{"version":3,"file":"js/1128.542614ef.js","mappings":"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","sources":["webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/jsonContext-Cs3DKlwE.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/layersLoader-DTby3dpB.js"],"sourcesContent":["import{I as o,b as s}from\"./main-I34c1W55.js\";function a(e,r){return{...l(e,r),readResourcePaths:[]}}function i(e,r,n){const t=o(e.itemUrl);return{...l(e,r),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:t?{rootPath:t.path,writtenUrls:[]}:null,resources:n?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(e,r){return{origin:r,url:o(e.itemUrl),portal:e.portal||s.getDefault(),portalItem:e}}export{a as e,i as o};\n","import{s as u,b as S}from\"./main-I34c1W55.js\";import{d as T}from\"./arcgisLayerUrl-BTWijBPh.js\";import{t as L,b as v,a as F}from\"./fetchService-Cn-JonIP.js\";import{l as p,a as M,o as P,u as d,t as f,c as G,n as x,i as D,e as m}from\"./portalLayers-BdG2D9Ua.js\";import{populateGroupLayer as k}from\"./layersCreator-BnJdHVZQ.js\";import{e as w}from\"./jsonContext-Cs3DKlwE.js\";import{s as A}from\"./portalItemUtils-B5LG5xsT.js\";import{t as C}from\"./styleUtils-CQzUQIed.js\";async function E(t,a){const r=t.instance.portalItem;if(r?.id)return await r.load(a),O(t),t.validateItem&&t.validateItem(r),R(t,a)}function O(t){const a=t.instance.portalItem;if(!a?.type||!t.supportedTypes.includes(a.type))throw new u(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}'\",{type:a?.type,expectedType:t.supportedTypes.join(\", \")})}async function R(t,a){const r=t.instance,e=r.portalItem;if(!e)return;const{url:o,title:s}=e,n=w(e,\"portal-item\");if(r.type===\"group\")return j(r,n,t);o&&r.type!==\"media\"&&r.read({url:o},n);const l=new m,i=await I(t,l,a);return i&&r.read(i,n),r.resourceReferences={portalItem:e,paths:n.readResourcePaths??[]},r.type!==\"subtype-group\"&&r.read({title:s},n),C(r,n)}async function j(t,a,r){const e=t.portalItem;if(!t.sourceIsPortalItem)return;const{title:o,type:s}=e;if(s===\"Group Layer\"){if(!A(e,\"Map\"))throw new u(\"portal:invalid-layer-item-typekeyword\",\"'Group Layer' item without 'Map' type keyword is not supported\");return J(t)}return t.read({title:o},a),N(t,r)}async function J(t){const a=t.portalItem,r=await a.fetchData(\"json\");if(!r)return;const e=w(a,\"web-map\");t.read(r,e),await k(t,r,{context:e}),t.resourceReferences={portalItem:a,paths:e.readResourcePaths??[]}}async function N(t,a){let r;const{portalItem:e}=t;if(!e)return;const o=e.type,s=a.layerModuleTypeMap;switch(o){case\"Feature Service\":case\"Feature Collection\":r=s.FeatureLayer;break;case\"Stream Service\":r=s.StreamLayer;break;case\"Scene Service\":r=s.SceneLayer;break;default:throw new u(\"portal:unsupported-item-type-as-group\",`The item type '${o}' is not supported as a 'IGroupLayer'`)}const n=new m;let[l,i]=await Promise.all([r(),I(a,n)]),c=()=>l;if(o===\"Feature Service\"){const b=p(i)?.customParameters;i=e.url?await M(i,e.url,n):{},c=await Q(i,s)||c;const g=await K(e.url,{customParameters:b,loadContext:n});return await y(t,c,i,g)}return o===\"Scene Service\"&&e.url&&(i=await P(e,i,n)),d(i)>0?await y(t,c,i):await $(t,c)}async function $(t,a){const{portalItem:r}=t;if(!r?.url)return;const e=await L(r.url);e&&y(t,a,{layers:e.layers?.map(f),tables:e.tables?.map(f)})}async function y(t,a,r,e){let o=r.layers||[];const s=r.tables||[];if(t.portalItem?.type===\"Feature Collection\"?(o.forEach((n,l)=>{n.id=l,n?.layerDefinition?.type===\"Table\"&&s.push(n)}),o=o.filter(n=>n?.layerDefinition?.type!==\"Table\")):(o.reverse(),s.reverse()),o.forEach(n=>{const l=e?.(n);if(l||!e){const i=h(t,a(n),r,n,l);t.add(i)}}),s.length){const n=await v.FeatureLayer();s.forEach(l=>{const i=e?.(l);if(i||!e){const c=h(t,n,r,l,i);t.tables.add(c)}})}}function h(t,a,r,e,o){const s=t.portalItem,n={portalItem:s.clone(),layerId:e.id};e.url!=null&&(n.url=e.url);const l=new a(n);if(\"sourceJSON\"in l&&(l.sourceJSON=o),l.type!==\"subtype-group\"&&l.type!==\"catalog\"&&(l.sublayerTitleMode=\"service-name\"),s.type===\"Feature Collection\"){const i={origin:\"portal-item\",portal:s.portal||S.getDefault()};l.read(e,i);const c=r.showLegend;c!=null&&l.read({showLegend:c},i)}return l}async function I(t,a,r){if(t.supportsData===!1)return;const e=t.instance,o=e.portalItem;if(!o)return;let s=null;try{s=await o.fetchData(\"json\",r)}catch{}if(B(e)){let n=null;const l=await q(o,s,a);if((s?.layers||s?.tables)&&l>0){if(e.layerId==null){const i=G(e.type),c=i?x(s,i)[0]:p(s);c&&(e.layerId=c.id)}n=z(s,e),n?.layerType===\"OrientedImageryLayer\"&&e.type===\"oriented-imagery\"&&e.supportedSourceTypes.add(\"Feature Layer\"),n&&s.showLegend!=null&&(n.showLegend=s.showLegend)}return l>1&&\"sublayerTitleMode\"in e&&e.sublayerTitleMode!==\"service-name\"&&(e.sublayerTitleMode=\"item-title-and-service-name\"),n}return s}async function q(t,a,r){if(a?.layers&&a?.tables)return d(a);const e=T(t.url);if(!e)return 1;const o=await r.fetchServiceMetadata(e.url.path,{customParameters:p(a)?.customParameters}).catch(()=>null);return(a?.layers?.length??o?.layers?.length??0)+(a?.tables?.length??o?.tables?.length??0)}function z(t,a){const{layerId:r}=a,e=t.layers?.find(o=>o.id===r)||t.tables?.find(o=>o.id===r);return e&&H(e,a)?e:null}function B(t){return t.type!==\"stream\"&&\"layerId\"in t}function H(t,a){const r=\"layerType\"in t&&t.layerType,{type:e}=a;return!(e===\"feature\"&&r&&t.layerType!==\"ArcGISFeatureLayer\"||e===\"catalog\"&&!r||e===\"oriented-imagery\"&&!r||e===\"subtype-group\"&&!r)}async function K(t,a){const{layersJSON:r}=await F(t,a);if(!r)return null;const e=[...r.layers,...r.tables];return o=>e.find(s=>s.id===o.id)}async function Q(t,a){const{layers:r}=t;if(!r?.length)return;const e=new Set,o=[];for(const{layerType:l}of r){const i=l??\"ArcGISFeatureLayer\";if(e.has(i))continue;e.add(i);const c=a[D(i)];o.push(c())}const s=await Promise.all(o),n=new Map;return Array.from(e).forEach((l,i)=>{n.set(l,s[i])}),({layerType:l})=>{const i=l??\"ArcGISFeatureLayer\";return n.get(i)}}export{E as load};\n"],"names":["a","e","r","l","readResourcePaths","i","n","t","itemUrl","messages","writtenProperties","blockedRelativeUrls","verifyItemRelativeUrls","rootPath","path","writtenUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","origin","url","portal","getDefault","portalItem","async","E","instance","id","load","O","validateItem","R","type","supportedTypes","includes","expectedType","join","o","title","s","j","read","I","resourceReferences","paths","sourceIsPortalItem","J","N","fetchData","context","layerModuleTypeMap","FeatureLayer","StreamLayer","SceneLayer","Promise","all","c","b","customParameters","Q","g","K","loadContext","y","$","layers","map","tables","forEach","layerDefinition","push","filter","reverse","h","add","length","clone","layerId","sourceJSON","sublayerTitleMode","showLegend","supportsData","B","q","z","layerType","supportedSourceTypes","fetchServiceMetadata","catch","find","H","layersJSON","Set","has","Map","Array","from","set","get"],"sourceRoot":""}