"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[7806],{44610:function(e,t,r){r.d(t,{y:function(){return l}});var i=r(98503),n=r(82047),o=r(49600),s=r(22102);const a={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let l=class extends i.aD{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const t=(0,o.n)(this.floors,e);return e.toExportImageJSON(t)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&(0,s.n)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("sublayer-update",(e=>this.notifyChange(a[e.propertyName])))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map((e=>e.id)).join(","):"show:-1":null}get layerDefs(){const e=!!this.floors?.length,t=this.visibleSublayers.filter((t=>null!=t.definitionExpression||e&&null!=t.floorInfo));return t.length?JSON.stringify(t.reduce(((e,t)=>{const r=(0,o.n)(this.floors,t),n=(0,i.bt)(r,t.definitionExpression);return null!=n&&(e[t.id]=n),e}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,r=this.scale,i=t=>{t.visible&&(0===r||(0,n.d)(r,t.minScale,t.maxScale))&&(t.sublayers?t.sublayers.forEach(i):e.unshift(t))};t&&t.forEach(i);const o=this._get("visibleSublayers");return!o||o.length!==e.length||o.some(((t,r)=>e[r]!==t))?e:o}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t={...t,layers:this.layers,layerDefs:this.layerDefs},t}};(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"dynamicLayers",null),(0,i.k)([(0,i.o)()],l.prototype,"floors",void 0),(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"hasDynamicLayers",null),(0,i.k)([(0,i.o)()],l.prototype,"layer",null),(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"layers",null),(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"layerDefs",null),(0,i.k)([(0,i.o)({type:Number})],l.prototype,"scale",void 0),(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"version",null),(0,i.k)([(0,i.o)({readOnly:!0})],l.prototype,"visibleSublayers",null),l=(0,i.k)([(0,i.A)("esri.layers.support.ExportImageParameters")],l)},97806:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var i=r(98503),n=r(87654),o=r(71624),s=r(87399),a=r(2917),l=r(6100),u=r(48171),p=r(44610),y=r(43783),h=r(73793),c=r(38820),f=r(75286);const d=e=>{let t=class extends e{initialize(){this.exportImageParameters=new p.y({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}get timeExtent(){return(0,y.i)(this.layer,this.view?.timeExtent,this._get("timeExtent"))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return(0,i.k)([(0,i.o)()],t.prototype,"exportImageParameters",void 0),(0,i.k)([(0,i.o)({readOnly:!0})],t.prototype,"floors",null),(0,i.k)([(0,i.o)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,i.k)([(0,i.o)()],t.prototype,"layer",void 0),(0,i.k)([(0,i.o)()],t.prototype,"suspended",void 0),(0,i.k)([(0,i.o)({readOnly:!0})],t.prototype,"timeExtent",null),t=(0,i.k)([(0,i.A)("esri.views.layers.MapImageLayerView")],t),t};let m=class extends(d((0,h.i)((0,s.j)(s.y)))){constructor(){super(...arguments),this._highlightGraphics=new n.c,this._updateHash=""}fetchPopupFeaturesAtLocation(e,t){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(e,t)}update(e){const t=`${this.exportImageVersion}/${e.state.id}/${e.pixelRatio}/${e.stationary}`;this._updateHash!==t&&(this._updateHash=t,this.strategy.update(e).catch((e=>{(0,i.E)(e)||i.n.getLogger(this).error(e)})),e.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(e.state.resolution)),this._highlightView.processUpdate(e)}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:r}=this.layer,n=r>=10.3,s=r>=10;this._bitmapContainer=new o.a,this.container.addChild(this._bitmapContainer),this._highlightView=new a.F({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new l.h(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new c.R({createFetchPopupFeaturesQueryGeometry:(e,t)=>(0,f.r)(e,t,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(e,t)=>{this._highlightView.graphicUpdateHandler({graphic:e,property:t})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new u._({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:n,imageNormalizationSupported:s,hidpi:!0}),this.addAttachHandles((0,i.aE)((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}async doRefresh(){this._updateHash="",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.timeExtent,floors:this.floors,...i})}fetchImageBitmap(e,t,r,i){return this.layer.fetchImageBitmap(e,t,r,{timeExtent:this.timeExtent,floors:this.floors,...i})}highlight(e){return this._popupHighlightHelper.highlight(e)}};(0,i.k)([(0,i.o)()],m.prototype,"strategy",void 0),(0,i.k)([(0,i.o)()],m.prototype,"updating",void 0),m=(0,i.k)([(0,i.A)("esri.views.2d.layers.MapImageLayerView2D")],m);const g=m},38820:function(e,t,r){r.d(t,{R:function(){return P},_:function(){return V}});var i,n=r(98503),o=r(14435),s=r(82047),a=r(49600),l=r(75286),u=r(58469),p=r(81528),y=r(22102),h=r(50257),c=r(13487);function f(e,t){const{dpi:r,gdbVersion:i,geometry:o,geometryPrecision:s,height:a,historicMoment:l,layerOption:u,mapExtent:p,maxAllowableOffset:y,returnFieldName:h,returnGeometry:c,returnUnformattedValues:f,returnZ:m,spatialReference:g,timeExtent:b,tolerance:w,width:v}=e.toJSON(),{dynamicLayers:x,layerDefs:I,layerIds:S}=d(e),k=null!=t?.geometry?t.geometry:null,E={historicMoment:l,geometryPrecision:s,maxAllowableOffset:y,returnFieldName:h,returnGeometry:c,returnUnformattedValues:f,returnZ:m,tolerance:w},O=k?.toJSON()||o;E.imageDisplay=`${v},${a},${r}`,i&&(E.gdbVersion=i),O&&(delete O.spatialReference,E.geometry=JSON.stringify(O),E.geometryType=(0,n.aW)(O));const V=g??O?.spatialReference??p?.spatialReference;if(V&&(E.sr=(0,n.bn)(V)),E.time=b?[b.start,b.end].join(","):null,p){const{xmin:e,ymin:t,xmax:r,ymax:i}=p;E.mapExtent=`${e},${t},${r},${i}`}return I&&(E.layerDefs=I),x&&!I&&(E.dynamicLayers=x),E.layers="popup"===u?"visible":u,S&&!x&&(E.layers+=`:${S.join(",")}`),E}function d(e){const{mapExtent:t,floors:r,width:i,sublayers:n,layerIds:o,layerOption:l,gdbVersion:u}=e,p=n?.find((e=>null!=e.layer))?.layer?.serviceSublayers,h="popup"===l,c={},f=(0,s.i)({extent:t,width:i,spatialReference:t?.spatialReference}),d=[],g=e=>{const t=0===f,r=0===e.minScale||f<=e.minScale,i=0===e.maxScale||f>=e.maxScale;if(e.visible&&(t||r&&i))if(e.sublayers)e.sublayers.forEach(g);else{if(!1===o?.includes(e.id)||h&&(!e.popupTemplate||!e.popupEnabled))return;d.unshift(e)}};if(n?.forEach(g),n&&!d.length)c.layerIds=[];else{const e=(0,y.n)(d,p,u),t=d.map((e=>{const t=(0,a.n)(r,e);return e.toExportImageJSON(t)}));if(e)c.dynamicLayers=JSON.stringify(t);else{if(n){let e=d.map((({id:e})=>e));o&&(e=e.filter((e=>o.includes(e)))),c.layerIds=e}else o?.length&&(c.layerIds=o);const e=m(r,d);if(null!=e&&e.length){const t={};for(const r of e)r.definitionExpression&&(t[r.id]=r.definitionExpression);Object.keys(t).length&&(c.layerDefs=JSON.stringify(t))}}}return c}function m(e,t){const r=!!e?.length,i=t.filter((e=>null!=e.definitionExpression||r&&null!=e.floorInfo));return i.length?i.map((t=>{const r=(0,a.n)(e,t),i=(0,n.bt)(r,t.definitionExpression);return{id:t.id,definitionExpression:i??void 0}})):null}let g=i=class extends n.v{static from(e){return(0,n.cG)(i,e)}constructor(e){super(e),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.historicMoment=null,this.layerIds=null,this.layerOption="top",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}};(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"dpi",void 0),(0,n.k)([(0,n.o)()],g.prototype,"floors",void 0),(0,n.k)([(0,n.o)({type:String,json:{write:!0}})],g.prototype,"gdbVersion",void 0),(0,n.k)([(0,n.o)({types:n.b2,json:{read:n.b3,write:!0}})],g.prototype,"geometry",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"geometryPrecision",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"height",void 0),(0,n.k)([(0,n.o)({type:Date})],g.prototype,"historicMoment",void 0),(0,n.k)([(0,n.q)("historicMoment")],g.prototype,"writeHistoricMoment",null),(0,n.k)([(0,n.o)({type:[Number],json:{write:!0}})],g.prototype,"layerIds",void 0),(0,n.k)([(0,n.o)({type:["top","visible","all","popup"],json:{write:!0}})],g.prototype,"layerOption",void 0),(0,n.k)([(0,n.o)({type:n.au,json:{write:!0}})],g.prototype,"mapExtent",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"maxAllowableOffset",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],g.prototype,"returnFieldName",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],g.prototype,"returnGeometry",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],g.prototype,"returnM",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],g.prototype,"returnUnformattedValues",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],g.prototype,"returnZ",void 0),(0,n.k)([(0,n.o)({type:n.B,json:{write:!0}})],g.prototype,"spatialReference",void 0),(0,n.k)([(0,n.o)()],g.prototype,"sublayers",void 0),(0,n.k)([(0,n.o)({type:h.p,json:{write:!0}})],g.prototype,"timeExtent",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"tolerance",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],g.prototype,"width",void 0),g=i=(0,n.k)([(0,n.A)("esri.rest.support.IdentifyParameters")],g);const b=g;let w=class extends n.v{constructor(e){super(e),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(e,t){return n.b1.fromJSON({attributes:{...t.attributes},geometry:{...t.geometry}})}writeFeature(e,t){if(!e)return;const{attributes:r,geometry:i}=e;r&&(t.attributes={...r}),null!=i&&(t.geometry=i.toJSON(),t.geometryType=n.f4.toJSON(i.type))}};(0,n.k)([(0,n.o)({type:String,json:{write:!0}})],w.prototype,"displayFieldName",void 0),(0,n.k)([(0,n.o)({type:n.b1})],w.prototype,"feature",void 0),(0,n.k)([(0,n.u)("feature",["attributes","geometry"])],w.prototype,"readFeature",null),(0,n.k)([(0,n.q)("feature")],w.prototype,"writeFeature",null),(0,n.k)([(0,n.o)({type:Number,json:{write:!0}})],w.prototype,"layerId",void 0),(0,n.k)([(0,n.o)({type:String,json:{write:!0}})],w.prototype,"layerName",void 0),w=(0,n.k)([(0,n.A)("esri.rest.support.IdentifyResult")],w);const v=w;async function x(e,t,r){const i=(t=S(t)).geometry?[t.geometry]:[],o=(0,p.f)(e);return o.path+="/identify",(0,u.R)(i).then((e=>{const i=f(t,{geometry:e?.[0]}),s=(0,p.s)({...o.query,f:"json",...i}),a=(0,p.i)(s,r);return(0,n.U)(o.path,a).then(I).then((e=>k(e,t.sublayers)))}))}function I(e){const t=e.data;return t.results=t.results||[],t.exceededTransferLimit=!!t.exceededTransferLimit,t.results=t.results.map((e=>v.fromJSON(e))),t}function S(e){return b.from(e)}function k(e,t){if(!t?.length)return e;const r=new Map;function i(e){r.set(e.id,e),e.sublayers&&e.sublayers.forEach(i)}t.forEach(i);for(const n of e.results)n.feature.sourceLayer=r.get(n.layerId);return e}const E=(0,n.aH)();let O=null;function V(e,t){return"tile"===t.type||"map-image"===t.type}let P=class extends n.aD{constructor(e){super(e),this._featuresResolutions=new WeakMap,this.highlightGraphics=null,this.highlightGraphicUpdated=null,this.updateHighlightedFeatures=(0,n.dA)((async e=>{this.destroyed||this.updatingHandles.addPromise(this._updateHighlightedFeaturesGeometries(e).catch((()=>{})))}))}initialize(){const e=e=>{this.updatingHandles.addPromise(this._updateHighlightedFeaturesSymbols(e).catch((()=>{}))),this.updateHighlightedFeatures(this._highlightGeometriesResolution)};this.addHandles([(0,n.aG)((()=>this.highlightGraphics),"change",(t=>e(t.added)),{onListenerAdd:t=>e(t)})])}async fetchPopupFeaturesAtLocation(e,t){const{layerView:{layer:r,view:{scale:i}}}=this;if(!e)throw new n.s("fetchPopupFeatures:invalid-area","Nothing to fetch without area",{layer:r});const o=_(r.sublayers,i,t);if(!o.length)return[];const s=await F(r,o);if(!((r.capabilities?.operations?.supportsIdentify??1)&&r.version>=10.5)&&!s)throw new n.s("fetchPopupFeatures:not-supported","query operation is disabled for this service",{layer:r});return s?this._fetchPopupFeaturesUsingQueries(e,o,t):this._fetchPopupFeaturesUsingIdentify(e,o,t)}clearHighlights(){this.highlightGraphics?.removeAll()}highlight(e){const t=this.highlightGraphics;if(!e||!t)return E;let r=(0,o.H)(e)?[e]:n.V.isCollection(e)?e.toArray():Array.isArray(e)?e:[];if(r=r?.filter(n.bQ),0===(r?.length??0))return E;for(const i of r){const{sourceLayer:e}=i;null!=e&&"geometryType"in e&&"point"===e.geometryType&&(i.visible=!1)}return t.addMany(r),(0,n.aH)((()=>t.removeMany(r??[])))}async _updateHighlightedFeaturesSymbols(e){const{layerView:{view:t},highlightGraphics:i,highlightGraphicUpdated:o}=this;if(i&&o)for(const s of e){const e=s.sourceLayer&&"renderer"in s.sourceLayer&&s.sourceLayer.renderer;s.sourceLayer&&"geometryType"in s.sourceLayer&&"point"===s.sourceLayer.geometryType&&e&&"getSymbolAsync"in e&&e.getSymbolAsync(s).then((async a=>{a||=new n.de;let l=null;const u="visualVariables"in e?e.visualVariables?.find((e=>"size"===e.type)):void 0;u&&(O||(O=(await r.e(6404).then(r.bind(r,76404))).getSize),l=O(u,s,{view:t.type,scale:t.scale,shape:"simple-marker"===a.type?a.style:null})),l||="width"in a&&"height"in a&&null!=a.width&&null!=a.height?Math.max(a.width,a.height):"size"in a?a.size:16,i.includes(s)&&(s.symbol=new n.de({style:"square",size:l,xoffset:"xoffset"in a?a.xoffset:0,yoffset:"yoffset"in a?a.yoffset:0}),o(s,"symbol"),s.visible=!0)}))}}async _updateHighlightedFeaturesGeometries(e){const{layerView:{layer:t,view:r},highlightGraphics:i,highlightGraphicUpdated:o}=this;if(this._highlightGeometriesResolution=e,!o||!i?.length||!t.capabilities.operations.supportsQuery)return;const s=this._getTargetResolution(e),a=new Map;for(const p of i)if(!this._featuresResolutions.has(p)||this._featuresResolutions.get(p)>s){const e=p.sourceLayer;(0,n.ao)(a,e,(()=>new Map)).set(p.getObjectId(),p)}const l=Array.from(a,(([e,t])=>{const i=e.createQuery();return i.objectIds=[...t.keys()],i.outFields=[e.objectIdField],i.returnGeometry=!0,i.maxAllowableOffset=s,i.outSpatialReference=r.spatialReference,e.queryFeatures(i)})),u=await Promise.all(l);if(!this.destroyed)for(const{features:n}of u)for(const e of n){const t=e.sourceLayer,r=a.get(t).get(e.getObjectId());r&&i.includes(r)&&(r.geometry=e.geometry,o(r,"geometry"),this._featuresResolutions.set(r,s))}}_getTargetResolution(e){const t=e*(0,n.bq)(this.layerView.view.spatialReference),r=t/16;return r<=10?0:e/t*r}async _fetchPopupFeaturesUsingIdentify(e,t,r){const i=await this._createIdentifyParameters(e,t,r);if(null==i)return[];const{results:n}=await x(this.layerView.layer.parsedUrl,i,r);return n.map((e=>e.feature))}async _createIdentifyParameters(e,t,r){const{floors:i,layer:o,timeExtent:a,view:{spatialReference:u,scale:p}}=this.layerView;if(!t.length)return null;await Promise.all(t.map((({sublayer:e})=>e.load(r).catch((()=>{})))));const y=Math.min((0,n.a$)("mapservice-popup-identify-max-tolerance"),o.allSublayers.reduce(((e,t)=>t.renderer?(0,l.o)({renderer:t.renderer,pointerType:r?.pointerType}):e),2)),h=this.createFetchPopupFeaturesQueryGeometry(e,y),c=(0,s.o)(p,u),f=Math.round(h.width/c),d=new n.au({xmin:h.center.x-c*f,ymin:h.center.y-c*f,xmax:h.center.x+c*f,ymax:h.center.y+c*f,spatialReference:h.spatialReference});return new b({floors:i,gdbVersion:"gdbVersion"in o?o.gdbVersion:void 0,geometry:e,height:f,layerOption:"popup",mapExtent:d,returnGeometry:!0,spatialReference:u,sublayers:o.sublayers,timeExtent:a,tolerance:y,width:f})}async _fetchPopupFeaturesUsingQueries(e,t,r){const{layerView:{floors:i,timeExtent:o}}=this,s=t.map((async({sublayer:t,popupTemplate:s})=>{if(await t.load(r).catch((()=>{})),t.capabilities&&!t.capabilities.operations.supportsQuery)return[];const u=t.createQuery(),p=(0,l.o)({renderer:t.renderer,pointerType:r?.pointerType}),y=this.createFetchPopupFeaturesQueryGeometry(e,p),h=new Set,[f]=await Promise.all([(0,c.n)(t,s),t.renderer?.collectRequiredFields(h,t.fieldsIndex)]);(0,n.D)(r),(0,n.hg)(h,t.fieldsIndex,f);const d=Array.from(h).sort();u.geometry=y,u.outFields=d,u.timeExtent=o;const m=(0,a.n)(i,t);u.where=(0,n.bt)(u.where,m);const g=this._getTargetResolution(y.width/p),b=await R(s);(0,n.D)(r);const w="point"===t.geometryType||b&&b.arcadeUtils.hasGeometryOperations(s);w||(u.maxAllowableOffset=g);let{features:v}=await t.queryFeatures(u,r);const x=w?0:g;v=await L(t,v,r);for(const e of v)this._featuresResolutions.set(e,x);return v}));return(await Promise.allSettled(s)).reduce(((e,t)=>"fulfilled"===t.status?[...e,...t.value]:e),[]).filter(n.bQ)}};function _(e,t,r){const i=[];if(!e)return i;const n=e=>{const o=0===e.minScale||t<=e.minScale,s=0===e.maxScale||t>=e.maxScale;if(e.visible&&o&&s)if(e.sublayers)e.sublayers.forEach(n);else if(e.popupEnabled){const t=(0,c.p)(e,{...r,defaultPopupTemplateEnabled:!1});null!=t&&i.unshift({sublayer:e,popupTemplate:t})}};return e.map(n),i}function R(e){return e.expressionInfos?.length||Array.isArray(e.content)&&e.content.some((e=>"expression"===e.type))?(0,n.bG)():Promise.resolve()}async function F(e,t){if(e.capabilities?.operations?.supportsQuery)return!0;try{return await Promise.any(t.map((({sublayer:e})=>e.load().then((()=>e.capabilities.operations.supportsQuery)))))}catch{return!1}}async function L(e,t,r){const i=e.renderer;return i&&"defaultSymbol"in i&&!i.defaultSymbol&&(t=i.valueExpression?await Promise.all(t.map((e=>i.getSymbolAsync(e,r).then((t=>t?e:null))))).then((e=>e.filter((e=>null!=e)))):t.filter((e=>null!=i.getSymbol(e)))),t}(0,n.k)([(0,n.o)({constructOnly:!0})],P.prototype,"createFetchPopupFeaturesQueryGeometry",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],P.prototype,"layerView",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],P.prototype,"highlightGraphics",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],P.prototype,"highlightGraphicUpdated",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],P.prototype,"updatingHandles",void 0),P=(0,n.k)([(0,n.A)("esri.views.layers.support.MapServiceLayerViewHelper")],P)},75286:function(e,t,r){r.d(t,{i:function(){return p},o:function(){return l},r:function(){return u}});var i=r(98503);function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function o(e){let t=0,r=0;for(let i=0;i<e.length;i++){const n=e[i].size;"number"==typeof n&&(t+=n,r++)}return t/r}function s(e,t){return"number"==typeof e?e:e?.stops?.length?o(e.stops):t}function a(e,t){if(!t)return e;const r=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:r,minSize:i}=t;return(s(r,e)+s(i,e))/2}));let i=0;const n=r.length;if(0===n)return e;for(let s=0;s<n;s++)i+=r[s];const o=Math.floor(i/n);return Math.max(o,e)}function l(e){const t=e?.renderer,r=e?.pointerType,i="touch"===r?9:6;if(!t)return i;const o="visualVariables"in t?a(i,t.visualVariables):i;if("simple"===t.type)return n(o,t.symbol);if("unique-value"===t.type){let e=o;return t.uniqueValueInfos?.forEach((t=>{e=n(e,t.symbol)})),e}if("class-breaks"===t.type){let e=o;return t.classBreakInfos.forEach((t=>{e=n(e,t.symbol)})),e}return"dot-density"===t.type||t.type,o}function u(e,t,r,n=new i.au){let o=0;if("2d"===r.type)o=t*(r.resolution??0);else if("3d"===r.type){const n=r.overlayPixelSizeInMapUnits(e),s=r.basemapSpatialReference;o=null==s||s.equals(r.spatialReference)?t*n:(0,i.bq)(s)/(0,i.bq)(r.spatialReference)}const s=e.x-o,a=e.y-o,l=e.x+o,u=e.y+o,{spatialReference:p}=r;return n.xmin=Math.min(s,l),n.ymin=Math.min(a,u),n.xmax=Math.max(s,l),n.ymax=Math.max(a,u),n.spatialReference=p,n}function p(e,t,r){const i=r.toMap(e);return null!=i&&u(i,l(),r,y).intersects(t)}const y=new i.au},49600:function(e,t,r){function i(e){const t=e.layer;return"floorInfo"in t&&t.floorInfo?.floorField&&"floors"in e.view?o(e.view.floors,t.floorInfo.floorField):null}function n(e,t){return"floorInfo"in t&&t.floorInfo?.floorField?o(e,t.floorInfo.floorField):null}function o(e,t){if(!e?.length)return null;const r=e.filter((e=>""!==e)).map((e=>`'${e}'`));return r.push("''"),`${t} IN (${r.join(",")}) OR ${t} IS NULL`}r.d(t,{n:function(){return n},o:function(){return i}})},82047:function(e,t,r){r.d(t,{d:function(){return a},i:function(){return o},o:function(){return s}});var i=r(98503);const n=96;function o(e,t){const r=e.extent,o=e.width,s=(0,i.bq)(r?.spatialReference);return r&&o?r.width/o*s*i.br*n:0}function s(e,t){return e/((0,i.bq)(t)*i.br*n)}function a(e,t,r){return l(e,t)&&u(e,r)}function l(e,t){return 0===t||(0,i.bs)(e,t)||e<t}function u(e,t){return 0===t||(0,i.bs)(e,t)||e>t}},22102:function(e,t,r){r.d(t,{e:function(){return n},n:function(){return o},o:function(){return a}});var i=r(98503);function n(e,t,r){return t.flatten((({sublayers:e})=>e)).length!==e.length||(!!e.some((e=>e.originIdOf("minScale")>r||e.originIdOf("maxScale")>r||e.originIdOf("renderer")>r||e.originIdOf("labelingInfo")>r||e.originIdOf("opacity")>r||e.originIdOf("labelsVisible")>r||e.originIdOf("source")>r))||!s(e,t))}function o(e,t,r){return!!e.some((e=>{const t=e.source,n=!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(null==t.gdbVersion||t.gdbVersion===r);return e.commitProperty("renderer"),e.commitProperty("labelingInfo"),e.commitProperty("opacity"),e.commitProperty("labelsVisible"),!n||e.originIdOf("renderer")>i.bm.SERVICE||e.originIdOf("labelingInfo")>i.bm.SERVICE||e.originIdOf("opacity")>i.bm.SERVICE||e.originIdOf("labelsVisible")>i.bm.SERVICE}))||!s(e,t)}function s(e,t){if(!e?.length||null==t)return!0;const r=t.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let i=0;const n=r.length;for(const{id:o}of e){for(;i<n&&r[i]!==o;)i++;if(i>=n)return!1}return!0}function a(e){return!!e&&e.some((e=>null!=e.minScale||null!=e.layerDefinition?.minScale))}},43783:function(e,t,r){r.d(t,{i:function(){return s}});r(98503);var i=r(50257);r(80774);function n(e){if(!e)return e;const{start:t,end:r}=e;return new i.p({start:null!=t?(0,i.o)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=r?(0,i.o)(r,-r.getTimezoneOffset(),"minutes"):r})}function o(e){if(!e)return e;const{start:t,end:r}=e;return new i.p({start:null!=t?(0,i.o)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=r?(0,i.o)(r,r.getTimezoneOffset(),"minutes"):r})}function s(e,t,r){if(null==e?.timeInfo)return null;const{datesInUnknownTimezone:i=!1,timeOffset:s,useViewTime:a}=e;let l=e.timeExtent;i&&(l=o(l));let u=a?t&&l?t.intersection(l):t||l:l;return!u||u.isEmpty||u.isAllTime?u:(s&&(u=u.offset(-s.value,s.unit)),i&&(u=n(u)),u.equals(r)?r:u)}}}]);
//# sourceMappingURL=7806.55511fc8.js.map