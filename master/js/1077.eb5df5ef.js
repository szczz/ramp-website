"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[1077],{71077:function(e,a,t){t.r(a),t.d(a,{default:function(){return H}});var l=t(98503);const r={class:"rv-geosearch-bar relative h-26 mx-8 mb-8"},s=["placeholder","value","aria-label"],o={class:"absolute inset-y-0 right-8 grid w-10 place-content-center"},d=["aria-label","content"],n=(0,l.dM)({__name:"search-bar",setup(e){const{t:a}=(0,l.dN)(),t=(0,l.g4)(),n=(0,l.dO)(),c=(0,l.dQ)((()=>t.searchVal)),i=(0,l.dQ)((()=>['"',"$","!","*","+","?","^","{","}","(",")","|","[","]"].filter((e=>t.searchVal.includes(e))).join(""))),u=e=>{t.setSearchTerm(e),t.setSearchRegex(e)},b=(0,l.e5)(500,(e=>{u(e)}));return(e,t)=>{const u=(0,l.dS)("tippy");return(0,l.dU)(),(0,l.dY)("div",r,[(0,l.dX)("input",{type:"text",class:(0,l.d_)(["border-b w-full text-base py-8 outline-none focus:shadow-outline border-gray-600 h-full min-w-0",{"border-yellow-500":i.value}]),placeholder:(0,l.e0)(a)("geosearch.searchText"),value:c.value,onInput:t[0]||(t[0]=e=>(0,l.e0)(b)(e.target.value)),onKeyup:t[1]||(t[1]=(0,l.gj)((e=>{(0,l.e0)(n).mobileView&&e.target.blur()}),["enter"])),"aria-label":(0,l.e0)(a)("geosearch.searchText"),onKeypress:t[2]||(t[2]=(0,l.gj)((0,l.gi)((()=>{}),["prevent"]),["enter"])),enterkeyhint:"done"},null,42,s),(0,l.dX)("span",o,[i.value?(0,l.dT)(((0,l.dU)(),(0,l.dY)("button",{key:0,class:"cursor-default","aria-label":(0,l.e0)(a)("geosearch.badChars",{chars:i.value}),content:(0,l.e0)(a)("geosearch.badChars",{chars:i.value})},t[3]||(t[3]=[(0,l.ea)(" âš  ")]),8,d)),[[u]]):(0,l.eb)("",!0)])])}}}),c={class:"rv-geosearch-top-filters sm:flex items-center w-full ml-8 mb-14"},i={class:"w-fit inline-block sm:w-1/2 h-26 mb-8 sm:mb-0 pr-16 sm:pr-0"},u=["value","aria-label"],b={value:"",disabled:"",hidden:""},p={class:"sm:w-1/2 h-26 sm:mx-16 flex"},v=["value","aria-label"],g={value:"",disabled:"",hidden:""},h=["disabled","content","aria-label"],f=(0,l.dM)({__name:"top-filters",setup(e){const{t:a}=(0,l.dN)(),t=(0,l.e2)("iApi"),r=(0,l.g4)(),s=(0,l.e3)([]),o=(0,l.e3)([]),d=(0,l.e3)([]),n=(0,l.dQ)((()=>r.queryParams)),f=(0,l.dQ)((()=>t.language)),m=e=>r.setProvince(e),y=e=>r.setType(e),x=()=>{m({}),y({})},w=()=>{r.initService(t.language,t.fixture.get("geosearch").config);const e=s.value.find((e=>n.value.province===e.name))?.code,a=o.value.find((e=>n.value.type===e.name))?.code;r.getProvinces.then((a=>{s.value=a,m({province:a.find((a=>a.code===e))?.name,forceReRun:!0})})),r.getTypes.then((e=>{o.value=e,y({type:e.find((e=>e.code===a))?.name,forceReRun:!0})}))};return(0,l.e6)((()=>{w(),d.value.push((0,l.e7)(f,w))})),(0,l.e9)((()=>{d.value.forEach((e=>e()))})),(e,t)=>{const r=(0,l.dS)("truncate"),d=(0,l.dS)("tippy");return(0,l.dU)(),(0,l.dY)("div",c,[(0,l.dX)("div",i,[(0,l.dT)(((0,l.dU)(),(0,l.dY)("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer",value:n.value.province,"aria-label":(0,l.e0)(a)("geosearch.filters.province"),onChange:t[0]||(t[0]=e=>m({province:e.target.value}))},[(0,l.dT)(((0,l.dU)(),(0,l.dY)("option",b,[(0,l.ea)((0,l.d$)((0,l.e0)(a)("geosearch.filters.province")),1)])),[[r]]),((0,l.dU)(!0),(0,l.dY)(l.e1,null,(0,l.dZ)(s.value,(e=>(0,l.dT)(((0,l.dU)(),(0,l.dY)("option",{key:e.code},[(0,l.ea)((0,l.d$)(e.name),1)])),[[r]]))),128))],40,u)),[[r]])]),(0,l.dX)("div",p,[(0,l.dT)(((0,l.dU)(),(0,l.dY)("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer max-w-150",value:n.value.type,"aria-label":(0,l.e0)(a)("geosearch.filters.type"),onChange:t[1]||(t[1]=e=>y({type:e.target.value}))},[(0,l.dX)("option",g,(0,l.d$)((0,l.e0)(a)("geosearch.filters.type")),1),((0,l.dU)(!0),(0,l.dY)(l.e1,null,(0,l.dZ)(o.value,(e=>((0,l.dU)(),(0,l.dY)("option",{key:e.code},(0,l.d$)(e.name),1)))),128))],40,v)),[[r]]),(0,l.dT)(((0,l.dU)(),(0,l.dY)("button",{type:"button",class:"text-gray-500 w-1/8 h-24 pl-8 pr-16 sm:pr-8 hover:text-black disabled:cursor-default disabled:text-gray-400",disabled:!n.value.type&&!n.value.province,onClick:x,content:(0,l.e0)(a)("geosearch.filters.clear"),"aria-label":(0,l.e0)(a)("geosearch.filters.clear")},t[2]||(t[2]=[(0,l.dX)("div",{class:"rv-geosearch-icon"},[(0,l.dX)("svg",{class:"fill-current w-18 h-18",viewBox:"0 0 23 21"},[(0,l.dX)("path",{d:"M 14.7574,20.8284L 17.6036,17.9822L 14.7574,15.1716L 16.1716,13.7574L 19.0178,16.568L 21.8284,13.7574L 23.2426,15.1716L 20.432,17.9822L 23.2426,20.8284L 21.8284,22.2426L 19.0178,19.3964L 16.1716,22.2426L 14.7574,20.8284 Z M 2,2L 19.9888,2.00001L 20,2.00001L 20,2.01122L 20,3.99999L 19.9207,3.99999L 13,10.9207L 13,22.909L 8.99999,18.909L 8.99999,10.906L 2.09405,3.99999L 2,3.99999L 2,2 Z "})])],-1)]),8,h)),[[d,{placement:"bottom"}]])])])}}}),m={class:"rv-geosearch-bottom-filters"},y={class:"bg-white"},x={class:"ml-8 cursor-pointer font-normal"},w=["checked"],L=(0,l.dM)({__name:"bottom-filters",setup(e){const{t:a}=(0,l.dN)(),t=(0,l.e2)("iApi"),r=(0,l.g4)(),s=(0,l.dQ)((()=>r.resultsVisible)),o=(0,l.e5)(300,(e=>{n(e).then((e=>{d({extent:e,visible:s.value})}))})),d=e=>{r.setMapExtent(e)},n=async e=>4326===e.sr.wkid?e:await t.geo.proj.projectGeometry(4326,e),c=e=>{n(t.geo.map.getExtent()).then((a=>{d({extent:a,visible:e})}))};return(0,l.e8)((()=>{t.event.on(l.dE.MAP_EXTENTCHANGE,o,"geosearch_map_extent")})),(0,l.e9)((()=>{t.event.off("geosearch_map_extent")})),(e,t)=>((0,l.dU)(),(0,l.dY)("div",m,[(0,l.dX)("div",y,[(0,l.dX)("label",x,[(0,l.dX)("input",{type:"checkbox",class:"border-2 mx-8 border-gray-600 cursor-pointer",checked:s.value,onChange:t[0]||(t[0]=e=>c(e.target.checked)),onKeypress:t[1]||(t[1]=(0,l.gj)((0,l.gi)((()=>{}),["prevent"]),["enter"]))},null,40,w),(0,l.ea)((0,l.d$)((0,l.e0)(a)("geosearch.visible")),1)])])]))}}),k={},U={class:"w-full h-6 relative overflow-hidden rounded-full indeterminate mb-14"},Y={class:"h-full progressbar bg-blue-800 rounded-full top-0","aria-valuemin":"0","aria-valuemax":"100"},T={class:"flex items-center h-full"};function X(e,a){return(0,l.dU)(),(0,l.dY)("div",U,[(0,l.dX)("div",Y,[(0,l.dX)("span",T,[(0,l.gp)(e.$slots,"default",{},void 0,!0)])])])}const _=(0,l.fN)(k,[["render",X],["__scopeId","data-v-0a8d1c36"]]),$={class:"flex flex-col h-full"},R={key:1,class:"text-red-900 text-xs px-8 mb-10"},C={key:2,class:"px-8 mb-10 py-8 flex-grow text-wrap border-y border-gray-600 overflow-y-auto"},M={class:"relative h-48"},S={class:"font-bold text-blue-600"},E={key:3,class:"rv-results-list flex-grow mb-5 border-t border-b border-gray-600 overflow-y-auto"},Q=["onClick"],j={class:"rv-result-description px-8"},N={class:"flex-1 text-left truncate font-bold leading-tight"},V=["innerHTML"],A={key:0,class:"text-gray-600 text-sm"},Z={key:1,class:"hidden"},P={key:2,class:"text-sm font-normal"},H=(0,l.dM)({__name:"screen",props:{panel:{type:Object}},setup(e){const{t:a}=(0,l.dN)(),t=(0,l.e2)("iApi"),r=(0,l.g4)(),s=(0,l.dQ)((()=>r.searchVal.replace(/["!*$+?^{}()|[\]\\]/g,"").trim())),o=(0,l.dQ)((()=>r.searchResults)),d=(0,l.dQ)((()=>r.loadingResults)),c=(0,l.dQ)((()=>r.failedServices)),i=e=>{const a=new l.hq("zoomies",[[[e.bbox[0],e.bbox[1]],[e.bbox[0],e.bbox[3]],[e.bbox[2],e.bbox[3]],[e.bbox[2],e.bbox[1]],[e.bbox[0],e.bbox[1]]]],l.hr.latLongSR(),!0);t.geo.map.zoomMapTo(a)},u=(e,a)=>{const t=e.replace(new RegExp(`${r.searchRegex}`,"gi"),(e=>'<span class="font-bold text-blue-600">'+e+"</span>"));return a?t+",":t};return(t,r)=>{const b=(0,l.dR)("panel-screen"),p=(0,l.dS)("truncate"),v=(0,l.dS)("focus-item"),g=(0,l.dS)("focus-list");return(0,l.dU)(),(0,l.dV)(b,{panel:e.panel},{header:(0,l.dW)((()=>[(0,l.ea)((0,l.d$)((0,l.e0)(a)("geosearch.title")),1)])),content:(0,l.dW)((()=>[(0,l.dX)("div",$,[(0,l.ec)(n),(0,l.ec)(f),d.value?((0,l.dU)(),(0,l.dV)(_,{key:0,class:"flex-none"})):(0,l.eb)("",!0),c.value.length>0&&!d.value?((0,l.dU)(),(0,l.dY)("div",R,(0,l.d$)((0,l.e0)(a)("geosearch.serviceError",{services:c.value.join(", ")})),1)):(0,l.eb)("",!0),s.value&&0===o.value.length&&!d.value?((0,l.dU)(),(0,l.dY)("div",C,[(0,l.dX)("span",M,[(0,l.ea)((0,l.d$)((0,l.e0)(a)("geosearch.noResults")),1),(0,l.dX)("span",S,'"'+(0,l.d$)(s.value)+'"',1)])])):(0,l.eb)("",!0),o.value.length>0?(0,l.dT)(((0,l.dU)(),(0,l.dY)("ul",E,[((0,l.dU)(!0),(0,l.dY)(l.e1,null,(0,l.dZ)(o.value,((e,a)=>((0,l.dU)(),(0,l.dY)("li",{class:"relative h-56",key:a},[(0,l.dT)(((0,l.dU)(),(0,l.dY)("button",{type:"button",class:"absolute inset-0 h-full w-full hover:bg-gray-300 default-focus-style",onClick:a=>i(e),style:{"border-bottom":"1px solid lightgray"},"truncate-trigger":""},[(0,l.dX)("div",j,[(0,l.dT)(((0,l.dU)(),(0,l.dY)("div",N,[(0,l.dX)("span",{innerHTML:u(e.name,e.location.province)},null,8,V),e.location.province?((0,l.dU)(),(0,l.dY)("span",A,(0,l.d$)(e.location.city?" "+e.location.city+", "+e.location.province.abbr:" "+e.location.province.abbr),1)):(0,l.eb)("",!0),e.type?((0,l.dU)(),(0,l.dY)("span",Z,"; ")):(0,l.eb)("",!0),e.type?((0,l.dU)(),(0,l.dY)("span",P,[r[0]||(r[0]=(0,l.dX)("br",null,null,-1)),(0,l.ea)((0,l.d$)(e.type),1)])):(0,l.eb)("",!0)])),[[p,{externalTrigger:!0,options:{placement:"top-start"}}]])])],8,Q)),[[v,"show-truncate"]])])))),128))])),[[g]]):(0,l.eb)("",!0),(0,l.ec)(L,{class:"mt-auto"})])])),_:1},8,["panel"])}}})}}]);
//# sourceMappingURL=1077.eb5df5ef.js.map