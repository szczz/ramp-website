"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[6404],{53851:function(e,n,i){var t,a;function r(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function l(e){return null!=e&&!isNaN(e)&&isFinite(e)}function s(e){return e.valueExpression?t.Expression:e.field&&"string"==typeof e.field?t.Field:t.Unknown}function o(e,n){const i=n||s(e),r=e.valueUnit||"unknown";return i===t.Unknown?a.Constant:e.stops?a.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?a.ClampedLinear:"unknown"===r?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?a.Proportional:a.Additive:a.Identity:a.RealWorldSize}i.d(n,{a:function(){return o},e:function(){return r},i:function(){return a},l:function(){return l},n:function(){return t},t:function(){return s}}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(t||(t={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(a||(a={}))},76404:function(e,n,i){i.r(n),i.d(n,{getAllSizes:function(){return D},getColor:function(){return d},getOpacity:function(){return p},getRotationAngle:function(){return m},getSize:function(){return V},getSizeForValue:function(){return C},getSizeFromNumberOrVariable:function(){return h},viewScaleRE:function(){return f}});var t=i(98503),a=i(49329),r=i(64131),l=i(53851);const s=()=>t.n.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),o=e=>s().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${e}`),u=()=>s().error("Use of arcade expressions requires an arcade context");new t.b1;const c=Math.PI,f=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function d(e,n,i){const a="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!a)return;if("esri.renderers.visualVariables.ColorVariable"!==a.declaredClass)return void o("ColorVariable");const r="number"==typeof n,l=r?null:n,s=l?.attributes;let c=r?n:null;const f=a.field,{ipData:d,hasExpression:p}=a.cache;let m=a.cache.compiledFunc;if(!f&&!p){const e=a.stops;return e&&e[0]&&e[0].color}if("number"!=typeof c)if(p){if(null==i?.arcade)return void u();const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,t=n.getViewInfo(e),r=n.createExecContext(l,t,i.timeZone);if(!m){const e=n.createSyntaxTree(a.valueExpression);m=n.createFunction(e),a.cache.compiledFunc=m}c=n.executeFunction(m,r)}else s&&(c=s[f]);const v=a.normalizationField,b=null!=s&&null!=v?parseFloat(s[v]):void 0;if(null!=c&&(!v||r||!isNaN(b)&&0!==b)){isNaN(b)||r||(c/=b);const e=k(c,d);if(e){const n=e[0],r=e[1],l=n===r?a.stops[n].color:t.aC.blendColors(a.stops[n].color,a.stops[r].color,e[2],i?.color);return new t.aC(l)}}}function p(e,n,i){const t="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!t)return;if("esri.renderers.visualVariables.OpacityVariable"!==t.declaredClass)return void o("OpacityVariable");const a="number"==typeof n,r=a?null:n,l=r?.attributes;let s=a?n:null;const c=t.field,{ipData:f,hasExpression:d}=t.cache;let p=t.cache.compiledFunc;if(!c&&!d){const e=t.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof s)if(d){if(null==i?.arcade)return void u();const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,a=n.getViewInfo(e),l=n.createExecContext(r,a,i.timeZone);if(!p){const e=n.createSyntaxTree(t.valueExpression);p=n.createFunction(e),t.cache.compiledFunc=p}s=n.executeFunction(p,l)}else l&&(s=l[c]);const m=t.normalizationField,v=null!=l&&null!=m?parseFloat(l[m]):void 0;if(null!=s&&(!m||a||!isNaN(v)&&0!==v)){isNaN(v)||a||(s/=v);const e=k(s,f);if(e){const n=e[0],i=e[1];if(n===i)return t.stops[n].opacity;{const a=t.stops[n].opacity;return a+(t.stops[i].opacity-a)*e[2]}}}}function m(e,n,i){const t="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!t)return;if("esri.renderers.visualVariables.RotationVariable"!==t.declaredClass)return void o("RotationVariable");const a=t.axis||"heading",r="heading"===a&&"arithmetic"===t.rotationType?90:0,l="heading"===a&&"arithmetic"===t.rotationType?-1:1,s="number"==typeof n?null:n,c=s?.attributes,f=t.field,{hasExpression:d}=t.cache;let p=t.cache.compiledFunc,m=0;if(!f&&!d)return m;if(d){if(null==i?.arcade)return void u();const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,a=n.getViewInfo(e),r=n.createExecContext(s,a,i.timeZone);if(!p){const e=n.createSyntaxTree(t.valueExpression);p=n.createFunction(e),t.cache.compiledFunc=p}m=n.executeFunction(p,r)}else c&&(m=c[f]||0);return m="number"!=typeof m||isNaN(m)?null:r+l*m,m}function v(e,n,i){const t="number"==typeof n,a=t?null:n,r=a?.attributes;let s=t?n:null;const{isScaleDriven:o}=e.cache;let c=e.cache.compiledFunc;if(o){const n=i?.scale,t=i?.view;s=null==n||"3d"===t?b(e):n}else if(!t)switch(e.inputValueType){case l.n.Expression:{if(null==i?.arcade)return void u();const n={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(n),l=t.createExecContext(a,r,i.timeZone);if(!c){const n=t.createSyntaxTree(e.valueExpression);c=t.createFunction(n),e.cache.compiledFunc=c}s=t.executeFunction(c,l);break}case l.n.Field:r&&(s=r[e.field]);break;case l.n.Unknown:s=null}if(!(0,l.l)(s))return null;if(t||!e.normalizationField)return s;const f=r?parseFloat(r[e.normalizationField]):null;return(0,l.l)(f)&&0!==f?s/f:null}function b(e){let n=null,i=null;const t=e.stops;return t?(n=t[0].value,i=t[t.length-1].value):(n=e.minDataValue||0,i=e.maxDataValue||0),(n+i)/2}function V(e,n,i){const t="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!t)return;if("esri.renderers.visualVariables.SizeVariable"!==t.declaredClass)return void o("SizeVariable");const a=C(v(t,n,i),t,n,i,t.cache.ipData);return null==a||isNaN(a)?0:a}function h(e,n,i){return null==e?null:(0,l.e)(e)?V(e,n,i):(0,l.l)(e)?e:null}function x(e,n,i){return(0,l.l)(i)&&e>i?i:(0,l.l)(n)&&e<n?n:e}function w(e,n,i,t){return e+((h(n.minSize,i,t)||n.minDataValue)??0)}function y(e,n,i){const t=e.stops;let a=t?.length&&t[0].size;return null==a&&(a=e.minSize),h(a,n,i)}function g(e,n,i,t){const a=(e-n.minDataValue)/(n.maxDataValue-n.minDataValue),r=h(n.minSize,i,t),l=h(n.maxSize,i,t),s=t?.shape;if(e<=n.minDataValue)return r;if(e>=n.maxDataValue)return l;if(null==r||null==l)return null;if("area"===n.scaleBy&&s){const e="circle"===s,n=e?c*(r/2)**2:r*r,i=n+a*((e?c*(l/2)**2:l*l)-n);return e?2*Math.sqrt(i/c):Math.sqrt(i)}return r+a*(l-r)}function z(e,n,i,t){const a=t?.shape,r=e/n.minDataValue,l=h(n.minSize,i,t),s=h(n.maxSize,i,t);let o=null;return o="circle"===a?2*Math.sqrt(r*(l/2)**2):"square"===a||"diamond"===a||"image"===a?Math.sqrt(r*l**2):r*l,x(o,l,s)}function S(e,n,i,t,a){const[r,l,s]=k(e,a);if(r===l)return h(n.stops?.[r].size,i,t);{const e=h(n.stops?.[r].size,i,t);return e+(h(n.stops?.[l].size,i,t)-e)*s}}function F(e,n,i,t){const a=(t?.resolution??1)*r.m[n.valueUnit],l=h(n.minSize,i,t),s=h(n.maxSize,i,t),{valueRepresentation:o}=n;let u=null;return u="area"===o?2*Math.sqrt(e/c)/a:"radius"===o||"distance"===o?2*e/a:e/a,x(u,l,s)}function C(e,n,i,t,a){switch(n.transformationType){case l.i.Additive:return w(e,n,i,t);case l.i.Constant:return y(n,i,t);case l.i.ClampedLinear:return g(e,n,i,t);case l.i.Proportional:return z(e,n,i,t);case l.i.Stops:return S(e,n,i,t,a);case l.i.RealWorldSize:return F(e,n,i,t);case l.i.Identity:return e;case l.i.Unknown:return null}}function k(e,n){if(!n)return;let i=0,t=n.length-1;return n.some(((n,a)=>e<n?(t=a,!0):(i=a,!1))),[i,t,(e-n[i])/(n[t]-n[i])]}function D(e,n,i){const t=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":V(r,n,i);switch(r.axis){case"width":t[0]=e;break;case"depth":t[1]=e;break;case"height":t[2]=e;break;case"width-and-depth":t[0]=e,t[1]=e;break;case"all":case void 0:case null:t[0]=e,t[1]=e,t[2]=e;break;default:(0,a.n)(r.axis)}}return t}}}]);
//# sourceMappingURL=6404.98f73b8b.js.map