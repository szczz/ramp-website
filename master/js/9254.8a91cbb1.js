"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[9254],{56201:function(e,t,r){r.d(t,{F:function(){return w},a:function(){return d},c:function(){return h},i:function(){return u},o:function(){return l},p:function(){return m},t:function(){return s}});var n=r(98503),i=r(77998);const s=(0,i.o)(),o=new Map,a=new Map;async function l(e,t,r){if(!e||!r)return!1;if(!t)return!0;const i=new URL(e).host;let s=o.get(i);if(!s){const t=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await(0,n.U)(t,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===t}async function u(e,t,n=!1){if(!e||!t)return!0;const i=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),o=a.get(i)?.entries();if(o)for(const[a,l]of o)if(l.name===t){const e=!l.stack?.hasForwardEdits();if(!e&&n){const[{deleteForwardEdits:e},{default:t}]=await Promise.all([r.e(8624).then(r.bind(r,58624)),r.e(4616).then(r.bind(r,34616))]),n=await e(i,a,new t({sessionId:s,moment:l.moment}));return n.success&&l.stack?.clearForwardEdits(),n.success}return e}return!0}function d(e,t){if(!e)return!1;const r=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=a.get(r)?.entries();if(n)for(const[i,s]of n)if(s.name===t)return"edit"===s.lockType;return!1}const c=new n.bP.EventEmitter;function p(e){return c.on("apply-edits",new WeakRef(e))}function f(e){return c.on("update-moment",new WeakRef(e))}function h(e,t,r=null,i=!1){const s=(0,n.aM)();return i=null==t||i,c.emit("apply-edits",{serviceUrl:e,layerId:t,gdbVersion:r,mayReceiveServiceEdits:i,result:s.promise}),s}const y=Symbol();function m(e){return null!=e&&"object"==typeof e&&y in e}function g(e){return null!=e&&"object"==typeof e&&"gdbVersion"in e}function v(e,t,r){const n=new URL(e).host,i=o.get(n),s=e=>!e||e===i;return s(t)&&s(r)||t===r}const w=e=>{var t;let r=class extends e{constructor(...e){super(...e),this[t]=!0,this._applyEditsHandler=e=>{const{serviceUrl:t,layerId:r,gdbVersion:i,mayReceiveServiceEdits:s,result:o}=e,a=t===this.url,l=null!=r&&null!=this.layerId&&r===this.layerId,u=g(this),d=g(this)&&v(t,i,this.gdbVersion);if(!a||u&&!d||!l&&!s)return;const c=o.then((e=>{if(this.lastEditsEventDate=new Date,l&&(e.addedFeatures.length||e.updatedFeatures.length||e.deletedFeatures.length||e.addedAttachments.length||e.updatedAttachments.length||e.deletedAttachments.length))return this.emit("edits",(0,n.f)(e)),e;const r=e.editedFeatures?.find((({layerId:e})=>e===this.layerId));if(r){const{adds:t,updates:i,deletes:s}=r.editedFeatures,o={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:t?t.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],deletedFeatures:s?s.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],updatedFeatures:i?i.map((({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],editedFeatures:(0,n.f)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,n.f)(e.historicMoment)};return this.emit("edits",o),o}const s={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:(0,n.f)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,n.f)(e.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(t,i,s.historicMoment)&&this.emit("edits",s),s})).then((e=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(t,i,e.historicMoment)&&(this.historicMoment=e.historicMoment),e)));this.emit("apply-edits",{result:c})},this._updateMomentHandler=e=>{const{serviceUrl:t,gdbVersion:r,moment:n}=e,i=t===this.url,s=g(this),o=g(this)&&v(t,r,this.gdbVersion),a=g(this)&&!v(t,this.gdbVersion,null);i&&s&&o&&a&&"historicMoment"in this&&this.historicMoment!==n&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles(p(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(f(this._updateMomentHandler))}),(()=>{}))}_shouldUpdateHistoricMoment(e,t,r){return"historicMoment"in this&&this.historicMoment!==r&&d(e,t)}};return t=y,(0,n.k)([(0,n.o)()],r.prototype,"lastEditsEventDate",void 0),r=(0,n.k)([(0,n.A)("esri.layers.mixins.EditBusLayer")],r),r}},2776:function(e,t,r){r.d(t,{p:function(){return a},t:function(){return i}});var n=r(98503);let i=class extends n.v{constructor(){super(...arguments),this.type=null}};var s;(0,n.k)([(0,n.o)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],i.prototype,"type",void 0),i=(0,n.k)([(0,n.A)("esri.layers.support.FeatureReduction")],i);let o=s=class extends i{constructor(e){super(e),this.type="selection"}clone(){return new s}};(0,n.k)([(0,n.o)({type:["selection"]})],o.prototype,"type",void 0),o=s=(0,n.k)([(0,n.A)("esri.layers.support.FeatureReductionSelection")],o);const a=o},36879:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(98503),i=r(6435);function s(e){return"timeZone"in e}function o(e){return"timeZone"in e}function a(e){return"dateFieldsTimeZone"in e}const l=new Map;class u{static fromJSON(e){return new u(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new u(e.fields??[],f(e))}static fromLayerJSON(e){return new u(e.fields??[],f(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const r=[];for(const i of this.fields){const e=i?.name,t=c(e);if(e&&t){const s=d(e);this._fieldsMap.set(e,i),this._fieldsMap.set(s,i),this._normalizedFieldsMap.set(t,i),r.push(`${s}:${i.type}:${this._timeZoneByFieldName?.get(e)}`),(0,n.ag)(i)?(this.dateFields.push(i),this._dateFieldsSet.add(i)):(0,n.ah)(i)&&(this._numericFieldsSet.add(i),this.numericFields.push(i)),(0,n.ai)(i)||(0,n.aj)(i)||(i.editable=null==i.editable||!!i.editable,i.nullable=null==i.nullable||!!i.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,n.ai)(e)||(0,n.aj)(e)||e.nullable||void 0!==(0,n.ak)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(d(e))??this._normalizedFieldsMap.get(c(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(n.n.getLogger("esri.layers.support.FieldsIndex").error(new n.s("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),n.al):p.has(t.type)?n.am:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===n.am?i.t.instance:t===n.al?n.an.utcInstance:(0,n.ao)(l,t,(()=>n.a6.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,n.ap)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>(0,n.aq)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function d(e){return e.trim().toLowerCase()}function c(e){return(0,n.ar)(e)?.toLowerCase()??""}const p=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function f(e){const t=new Map;if(!e.fields)return t;const r=!0===e.datesInUnknownTimezone,{timeInfo:i,editFieldsInfo:l}=e,u=(i?"startField"in i?i.startField:i.startTimeField:"")??"",c=(i?"endField"in i?i.endField:i.endTimeField:"")??"",f=a(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,n.as)(e.dateFieldsTimeReference):null,h=l?s(l)?l.timeZone??f:l.dateFieldsTimeReference?(0,n.as)(l.dateFieldsTimeReference):f??n.al:null,y=i?o(i)?i.timeZone??f:i.timeReference?(0,n.as)(i.timeReference):f:null,m=new Map([[d(l?.creationDateField??""),h],[d(l?.editDateField??""),h],[d(u),y],[d(c),y]]);for(const{name:s,type:o}of e.fields)if(p.has(o))t.set(s,n.am);else if("date"!==o&&"esriFieldTypeDate"!==o)t.set(s,null);else if(r)t.set(s,n.am);else{const e=m.get(d(s??""))??f;t.set(s,e)}return t}},55743:function(e,t,r){r.d(t,{a:function(){return a},m:function(){return f},p:function(){return i},y:function(){return u}});var n=r(98503);let i=class extends n.v{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,n.k)([(0,n.o)({type:Number})],i.prototype,"nodesPerPage",void 0),(0,n.k)([(0,n.o)({type:Number})],i.prototype,"rootIndex",void 0),(0,n.k)([(0,n.o)({type:String})],i.prototype,"lodSelectionMetricType",void 0),i=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SNodePageDefinition")],i);let s=class extends n.v{constructor(){super(...arguments),this.factor=1}};(0,n.k)([(0,n.o)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],s.prototype,"id",void 0),(0,n.k)([(0,n.o)({type:Number})],s.prototype,"factor",void 0),s=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SMaterialTexture")],s);let o=class extends n.v{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,n.k)([(0,n.o)({type:[Number]})],o.prototype,"baseColorFactor",void 0),(0,n.k)([(0,n.o)({type:s})],o.prototype,"baseColorTexture",void 0),(0,n.k)([(0,n.o)({type:s})],o.prototype,"metallicRoughnessTexture",void 0),(0,n.k)([(0,n.o)({type:Number})],o.prototype,"metallicFactor",void 0),(0,n.k)([(0,n.o)({type:Number})],o.prototype,"roughnessFactor",void 0),o=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SMaterialPBRMetallicRoughness")],o);let a=class extends n.v{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,n.k)([(0,n.bk)({opaque:"opaque",mask:"mask",blend:"blend"})],a.prototype,"alphaMode",void 0),(0,n.k)([(0,n.o)({type:Number})],a.prototype,"alphaCutoff",void 0),(0,n.k)([(0,n.o)({type:Boolean})],a.prototype,"doubleSided",void 0),(0,n.k)([(0,n.bk)({none:"none",back:"back",front:"front"})],a.prototype,"cullFace",void 0),(0,n.k)([(0,n.o)({type:s})],a.prototype,"normalTexture",void 0),(0,n.k)([(0,n.o)({type:s})],a.prototype,"occlusionTexture",void 0),(0,n.k)([(0,n.o)({type:s})],a.prototype,"emissiveTexture",void 0),(0,n.k)([(0,n.o)({type:[Number]})],a.prototype,"emissiveFactor",void 0),(0,n.k)([(0,n.o)({type:o})],a.prototype,"pbrMetallicRoughness",void 0),a=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SMaterialDefinition")],a);let l=class extends n.v{};(0,n.k)([(0,n.o)({type:String,json:{read:{source:["name","index"],reader:(e,t)=>e??`${t.index}`}}})],l.prototype,"name",void 0),(0,n.k)([(0,n.bk)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],l.prototype,"format",void 0),l=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3STextureFormat")],l);let u=class extends n.v{constructor(){super(...arguments),this.atlas=!1}};(0,n.k)([(0,n.o)({type:[l]})],u.prototype,"formats",void 0),(0,n.k)([(0,n.o)({type:Boolean})],u.prototype,"atlas",void 0),u=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3STextureSetDefinition")],u);let d=class extends n.v{};(0,n.k)([(0,n.bk)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],d.prototype,"type",void 0),(0,n.k)([(0,n.o)({type:Number})],d.prototype,"component",void 0),d=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SGeometryAttribute")],d);let c=class extends n.v{};(0,n.k)([(0,n.bk)({draco:"draco"})],c.prototype,"encoding",void 0),(0,n.k)([(0,n.o)({type:[String]})],c.prototype,"attributes",void 0),c=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SGeometryCompressedAttributes")],c);let p=class extends n.v{constructor(){super(...arguments),this.offset=0}};(0,n.k)([(0,n.o)({type:Number})],p.prototype,"offset",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"position",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"normal",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"uv0",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"color",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"uvRegion",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"featureId",void 0),(0,n.k)([(0,n.o)({type:d})],p.prototype,"faceRange",void 0),(0,n.k)([(0,n.o)({type:c})],p.prototype,"compressedAttributes",void 0),p=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SGeometryBuffer")],p);let f=class extends n.v{};(0,n.k)([(0,n.bk)({triangle:"triangle"})],f.prototype,"topology",void 0),(0,n.k)([(0,n.o)()],f.prototype,"geometryBuffers",void 0),f=(0,n.k)([(0,n.A)("esri.layers.support.I3SLayerDefinitions.I3SGeometryDefinition")],f)},81519:function(e,t,r){r.d(t,{e:function(){return u}});var n=r(98503);const i=-3,s=i-1;var o;(function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"})(o||(o={}));class a{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.bX,this._users=new n.bX}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){return this._db.get(e.id+t)?.size??0}put(e,t,r,n,a){t=e.id+t;const u=this._db.get(t);if(u&&(this._size-=u.size,e.size-=u.size,this._db.delete(t),u.entry!==r&&this._notifyRemove(t,u.entry,u.size,o.ALL)),n>this._maxSize)return void this._notifyRemove(t,r,n,o.ALL);if(void 0===r)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${t}`),void this._notifyRemove(t,r,0,o.ALL);const d=1+Math.max(a,s)-i;this._db.set(t,new l(r,n,d)),this._size+=n,e.size+=n,this._checkSize()}updateSize(e,t,r,n){t=e.id+t;const i=this._db.get(t);if(i&&i.entry===r){for(this._size-=i.size,e.size-=i.size;n>this._maxSize;){const e=this._notifyRemove(t,r,n,o.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);n=e}i.size=n,this._size+=n,e.size+=n,this._checkSize()}}pop(e,t){t=e.id+t;const r=this._db.get(t);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(t),++this._hit,r.entry;++this._miss}get(e,t){t=e.id+t;const r=this._db.get(t);if(void 0!==r)return this._db.delete(t),r.lives=r.lifetime,this._db.set(t,r),++this._hit,r.entry;++this._miss}peek(e,t){const r=this._db.get(e.id+t);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach(((e,n)=>{const i=e.lifetime;r[i]=(r[i]||0)+e.size,this._users.forAll((r=>{const{id:i,name:s}=r;if(n.startsWith(i)){const r=t[s]||0;t[s]=r+e.size}}))}));const n={};this._users.forAll((e=>{const r=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const i=t[r]||0;t[r]=i,n[r]=Math.round(100*e.hitRate)+"%"}else n[r]="0%"}));const s=Object.keys(t);s.sort(((e,r)=>t[r]-t[e])),s.forEach((r=>e[r]=Math.round(t[r]/2**20)+"MB / "+n[r]));for(let o=r.length-1;o>=0;--o){const t=r[o];t&&(e["Priority "+(o+i-1)]=Math.round(t/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,r)=>{r.startsWith(t)&&(this._size-=e.size,this._db.delete(r),this._notifyRemove(r,e.entry,e.size,o.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,e.size,o.ALL))),this._users.forAll((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,r,n){let i;return this._removeFuncs.some((s=>{if(e.startsWith(s[0])){const e=s[1](t,n,r);return"number"==typeof e&&(i=e),!0}return!1})),i}_checkSize(){this._users.forAll((e=>this._checkSizeLimits(e))),this._checkSizeLimits()}_checkSizeLimits(e){const t=e??this;if(t.maxSize<0||t.size<=t.maxSize)return;const r=e?.id;let n=!0;for(;n;){n=!1;for(const[i,s]of this._db)if(0===s.lifetime&&(!r||i.startsWith(r))){if(this._purgeItem(i,s,e),t.size<=.9*t.maxSize)return;n||=this._db.has(i)}}for(const[i,s]of this._db)if((!r||i.startsWith(r))&&(this._purgeItem(i,s,e),t.size<=.9*t.maxSize))return}_purgeItem(e,t,r=this._users.find((t=>e.startsWith(t.id)))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,r&&(r.size-=t.size);const n=this._notifyRemove(e,t.entry,t.size,o.SOME);null!=n&&n>0&&(this._size+=n,r&&(r.size+=n),t.lives=t.lifetime,t.size=n,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}class l{constructor(e,t,r){this.entry=e,this.size=t,this.lifetime=r,this.lives=r}}class u{constructor(e,t){this._storage=new a,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,r=1){this._storage.put(this,e,t,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},25035:function(e,t,r){r.d(t,{p:function(){return o}});var n,i=r(98503);let s=n=class extends i.v{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new i.V}clone(){return new n({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};(0,i.k)([(0,i.o)({type:String,json:{write:!0}})],s.prototype,"floorField",void 0),(0,i.k)([(0,i.o)({json:{read:!1,write:!1}})],s.prototype,"viewAllMode",void 0),(0,i.k)([(0,i.o)({json:{read:!1,write:!1}})],s.prototype,"viewAllLevelIds",void 0),s=n=(0,i.k)([(0,i.A)("esri.layers.support.LayerFloorInfo")],s);const o=s},83424:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(98503);const i=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&s(e,t.effectiveScaleRange);const r=this._get("effectiveScaleRange");return r&&r.minScale===e.minScale&&r.maxScale===e.maxScale?r:e}};return(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,n.k)([(0,n.A)("esri.layers.mixins.ScaleRangeLayer")],t),t};function s(e,t){return e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale,e}},69111:function(e,t,r){r.r(t),r.d(t,{default:function(){return se}});var n=r(98503),i=(r(61140),r(47509)),s=r(88012),o=r(42858),a=r(28252),l=r(65738),u=r(18696),d=r(36313),c=r(99907),p=r(56201),f=r(20784),h=r(50293),y=r(83424),m=r(47100),g=r(47603),v=r(75863),w=r(50257),b=r(5948),I=r(22692),S=r(96197),F=r(20014),x=r(2432),_=r(2776),k=r(86477),L=r(36879),T=r(55743),A=r(48165),E=r(70309),j=r(25035),R=r(33824),O=r(74967),z=r(49555),M=r(21355),D=r(13193),P=r(42630),U=r(43338),N=r(27278),C=r(13487);function $({associatedLayer:e,serviceUpdateTimeStamp:t}){const r=e?.editingInfo?.lastEditDate,n=e?.serverGens,i=null!=r,s=null!=t,o=i&&s&&t.lastUpdate!==r.getTime();return i&&(o||!s&&n?.minServerGen!==n?.serverGen)}const q=e=>{let t=class extends e{constructor(){super(...arguments),this.serviceTimeInfo=null}get timeInfo(){const e=this.associatedLayer?.timeInfo;if(null==e)return null;const t=e.clone();return(0,n.aZ)(t,this.fieldsIndex),t}set timeInfo(e){(0,n.aZ)(e,this.fieldsIndex),this._override("timeInfo",e)}get timeExtent(){return this.associatedLayer?.timeExtent}set timeExtent(e){this._override("timeExtent",e)}get timeOffset(){return this.associatedLayer?.timeOffset}set timeOffset(e){this._override("timeOffset",e)}get datesInUnknownTimezone(){return this.associatedLayer?.datesInUnknownTimezone??!1}set datesInUnknownTimezone(e){this._override("datesInUnknownTimezone",e)}async loadTimeInfoFromService(e){const{serviceTimeInfo:t}=this;if(null==t)return;const{startTimeField:r,endTimeField:n}=t;if(null==r&&null==n||$({associatedLayer:this.associatedLayer,serviceUpdateTimeStamp:this.serviceUpdateTimeStamp}))return;const i=async t=>{let n=null;try{n=(await(this.fetchStatistics?.(t,e)))?.stats}catch{}if(null==n)return null;const{minTimeStr:i,min:s,maxTimeStr:o,max:a}=n,l=t===r?i??s:o??a;return null!=l?new Date(l):null},[s,o]=await Promise.all([i(r),i(n)]);if(null!=r&&null==s||null!=n&&null==o)return;const a=new w.p({start:s,end:o});this.setAtOrigin("timeInfo",new v.d({endField:n,startField:r,fullTimeExtent:a}),"service")}};return(0,n.k)([(0,n.o)({type:v.d,json:{read:!1,write:!1}})],t.prototype,"timeInfo",null),(0,n.k)([(0,n.o)({type:w.p,json:{read:!1,write:!1}})],t.prototype,"timeExtent",null),(0,n.k)([(0,n.o)({type:v.l,json:{read:!1,write:!1}})],t.prototype,"timeOffset",null),(0,n.k)([(0,n.o)({type:Boolean,nonNullable:!0,json:{read:!1,write:!1}})],t.prototype,"datesInUnknownTimezone",null),(0,n.k)([(0,n.o)({type:V,readOnly:!0,json:{read:{source:"timeInfo"}}})],t.prototype,"serviceTimeInfo",void 0),t=(0,n.k)([(0,n.A)("esri.layers.mixins.TemporalSceneLayer")],t),t};let V=class extends n.v{constructor(){super(...arguments),this.endTimeField=null,this.startTimeField=null}};(0,n.k)([(0,n.o)({type:String})],V.prototype,"endTimeField",void 0),(0,n.k)([(0,n.o)({type:String})],V.prototype,"startTimeField",void 0),V=(0,n.k)([(0,n.A)("esri.layers.mixins.TemporalSceneLayer.SceneServiceTimeInfo")],V);let Z=class extends n.v{constructor(){super(...arguments),this.name=null,this.field=null,this.currentRangeExtent=null,this.fullRangeExtent=null,this.type="rangeInfo"}};var G;(0,n.k)([(0,n.o)({type:String,json:{read:!0,write:!0}})],Z.prototype,"name",void 0),(0,n.k)([(0,n.o)({type:String,json:{read:!0,write:!0}})],Z.prototype,"field",void 0),(0,n.k)([(0,n.o)({type:[Number],json:{read:!0,write:!0}})],Z.prototype,"currentRangeExtent",void 0),(0,n.k)([(0,n.o)({type:[Number],json:{read:!0,write:!0}})],Z.prototype,"fullRangeExtent",void 0),(0,n.k)([(0,n.o)({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],Z.prototype,"type",void 0),Z=(0,n.k)([(0,n.A)("esri.layers.support.RangeInfo")],Z);let B=G=class extends((0,n.d9)(n.V.ofType(n.bC))){constructor(e){super(e)}clone(){return new G(this.items.map((e=>e.clone())))}write(e,t){return this.toJSON(t)}toJSON(e){const t=e?.layer?.spatialReference;return t?this.toArray().map((r=>{if(!t.equals(r.spatialReference)){if(!(0,z.J)(r.spatialReference,t))return e?.messages?.push(new n.z("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const i=new n.bC;(0,z.a)(r,i,t),r=i}const i=r.toJSON(e);return delete i.spatialReference,i})).filter((e=>null!=e)):(e?.messages?.push(new n.z("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map((t=>t.toJSON(e))))}static fromJSON(e,t){const r=new G;return e.forEach((e=>r.add(n.bC.fromJSON(e,t)))),r}};B=G=(0,n.k)([(0,n.A)("esri.layers.support.PolygonCollection")],B);const H=B;var Q;let W=Q=class extends n.v{constructor(e){super(e),this.spatialRelationship="disjoint",this.geometries=new H,this._geometriesSource=null}initialize(){this.addHandles((0,n.aG)((()=>this.geometries),"after-changes",(()=>this.geometries=this.geometries),n.az))}readGeometries(e,t,r){Array.isArray(e)?this.geometries=H.fromJSON(e,r):this._geometriesSource={url:(0,n.p)(e,r),context:r}}async loadGeometries(e,t){if(null==this._geometriesSource)return;const{url:r,context:i}=this._geometriesSource,s=await(0,n.U)(r,{responseType:"json",signal:t?.signal}),o=e.toJSON(),a=s.data.map((e=>({...e,spatialReference:o})));this.geometries=H.fromJSON(a,i),this._geometriesSource=null}clone(){const e=new Q({geometries:(0,n.f)(this.geometries),spatialRelationship:this.spatialRelationship});return e._geometriesSource=this._geometriesSource,e}};(0,n.k)([(0,n.o)({type:["disjoint","contains"],nonNullable:!0,json:{write:!0}})],W.prototype,"spatialRelationship",void 0),(0,n.k)([(0,n.o)({type:H,nonNullable:!0,json:{write:!0}}),(0,O.j)({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],W.prototype,"geometries",void 0),(0,n.k)([(0,n.u)(["web-scene","portal-item"],"geometries")],W.prototype,"readGeometries",null),W=Q=(0,n.k)([(0,n.A)("esri.layers.support.SceneFilter")],W);const J=W;async function K({fieldName:e,statisticsInfo:t,errorContext:r,fieldsIndex:i,path:s,customParameters:o,apiKey:a,signal:l}){if(null==t)throw new n.s(`${r}:no-cached-statistics`,"Cached statistics are not available for this layer");const u=i.get(e);if(null==u)throw new n.s(`${r}:field-unexisting`,`Field '${e}' does not exist on the layer`);const d=t.find((e=>e.name===u.name));if(null==d)throw new n.s(`${r}:no-cached-statistics`,"Cached statistics for this attribute are not available");const c=(0,n.Z)(s,d.href),{data:p}=await(0,n.U)(c,{query:{f:"json",...o,token:a},responseType:"json",signal:l});return p}async function X(e){const t=[];for(const r of e)r.name.toLowerCase().endsWith(".zip")?t.push(Y(r)):t.push(Promise.resolve(r));return(await Promise.all(t)).flat()}async function Y(e){const{BlobReader:t,ZipReader:n,BlobWriter:i}=await r.e(776).then(r.bind(r,30776)),s=[];return(await new n(new t(e)).getEntries()).forEach((e=>{if(e.directory||/^__MACOS/i.test(e.filename))return;const t=new i,r=e.getData?.(t).then((t=>new File([t],e.filename)));r&&s.push(r)})),Promise.all(s)}const ee=new Set(["3DObject","Point"]),te=(0,k.s)();let re=class extends(q((0,p.F)((0,m.R)((0,d.l)((0,f.b)((0,h.j)((0,y.t)((0,s.S)((0,c.e)((0,u.i)((0,n.a_)(a.f)))))))))))){constructor(...e){super(...e),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType="ArcGISSceneServiceLayer",this.type="scene",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.excludeObjectIds=new n.V,this.definitionExpression=null,this.filter=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.priority=null,this.semantic=null,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0,this.serviceItemId=void 0}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._set("renderer",null),this.associatedLayer=(0,n.C)(this.associatedLayer)}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){const r=this.getFeatureType(t?.feature)?.domains?.[e];return r&&"inherited"!==r.type?r:this.getField(e)?.domain??null}getFeatureType(e){return e&&this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return this.associatedLayer?.types??[]}get typeIdField(){return this.associatedLayer?.typeIdField??null}get templates(){return this.associatedLayer?.templates??null}get formTemplate(){return this.associatedLayer?.formTemplate??null}get attributeTableTemplate(){return this.associatedLayer?.attributeTableTemplate??null}get fieldsIndex(){return new L.Z(this.fields)}readNodePages(e,t,r){return"Point"===t.layerType&&(e=t.pointNodePages),null==e||"object"!=typeof e?null:T.p.fromJSON(e,r)}set elevationInfo(e){this._set("elevationInfo",e),this.loaded&&this._validateElevationInfo()}get effectiveCapabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.effectiveCapabilities)}get effectiveEditingEnabled(){return null!=this.associatedLayer&&(0,x.Z)(this.associatedLayer)}get geometryType(){return ie[this.profile]||"mesh"}set renderer(e){(0,n.f0)(e,this.fieldsIndex),this._set("renderer",e)}readCachedDrawingInfo(e){return null!=e&&"object"==typeof e||(e={}),null==e.color&&(e.color=!1),e}get capabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.capabilities)}_capabilitiesFromAssociatedFeatureLayer(e){e=e??S.t;const{query:t,queryRelated:r,editing:{supportsGlobalId:n,supportsRollbackOnFailure:i,supportsUploadWithItemId:s,supportsGeometryUpdate:o,supportsReturnServiceEditsInSourceSpatialReference:a},data:{supportsZ:l,supportsM:u,isVersioned:d,supportsAttachment:c},operations:{supportsEditing:p,supportsAdd:f,supportsUpdate:h,supportsDelete:y,supportsQuery:m,supportsQueryAttachments:g,supportsAsyncConvert3D:v}}=e,w=e.operations.supportsChangeTracking,b=!!this.associatedLayer?.infoFor3D;return{query:t,queryRelated:r,editing:{supportsGlobalId:n,supportsReturnServiceEditsInSourceSpatialReference:a,supportsRollbackOnFailure:i,supportsGeometryUpdate:b&&o,supportsUploadWithItemId:s},data:{supportsAttachment:c,supportsZ:l,supportsM:u,isVersioned:d},operations:{supportsQuery:m,supportsQueryAttachments:g,supportsEditing:p&&w,supportsAdd:b&&f&&w,supportsDelete:b&&y&&w,supportsUpdate:h&&w,supportsAsyncConvert3D:v}}}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.associatedLayer?.editingEnabled??!1}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get infoFor3D(){return this.associatedLayer?.infoFor3D??null}get relationships(){return this.associatedLayer?.relationships}get defaultPopupTemplate(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeOID"===t.type&&(e=t.name),!!e))),e||void 0}readGlobalIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeGlobalID"===t.type&&(e=t.name),!!e))),e||void 0}get displayField(){return this.associatedLayer?.displayField??null}readProfile(e,t){const r=t.store.profile;return null!=r&&ne[r]?ne[r]:(n.n.getLogger(this).error("Unknown or missing profile",{profile:r,layer:this}),"mesh-pyramids")}get useViewTime(){return this.associatedLayer?.useViewTime??!0}set useViewTime(e){this._override("useViewTime",e)}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}async _load(e){const t=null!=e?e.signal:null;await this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(n.G),await this._fetchService(t),await Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,t),this._setAssociatedFeatureLayer(t),this._loadFilterGeometries()]),this._validateElevationInfo(),this._applyAssociatedLayerOverrides(),this._populateFieldUsageInfo(),await this.loadTimeInfoFromService(e),await(0,M.t)(this,{origin:"service"},t),(0,n.f0)(this.renderer,this.fieldsIndex),await this.finishLoadEditablePortalLayer(e)}async beforeSave(){null!=this.filter&&(this.filter=this.filter.clone(),await this.load())}async _loadFilterGeometries(){if(this.filter)try{await this.filter.loadGeometries(this.spatialReference)}catch(e){n.n.getLogger(this).error("#_loadFilterGeometries()",this,"Failed to load filter geometries. Geometry filter will not be applied for this layer.",{error:e}),this.filter=null}}createQuery(){const e=new D.b;return"mesh"===this.geometryType?this.associatedLayer?.infoFor3D&&(e.returnGeometry=!0):(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e.outFields=["*"],e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryExtent(e||this.createQuery(),t)))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatureCount(e||this.createQuery(),t)))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatures(e||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=this,t.sourceLayer=this;return e}))}async queryRelatedFeatures(e,t){if(await this.load(),!this.associatedLayer)throw new n.s("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeatures(e,t)}async queryRelatedFeaturesCount(e,t){if(await this.load(),!this.associatedLayer)throw new n.s("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeaturesCount(e,t)}async queryCachedAttributes(e,t){const r=(0,n.hL)(this.fieldsIndex,await(0,C.n)(this,(0,C.p)(this)));return(0,N.V)(this.parsedUrl?.path??"",this.attributeStorageInfo??[],e,t,r,this.apiKey,this.customParameters)}async queryCachedFeature(e,t){const r=await this.queryCachedAttributes(e,[t]);if(!r||0===r.length)throw new n.s("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const i=new n.b1;return i.attributes=r[0],i.layer=this,i.sourceLayer=this,i}queryObjectIds(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryObjectIds(e||this.createQuery(),t)))}queryAttachments(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryAttachments(e,t)))}getFieldUsageInfo(e){const t={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||t:(n.n.getLogger(this).error("#getFieldUsageInfo()","Unavailable until layer is loaded"),t)}createPopupTemplate(e){return(0,U.p)(this,e)}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return e?.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),!this.associatedLayer)throw new n.s("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new n.s("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:this,error:e})}return this.associatedLayer}hasCachedStatistics(e){return null!=this.statisticsInfo&&this.statisticsInfo.some((t=>t.name===e))}async queryCachedStatistics(e,t){return await this.load(t),await this.fetchStatistics(e,t)}async saveAs(e,t){return this._debouncedSaveOperations(m.V.SAVE_AS,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"};return this._debouncedSaveOperations(m.V.SAVE,e)}async applyEdits(e,t){const{applyEdits:i}=await r.e(2895).then(r.bind(r,25276));let s=t;await this.load();const o=this.associatedLayer;if(!o)throw new n.s(`${this.type}-layer:not-editable`,"Service is not editable");await o.load();const{globalIdField:a}=o,l=!!o.infoFor3D,u=s?.globalIdUsed??!0;if(l&&null==a)throw new n.s(`${this.type}-layer:not-editable`,"Valid globalIdField expected on editable SceneLayer");if(l&&!u)throw new n.s(`${this.type}-layer:globalid-required`,"globalIdUsed must not be false for SceneLayer editing as globalIds are required.");return(0,b.g)(o.url)&&l&&null!=e.deleteFeatures&&null!=a&&(s={...s,globalIdToObjectId:await(0,x.K)(o,e.deleteFeatures,a)}),i(this,o.source,e,s)}async uploadAssets(e,t){if(await this.load(),null==this.associatedLayer)throw new n.s(`${this.type}-layer:not-editable`,"Service is not editable");return await this.associatedLayer.load(),this.associatedLayer.uploadAssets(e,t)}on(e,t){return super.on(e,t)}async convertMesh(e,t){t??={};const r=e=>{throw n.n.getLogger(this).error(".convertMesh()",e.message),e};await this.load(),this.infoFor3D||r(new n.s("invalid:layer","SceneLayer has no capability for mesh conversion"));const i=await this.extractAndFilterFiles(e),s=i.reduce(((e,t)=>(0,A.r)(this.infoFor3D,t)?e+1:e),0);0===s&&r(new l.i),s>1&&r(new l.m);const a=this.spatialReference,u=t.location??new n.bv({x:0,y:0,z:0,spatialReference:a}),d=u.spatialReference.isGeographic?"local":"georeferenced",c=o.$.createWithExternalSource(u,i,{vertexSpace:d,transform:(0,l.t)(u.spatialReference),unitConversionDisabled:!0}),[p]=await this.uploadAssets([c],{...t,useAssetOrigin:!t.location});return p}async extractAndFilterFiles(e){await this.load();const t=this.infoFor3D;return t?(await X(e)).filter((e=>(0,A.n)(t,e))):e}validateLayer(e){if(e.layerType&&!ee.has(e.layerType))throw new n.s("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new n.s("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(this.version.major>2)throw new n.s("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});function t(e,t){let r=!1,i=!1;if(null==e)r=!0,i=!0;else{const n=t&&t.isGeographic;switch(e){case"east-north-up":case"earth-centered":r=!0,i=n;break;case"vertex-reference-frame":r=!0,i=!n;break;default:r=!1}}if(!r)throw new n.s("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!i)throw new n.s("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}t(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const e=[];if("points"===this.profile)e.push("Point");else{if("mesh-pyramids"!==this.profile)throw new n.s("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);e.push("3DObject")}return e}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const e of this.fields){const t=!!this.attributeStorageInfo?.some((t=>t.name===e.name)),r=!!this.associatedLayer?.fields?.some((t=>t&&e.name===t.name)),n={supportsLabelingInfo:t,supportsRenderer:t,supportsPopupTemplate:t||r,supportsLayerQuery:r};this._fieldUsageInfo[e.name]=n}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides(),this._applyAssociatedLayerExtentOverride(),this._applyAssociatedLayerPrivileges()}_applyAssociatedLayerFieldsOverrides(){if(!this.associatedLayer?.fields)return;let e=null;for(const t of this.associatedLayer.fields){const r=this.getField(t.name);r?(!r.domain&&t.domain&&(r.domain=t.domain.clone()),r.editable=t.editable,r.nullable=t.nullable,r.length=t.length):(e||(e=this.fields?this.fields.slice():[]),e.push(t.clone()))}e&&this._set("fields",e)}_applyAssociatedLayerPopupOverrides(){if(!this.associatedLayer)return;const e=["popupTemplate","popupEnabled"],t=(0,n.bf)(this);for(let r=0;r<e.length;r++){const i=e[r],s=this.originIdOf(i),o=this.associatedLayer.originIdOf(i);s<o&&(o===n.bm.SERVICE||o===n.bm.PORTAL_ITEM)&&t.setAtOrigin(i,this.associatedLayer[i],o)}}_applyAssociatedLayerExtentOverride(){const e=this.associatedLayer?.getAtOrigin("fullExtent","service");null==this.associatedLayer?.infoFor3D||!e||!(0,b.g)(this.associatedLayer?.url)||!$(this)||(0,n.bf)(this).setAtOrigin("fullExtent",e.clone(),n.bm.SERVICE)}_applyAssociatedLayerPrivileges(){const e=this.associatedLayer;e&&(this._set("userHasEditingPrivileges",e.userHasEditingPrivileges),this._set("userHasFullEditingPrivileges",e.userHasFullEditingPrivileges),this._set("userHasUpdateItemPrivileges",e.userHasUpdateItemPrivileges))}async _setAssociatedFeatureLayer(e){if(["mesh-pyramids","points"].includes(this.profile))try{const{serverUrl:t,layerId:r,portalItem:n}=await(0,I.s)(`${this.url}/layers/${this.layerId}`,{sceneLayerItem:this.portalItem,customParameters:this.customParameters,apiKey:this.apiKey,signal:e}),i=await R.b.FeatureLayer();this.associatedLayer=new i({url:t,customParameters:this.customParameters,layerId:r,portalItem:n}),await this.associatedLayer.load()}catch(t){(0,n.E)(t)||this._logWarningOnPopupEnabled()}}async _logWarningOnPopupEnabled(){await(0,n.f2)((()=>this.popupEnabled&&null!=this.popupTemplate));const e=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?n.n.getLogger(this).warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${e}`):n.n.getLogger(this).info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${e}`)}_validateElevationInfo(){const e=this.elevationInfo;"mesh-pyramids"===this.profile&&(0,P.$)(n.n.getLogger(this),(0,P.P)("Mesh scene layers","relative-to-scene",e)),(0,P.$)(n.n.getLogger(this),(0,P.w)("Scene layers",e))}async fetchStatistics(e,t){return await K({fieldName:e,statisticsInfo:this.statisticsInfo,errorContext:"scenelayer",fieldsIndex:this.fieldsIndex,path:this.parsedUrl?.path??"",customParameters:this.customParameters,apiKey:this.apiKey,signal:t?.signal})}};(0,n.k)([(0,n.o)({types:{key:"type",base:_.t,typeMap:{selection:_.p}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],re.prototype,"featureReduction",void 0),(0,n.k)([(0,n.o)({type:[Z],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],re.prototype,"rangeInfos",void 0),(0,n.k)([(0,n.o)({json:{read:!1}})],re.prototype,"associatedLayer",void 0),(0,n.k)([(0,n.o)({type:["show","hide"]})],re.prototype,"listMode",void 0),(0,n.k)([(0,n.o)({type:["ArcGISSceneServiceLayer"]})],re.prototype,"operationalLayerType",void 0),(0,n.k)([(0,n.o)({json:{read:!1},readOnly:!0})],re.prototype,"type",void 0),(0,n.k)([(0,n.o)({...te.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],re.prototype,"fields",void 0),(0,n.k)([(0,n.o)()],re.prototype,"types",null),(0,n.k)([(0,n.o)()],re.prototype,"typeIdField",null),(0,n.k)([(0,n.o)()],re.prototype,"templates",null),(0,n.k)([(0,n.o)()],re.prototype,"formTemplate",null),(0,n.k)([(0,n.o)()],re.prototype,"attributeTableTemplate",null),(0,n.k)([(0,n.o)({readOnly:!0,clonable:!1})],re.prototype,"fieldsIndex",null),(0,n.k)([(0,n.o)({type:j.p,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],re.prototype,"floorInfo",void 0),(0,n.k)([(0,n.o)(te.outFields)],re.prototype,"outFields",void 0),(0,n.k)([(0,n.o)({type:T.p,readOnly:!0,json:{read:!1}})],re.prototype,"nodePages",void 0),(0,n.k)([(0,n.u)("service","nodePages",["nodePages","pointNodePages"])],re.prototype,"readNodePages",null),(0,n.k)([(0,n.o)({type:[T.a],readOnly:!0})],re.prototype,"materialDefinitions",void 0),(0,n.k)([(0,n.o)({type:[T.y],readOnly:!0})],re.prototype,"textureSetDefinitions",void 0),(0,n.k)([(0,n.o)({type:[T.m],readOnly:!0})],re.prototype,"geometryDefinitions",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],re.prototype,"serviceUpdateTimeStamp",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],re.prototype,"attributeStorageInfo",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],re.prototype,"statisticsInfo",void 0),(0,n.k)([(0,n.o)({type:n.V.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],re.prototype,"excludeObjectIds",void 0),(0,n.k)([(0,n.o)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],re.prototype,"definitionExpression",void 0),(0,n.k)([(0,n.o)({type:J,json:{name:"layerDefinition.polygonFilter",write:{enabled:!0,allowNull:!0},origins:{service:{read:!1,write:!1}}}})],re.prototype,"filter",void 0),(0,n.k)([(0,n.o)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],re.prototype,"path",void 0),(0,n.k)([(0,n.o)(F.c)],re.prototype,"elevationInfo",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],re.prototype,"effectiveCapabilities",null),(0,n.k)([(0,n.o)({readOnly:!0})],re.prototype,"effectiveEditingEnabled",null),(0,n.k)([(0,n.o)({type:String})],re.prototype,"geometryType",null),(0,n.k)([(0,n.o)(F.p)],re.prototype,"labelsVisible",void 0),(0,n.k)([(0,n.o)({type:[E.C],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:E.n},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:E.n},write:!0}})],re.prototype,"labelingInfo",void 0),(0,n.k)([(0,n.o)(F.d)],re.prototype,"legendEnabled",void 0),(0,n.k)([(0,n.o)({type:Number,json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(e,t){if("number"==typeof e&&e>=0&&e<=1)return e;const r=t.layerDefinition?.drawingInfo?.transparency;return void 0!==r?(0,n.hs)(r):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],re.prototype,"opacity",void 0),(0,n.k)([(0,n.o)({type:["Low","High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],re.prototype,"priority",void 0),(0,n.k)([(0,n.o)({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],re.prototype,"semantic",void 0),(0,n.k)([(0,n.o)({types:i.u,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],re.prototype,"renderer",null),(0,n.k)([(0,n.o)({json:{read:!1}})],re.prototype,"cachedDrawingInfo",void 0),(0,n.k)([(0,n.u)("service","cachedDrawingInfo")],re.prototype,"readCachedDrawingInfo",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],re.prototype,"capabilities",null),(0,n.k)([(0,n.o)({type:Boolean,json:{read:!1}})],re.prototype,"editingEnabled",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{write:!1,read:!1}})],re.prototype,"infoFor3D",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{write:!1,read:!1}})],re.prototype,"relationships",null),(0,n.k)([(0,n.o)(F.l)],re.prototype,"popupEnabled",void 0),(0,n.k)([(0,n.o)({type:n.b4,json:{name:"popupInfo",write:!0}})],re.prototype,"popupTemplate",void 0),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],re.prototype,"defaultPopupTemplate",null),(0,n.k)([(0,n.o)({type:String,json:{read:!1}})],re.prototype,"objectIdField",void 0),(0,n.k)([(0,n.u)("service","objectIdField",["objectIdField","fields"])],re.prototype,"readObjectIdField",null),(0,n.k)([(0,n.o)({type:String,json:{read:!1}})],re.prototype,"globalIdField",void 0),(0,n.k)([(0,n.u)("service","globalIdField",["globalIdField","fields"])],re.prototype,"readGlobalIdField",null),(0,n.k)([(0,n.o)({readOnly:!0,type:String,json:{read:!1}})],re.prototype,"displayField",null),(0,n.k)([(0,n.o)({type:String,json:{read:!1}})],re.prototype,"profile",void 0),(0,n.k)([(0,n.u)("service","profile",["store.profile"])],re.prototype,"readProfile",null),(0,n.k)([(0,n.o)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],re.prototype,"normalReferenceFrame",void 0),(0,n.k)([(0,n.o)(F.s)],re.prototype,"screenSizePerspectiveEnabled",void 0),(0,n.k)([(0,n.o)({json:{read:!1,origins:{service:{read:!0}}}})],re.prototype,"serviceItemId",void 0),(0,n.k)([(0,n.o)(g.f)],re.prototype,"useViewTime",null),re=(0,n.k)([(0,n.A)("esri.layers.SceneLayer")],re);const ne={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},ie={"mesh-pyramids":"mesh",points:"point"},se=re},47603:function(e,t,r){r.d(t,{f:function(){return a},l:function(){return l}});var n=r(98503),i=r(20014),s=r(75863),o=r(50257);const a={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:i.a}}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const r=t.timeInfo.exportOptions;if(!r)return null;const n=r.timeOffset,i=s.e.fromJSON(r.timeOffsetUnits);return n&&i?new s.l({value:n,unit:i}):null}set timeInfo(e){(0,n.aZ)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,n.k)([(0,n.o)({type:o.p,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,n.k)([(0,n.o)({type:s.l})],t.prototype,"timeOffset",void 0),(0,n.k)([(0,n.u)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,n.k)([(0,n.o)({value:null,type:s.d,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,n.k)([(0,n.o)(a)],t.prototype,"useViewTime",void 0),t=(0,n.k)([(0,n.A)("esri.layers.mixins.TemporalLayer")],t),t}},75863:function(e,t,r){r.d(t,{d:function(){return d},e:function(){return s},l:function(){return a}});var n=r(98503),i=r(50257);const s=(0,n.g)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let o=class extends((0,n.a_)(n.v)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,i.m)(this.value,this.unit,"milliseconds")}};(0,n.k)([(0,n.bk)(s,{nonNullable:!0})],o.prototype,"unit",void 0),(0,n.k)([(0,n.o)({type:Number,json:{write:!0},nonNullable:!0})],o.prototype,"value",void 0),o=(0,n.k)([(0,n.A)("esri.time.TimeInterval")],o);const a=o;function l(e,t){return a.fromJSON({value:e,unit:t})}let u=class extends((0,n.a_)(n.v)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,t){return t.timeExtent&&Array.isArray(t.timeExtent)&&2===t.timeExtent.length?i.p.fromArray(t.timeExtent):null}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=e.toArray():t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?l(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?l(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,n.k)([(0,n.o)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],u.prototype,"cumulative",void 0),(0,n.k)([(0,n.o)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],u.prototype,"endField",void 0),(0,n.k)([(0,n.o)({type:i.p,json:{write:{enabled:!0,allowNull:!0}}})],u.prototype,"fullTimeExtent",void 0),(0,n.k)([(0,n.u)("fullTimeExtent",["timeExtent"])],u.prototype,"readFullTimeExtent",null),(0,n.k)([(0,n.q)("fullTimeExtent")],u.prototype,"writeFullTimeExtent",null),(0,n.k)([(0,n.o)({type:Boolean,json:{write:!0}})],u.prototype,"hasLiveData",void 0),(0,n.k)([(0,n.o)({type:a,json:{write:{enabled:!0,allowNull:!0}}})],u.prototype,"interval",void 0),(0,n.k)([(0,n.u)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],u.prototype,"readInterval",null),(0,n.k)([(0,n.q)("interval")],u.prototype,"writeInterval",null),(0,n.k)([(0,n.o)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],u.prototype,"startField",void 0),(0,n.k)([(0,n.o)((0,n.bo)("timeReference",!0))],u.prototype,"timeZone",void 0),(0,n.k)([(0,n.o)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],u.prototype,"trackIdField",void 0),(0,n.k)([(0,n.o)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],u.prototype,"useTime",void 0),(0,n.k)([(0,n.o)({type:[Date],json:{read:!1}})],u.prototype,"stops",void 0),u=(0,n.k)([(0,n.A)("esri.layers.support.TimeInfo")],u);const d=u},6435:function(e,t,r){r.d(t,{i:function(){return o},r:function(){return s},t:function(){return i}});var n=r(98503);class i{}function s(e){return e instanceof n.a7?e===i.instance:"unknown"===e?.toString().toLowerCase()}function o(e){return s(e)?i.instance:e}i.instance=new n.a6("Etc/UTC")},22676:function(e,t,r){r.d(t,{r:function(){return i}});var n=r(98503);let i=class e{constructor(e,t,r=""){this.major=e,this.minor=t,this._context=r}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}greaterEqual(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new n.s(t+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new e(this.major,this.minor,this._context)}static parse(t,r=""){const[i,s]=t.split("."),o=/^\s*\d+\s*$/;if(!i?.match||!o.test(i))throw new n.s((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!s?.match||!o.test(s))throw new n.s((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const a=parseInt(i,10),l=parseInt(s,10);return new e(a,l,r)}}},22692:function(e,t,r){r.d(t,{s:function(){return o}});var n=r(98503),i=r(5948),s=r(2031);async function o(e,t){const r=(0,i.d)(e);if(!r)throw new n.s("invalid-url","Invalid scene service url");const s={...t,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(s.sceneLayerItem??=await a(s),null==s.sceneLayerItem)return d(s.sceneServerUrl.replace("/SceneServer","/FeatureServer"),s);const o=await c(s);if(!o?.url)throw new n.s("related-service-not-found","Could not find feature service through portal item relationship");s.featureServiceItem=o;const l=await d(o.url,s);return l.portalItem=o,l}async function a(e){const t=(await l(e)).serviceItemId;if(!t)return null;const r=new s["default"]({id:t,apiKey:e.apiKey}),i=await u(e);null!=i&&(r.portal=new n.b({url:i}));try{return await r.load({signal:e.signal})}catch(o){return(0,n.G)(o),null}}async function l(e){if(e.rootDocument)return e.rootDocument;const t={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{const r=await(0,n.U)(e.sceneServerUrl,t);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function u(e){const t=n.K?.findServerInfo(e.sceneServerUrl);if(t?.owningSystemUrl)return t.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const t=(await(0,n.U)(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(t)return t}catch(i){(0,n.G)(i)}return null}async function d(e,t){const r=(0,i.d)(e);if(!r)throw new n.s("invalid-feature-service-url","Invalid feature service url");const s=r.url.path,o=t.layerId;if(null==o)return{serverUrl:s};const a=l(t),u=t.featureServiceItem?await t.featureServiceItem.fetchData("json"):null,d=(u?.layers?.[0]||u?.tables?.[0])?.customParameters,c=e=>{const r={query:{f:"json",...d},responseType:"json",authMode:e,signal:t.signal};return(0,n.U)(s,r)},p=c("anonymous").catch((()=>c("no-prompt"))),[f,h]=await Promise.all([p,a]),y=h?.layers,m=f.data&&f.data.layers;if(!Array.isArray(m))throw new Error("expected layers array");if(Array.isArray(y)){for(let n=0;n<Math.min(y.length,m.length);n++)if(y[n].id===o)return{serverUrl:s,layerId:m[n].id}}else if(null!=o&&o<m.length)return{serverUrl:s,layerId:m[o].id};throw new Error("could not find matching associated sublayer")}async function c({sceneLayerItem:e,signal:t}){if(!e)return null;try{const r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:t})).find((e=>"Feature Service"===e.type))||null;if(!r)return null;const n=new s["default"]({portal:r.portal,id:r.id});return await n.load(),n}catch(r){return(0,n.G)(r),null}}},96197:function(e,t,r){r.d(t,{s:function(){return n},t:function(){return i}});const n={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportedStatistics:void 0},i={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:n,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},65944:function(e,t,r){r.d(t,{d:function(){return h},p:function(){return p},s:function(){return c},y:function(){return f}});var n=r(98503);const i=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function s(e){return e instanceof n.aD}function o(e){return e instanceof n.V?Object.keys(e.items):s(e)?(0,n.bf)(e).keys():e?Object.keys(e):[]}function a(e,t){return e instanceof n.V?e.items[t]:e[t]}function l(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function u(e){return e?e.declaredClass:null}function d(e,t){const r=e.diff;if(r&&"function"==typeof r)return r(e,t);const n=o(e),c=o(t);if(0===n.length&&0===c.length)return;if(!n.length||!c.length||l(e,t))return{type:"complete",oldValue:e,newValue:t};const p=c.filter((e=>!n.includes(e))),f=n.filter((e=>!c.includes(e))),h=n.filter((r=>c.includes(r)&&a(e,r)!==a(t,r))).concat(p,f).sort(),y=u(e);if(y&&i.has(y)&&h.length)return{type:"complete",oldValue:e,newValue:t};let m;const g=s(e)&&s(t);for(const i of h){const n=a(e,i),s=a(t,i);let o;if((g||"function"!=typeof n&&"function"!=typeof s)&&n!==s&&(null!=n||null!=s)){if(r&&r[i]&&"function"==typeof r[i])o=r[i]?.(n,s);else if(n instanceof Date&&s instanceof Date){if(n.getTime()===s.getTime())continue;o={type:"complete",oldValue:n,newValue:s}}else o="object"==typeof n&&"object"==typeof s&&u(n)===u(s)?d(n,s):{type:"complete",oldValue:n,newValue:s};null!=o&&(null!=m?m.diff[i]=o:m={type:"partial",diff:{[i]:o}})}}return m}function c(e,t){return p(e,t)}function p(e,t){if(null==e)return!1;const r=t.split(".");let n=e;for(const i of r){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[i];if(!e)return!1;n=e}}return!0}function f(e,t){if(!e)return!1;if("partial"===e.type){const r=Object.keys(e.diff);return 1===r.length&&r[0]===t}return!1}function h(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&u(e)!==u(t)?{type:"complete",oldValue:e,newValue:t}:d(e,t)}},42630:function(e,t,r){r.d(t,{$:function(){return S},E:function(){return m},P:function(){return b},Z:function(){return w},a:function(){return d},b:function(){return g},i:function(){return l},j:function(){return x},l:function(){return u},m:function(){return h},p:function(){return f},u:function(){return a},w:function(){return I},x:function(){return y}});var n=r(98503),i=r(39394);function s(e){return e?x:_}function o(e,t){return t?.mode?t.mode:s(e).mode}function a(e,t){return t??s(e)}function l(e,t){return o(null==e||(e.hasZ??!1),t)}function u(e){const t=c(e);return l(e.geometry,t)}function d(e){const t=c(e),r=l(e.geometry,t),n=null!=t&&"on-the-ground"!==r?F(t):0,i=t?.featureExpressionInfo;return{mode:r,offset:n,featureExpressionInfo:i}}function c(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function p(e,t){if(!e?.offset)return 0;const{offset:r,unit:i}=e;if("decimal-degrees"===i)return 0;const s="unknown"!==i&&i?i:"meters",o=(0,n.d6)(t);return o?(0,n.a1)(r,s,o):0}function f(e,t,r){if(!r?.mode)return;const n=e.hasZ?e.z:0,i=p(r,e.spatialReference);switch(r.mode){case"absolute-height":return n-i;case"on-the-ground":return 0;case"relative-to-ground":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"ground")??0)+i);case"relative-to-scene":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"scene")??0)+i)}}function h(e,t,r,n=null){return m(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,r,n)}function y(e,t,r,n,i=null){return m(e,t[0],t[1],t.length>2?t[2]:0,r,n,i)}function m(e,t,r,n,i,s,o=null){if(null==s)return;const a=null!=o?o.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=g(t,r,n,i,e,s);return v(l,t,r,n,i,e,o,a)}function g(e,t,r,n,i,s){const o=p(s,n);switch(s.mode){case"absolute-height":return{absoluteZ:r+o,elevation:0};case"on-the-ground":{const r=i.elevationProvider.getElevation(e,t,0,n,"ground")??0;return{absoluteZ:r,elevation:r}}case"relative-to-ground":{const s=i.elevationProvider.getElevation(e,t,r,n,"ground")??0;return{absoluteZ:r+s+o,elevation:s}}case"relative-to-scene":{const s=i.elevationProvider.getElevation(e,t,r,n,"scene")??0;return{absoluteZ:r+s+o,elevation:s}}}}function v(e,t,r,n,i,s,o,a){const l=p(o,i);switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-((s.elevationProvider.getElevation(t,r,n,i,"ground")??0)+l);case"relative-to-scene":return e-((s.elevationProvider.getElevation(t,r,n,i,"scene")??0)+l)}}function w(e,t,r){return r&&r.mode!==t?`${e} only support ${t} elevation mode`:null}function b(e,t,r){return r?.mode===t?`${e} do not support ${t} elevation mode`:null}function I(e,t){return null!=t?.featureExpressionInfo&&"0"!==t.featureExpressionInfo.expression?`${e} do not support featureExpressionInfo`:null}function S(e,t){t&&e.warn(".elevationInfo=",t)}function F(e){return(e?.offset??0)*(0,i.n)(e?.unit)}const x={mode:"absolute-height",offset:0},_={mode:"on-the-ground",offset:null}},86477:function(e,t,r){r.d(t,{s:function(){return o}});var n=r(98503),i=r(98089),s=r(36879);function o(){return{fields:{type:[i.y],value:null,set:function(e){if(e&&(0,n.a$)("big-integer-warning-enabled")){const t=e.filter((e=>"big-integer"===e.type||"oid"===e.type&&(e.length||0)>=8));if(t.length){const e=t.map((e=>`'${e.name}'`)).join(", ");n.n.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${e}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return s.Z.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e?.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e)this.fieldsIndex?.has(t)||n.n.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e});return(0,n.b0)(this.fieldsIndex,e)}}}}},35513:function(e,t,r){r.d(t,{a:function(){return l},c:function(){return o},e:function(){return a},f:function(){return d},l:function(){return c},u:function(){return p}});var n=r(98503),i=r(90211),s=r(83448);const o=2.4;function a(e){return(0,n.bd)(e*o)}function l(e){return(0,n.be)(e)/o}function u(e,t,r,s){let{color:o,ratio:a}=t,{color:l,ratio:u}=r;u===a&&(1===u?a-=1e-6:u+=1e-6);const d=(0,n.aP)((s-a)/(u-a),0,1);(0,i._)(e,o.toArray(),l.toArray(),d)}function d(e){const t=new Uint8ClampedArray(2048);if(e=e.filter((({ratio:e})=>e>=0&&e<=1)).sort(((e,t)=>e.ratio-t.ratio)).map((({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)}))),e.length<1)return t;let r=e[0],n=e[0],i=1;const o=(0,s.n)();for(let s=0;s<512;s++){const a=(s+.5)/512;for(;a>n.ratio&&i<e.length;)r=n,n=e[i++];u(o,r,n,a),t.set(o,4*s)}return t}function c(e,t,r){const n=Math.sqrt(e**2+t**2)/r;return n>1?0:3/(Math.PI*r**2)*(1-n**2)**2}function p(e){return"function"==typeof e?e:e?t=>+t[e]:()=>1}},48165:function(e,t,r){r.d(t,{M:function(){return F},a:function(){return c},c:function(){return u},d:function(){return f},f:function(){return p},l:function(){return h},m:function(){return y},n:function(){return i},p:function(){return d},r:function(){return s},s:function(){return l},u:function(){return o}});const n=[["binary","application/octet-stream","bin",""]];function i(e,t){return null!=w(t.name,e?.supportedFormats??[])}function s(e,t){if(!e)return!1;const r=u(t,e.supportedFormats??[]);return null!=r&&e.editFormats.includes(r)}function o(e,t){return b(v(e,t))}function a(e,t){return b(w(e,t))}function l(e,t){return I(g(e,t))}function u(e,t){return a(e.name,t)??o(e.type,t)}function d(e,t,r){return o(e,r)??a(t,r)}function c({supportedFormats:e}){return d("model/gltf-binary","glb",e)}function p(e){const t=c(e);return null!=t&&e.editFormats.includes(t)}function f({supportedFormats:e}){return d("model/gltf+json","gltf",e)}function h({supportedFormats:e}){return d("application/esri3do-SR_world","wld",e)}function y({supportedFormats:e}){return d("application/esri3do-SR_prj","prj",e)}function m(e){return[...n,...e]}function g(e,t){return m(t).find((t=>b(t)===e))}function v(e,t){const r=e.toLowerCase();return m(t).find((e=>I(e)===r))}function w(e,t){const r=e.toLowerCase();return m(t).find((e=>S(e).some((e=>r.endsWith(e)))))}function b(e){return e?.[0]}function I(e){return e?.[1].toLowerCase()}function S(e){return e?.[2].split(",").map((e=>e.toLowerCase()))??[]}function F(e){return e.tables?.find((e=>"assetMaps"===e.role))}},68116:function(e,t,r){r.d(t,{E:function(){return v},_:function(){return x},f:function(){return m},g:function(){return g},p:function(){return f},u:function(){return h},x:function(){return y}});var n=r(98503);const i="__begin__",s="__end__",o=new RegExp(i,"ig"),a=new RegExp(s,"ig"),l=new RegExp("^"+i,"i"),u=new RegExp(s+"$","i"),d='"',c=d+" + ",p=" + "+d;function f(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function h(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function y(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=f(e.labelExpression),t.type="conventional"),t}function m(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return v(t.expression);case"arcade":return t.expression}return null}function g(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return b(t.expression);case"arcade":return x(t.expression)}return null}function v(e){let t;return e?(t=(0,n.r)(e,(e=>i+'$feature["'+e+'"]'+s)),t=l.test(t)?t.replace(l,""):d+t,t=u.test(t)?t.replace(u,""):t+d,t=t.replaceAll(o,c).replaceAll(a,p)):t='""',t}const w=/^\s*\{([^}]+)\}\s*$/i;function b(e){return e?.match(w)?.[1].trim()||null}const I=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,S=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,F=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function x(e){if(!e)return null;let t=I.exec(e)||S.exec(e);return t?t[1]||t[3]:(t=F.exec(e),t?t[2]:null)}},65738:function(e,t,r){r.d(t,{a:function(){return p},b:function(){return l},c:function(){return h},d:function(){return f},i:function(){return m},l:function(){return y},m:function(){return g},n:function(){return u},p:function(){return c},r:function(){return a},t:function(){return v},u:function(){return d}});var n=r(98503),i=r(75457);const s="upload-assets",o=()=>new Error;class a extends n.s{constructor(){super(`${s}:unsupported`,"Layer does not support asset uploads.",o())}}let l=class extends n.s{constructor(){super(`${s}:no-glb-support`,"Layer does not support glb.",o())}};class u extends n.s{constructor(){super(`${s}:no-supported-source`,"No supported external source found",o())}}class d extends n.s{constructor(){super(`${s}:not-base-64`,"Expected gltf data in base64 format after conversion.",o())}}class c extends n.s{constructor(){super(`${s}:unable-to-prepare-options`,"Unable to prepare uploadAsset request options.",o())}}class p extends n.s{constructor(e,t){super(`${s}:bad-response`,`Bad response. Uploaded ${e} items and received ${t} results.`,o())}}class f extends n.s{constructor(e,t){super(`${s}-layer:upload-failed`,`Failed to upload mesh file ${e}. Error code: ${t?.code??"-1"}. Error message: ${t?.messages??"unknown"}`,o())}}class h extends n.s{constructor(e){super(`${s}-layer:unsupported-format`,`The service allowed us to upload an asset of FormatID ${e}, but it does not list it in its supported formats.`,o())}}class y extends n.s{constructor(){super(`${s}:convert3D-failed`,"convert3D failed.")}}class m extends n.s{constructor(){super("invalid-input:no-model","No supported model found")}}class g extends n.s{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}}function v(e){const t=1/(0,n.bq)(e,1);return 1!==t?new i.N({scale:[t,t,t]}):void 0}},13487:function(e,t,r){r.d(t,{n:function(){return i},p:function(){return s}});var n=r(98503);async function i(e,t=e.popupTemplate){if(null==t)return[];const r=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:i}=t,{objectIdField:s,typeIdField:o,globalIdField:a,relationships:l}=e;if(r.includes("*"))return["*"];const u=i?(0,n.cQ)(e):[],d=(0,n.b0)(e.fieldsIndex,[...r,...u]);return o&&d.push(o),d&&s&&e.fieldsIndex?.has(s)&&!d.includes(s)&&d.push(s),d&&a&&e.fieldsIndex?.has(a)&&!d.includes(a)&&d.push(a),l&&l.forEach((t=>{const{keyField:r}=t;d&&r&&e.fieldsIndex?.has(r)&&!d.includes(r)&&d.push(r)})),d}function s(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}},8891:function(e,t,r){r.d(t,{B:function(){return I},C:function(){return S},D:function(){return F},H:function(){return x},j:function(){return b},s:function(){return n},u:function(){return s}});r(98503);function n(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function i(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}function s(e){if(i(e))return e;const{originPosition:t,scale:r,translate:n}=e,s=r[0]??1,o=r[1]??1;return{originPosition:"lowerLeft",scale:[s,"lowerLeft"===t?o:-o,r[2]??1,r[3]??1],translate:[n[0]??0,n[1]??0,n[2]??0,n[3]??0]}}function o({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function a({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function l({scale:e,translate:t},r){return Math.round(((r??0)-t[2])/e[2])}function u({scale:e,translate:t},r){return r?Math.round((r-t[3])/e[3]):0}function d({scale:e,translate:t},r){return r*e[0]+t[0]}function c({scale:e,translate:t},r){return r*e[1]+t[1]}function p({scale:e,translate:t},r){return(r??0)*e[2]+t[2]}function f({scale:e,translate:t},r){return r?r*e[3]+t[3]:0}function h(e,t){return e&&t?v:e&&!t?m:!e&&t?g:y}const y=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=d(e,n[0]),s=c(e,n[1]);r[0]=[i,s];const{scale:o,originPosition:a}=e,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let d=1;d<t.length;d++){const[e,n]=t[d];i+=l*e,s+=u*n,r[d]=[i,s]}return r},m=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=d(e,n[0]),s=c(e,n[1]);r[0]=[i,s,p(e,n[2])];const{scale:o,originPosition:a}=e,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let d=1;d<t.length;d++){const[n,o,a]=t[d];i+=l*n,s+=u*o,r[d]=[i,s,p(e,a)]}return r},g=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=d(e,n[0]),s=c(e,n[1]);r[0]=[i,s,f(e,n[2])];const{scale:o,originPosition:a}=e,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let d=1;d<t.length;d++){const[n,o,a]=t[d];i+=l*n,s+=u*o,r[d]=[i,s,f(e,a)]}return r},v=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=d(e,n[0]),s=c(e,n[1]);r[0]=[i,s,p(e,n[2]),f(e,n[3])];const{scale:o,originPosition:a}=e,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let d=1;d<t.length;d++){const[n,o,a,c]=t[d];i+=l*n,s+=u*o,r[d]=[i,s,p(e,a),f(e,c)]}return r};function w(e,t,r){const n=new Array(r.length);for(let i=0;i<r.length;i++)n[i]=t(e,r[i]);return n}function b(e,t,r){const n=s(e);return t.x=o(n,r.x),t.y=a(n,r.y),null!=r.z&&(t.z=l(n,r.z)),null!=r.m&&(t.m=u(n,r.m)),t}function I(e,t,r,n=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const o=s(e);t.points=h(n,i)(o,r.points),t.hasZ=n,t.hasM=i}return t}function S(e,t,r,n=null!=r?.z,i=null!=r?.m){if(null==r)return t;const o=s(e);return t.x=d(o,r.x),t.y=c(o,r.y),n&&(t.z=p(o,r.z)),i&&(t.m=f(o,r.m)),t}function F(e,t,r,n=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const o=s(e);t.rings=w(o,h(n,i),r.rings),t.hasZ=n,t.hasM=i}return t}function x(e,t,r,n=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const o=s(e);t.paths=w(o,h(n,i),r.paths),t.hasZ=n,t.hasM=i}return t}},21355:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(98503);async function i(e,t,r){const i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(i&&"unique-value"===i.type&&i.styleOrigin){const s=await(0,n._)(i.populateFromStyle());if((0,n.D)(r),!1===s.ok){const r=s.error;t?.messages&&t.messages.push(new n.z("renderer:style-reference",`Failed to create unique value renderer from style reference: ${r.message}`,{error:r,context:t})),e.clear("renderer",t?.origin)}}}}}]);
//# sourceMappingURL=9254.8a91cbb1.js.map