"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[902,1303,5396,8252,9323],{48521:function(e,t,i){i.r(t),i.d(t,{default:function(){return r}});var n,o=i(98503);let s=n=class extends o.v{constructor(e){super(e),this.color=new o.aC([0,0,0,1])}clone(){return new n((0,o.f)({color:this.color}))}};(0,o.k)([(0,o.o)({type:o.aC,json:{write:!0}})],s.prototype,"color",void 0),s=n=(0,o.k)([(0,o.A)("esri.webmap.background.ColorBackground")],s);const r=s},45996:function(e,t,i){i.d(t,{a:function(){return a},n:function(){return o}});var n=i(98503);class o{constructor(e,t){this.min=e,this.max=t,this.range=t-e}normalize(e,t=0,i=!1){return s(this.range,this.min,this.max,e,t,i)}clamp(e,t=0){return(0,n.aP)(e-t,this.min,this.max)+t}monotonic(e,t,i){return e<t?t:t+r(this.range,e-t,i)}minimalMonotonic(e,t,i){return s(this.range,e,e+this.range,t,i)}center(e,t,i){return t=this.monotonic(e,t,i),this.normalize((e+t)/2,i)}diff(e,t,i){return this.monotonic(e,t,i)-e}shortestSignedDiff(e,t){e=this.normalize(e);const i=(t=this.normalize(t))-e,n=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(i)<Math.abs(n)?i:n}contains(e,t,i){return t=this.minimalMonotonic(e,t),(i=this.minimalMonotonic(e,i))>e&&i<t}}function s(e,t,i,n,o=0,s=!1){return(n-=o)<t?n+=r(e,t-n):n>i&&(n-=r(e,n-i)),s&&n===i&&(n=t),n+o}function r(e,t,i=0){return Math.ceil((t-i)/e)*e+i}const a=new o(0,360)},87654:function(e,t,i){i.d(t,{c:function(){return r},l:function(){return s},n:function(){return o}});var n=i(98503);let o=class extends n.V{constructor(e){super(e),this.addHandles([this.on("before-add",(e=>{null==e.item&&e.preventDefault()})),this.on("after-add",(e=>this._own(e.item))),this.on("after-remove",(e=>this._release(e.item)))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(n.V.ofType(this.itemType.Type))(e):new n.V(e)}};function s(e,t){return{type:e,cast:n.cX,set(i){const o=(0,n.cW)(i,this._get(t),e);o.owner=this,this._set(t,o)}}}(0,n.k)([(0,n.o)()],o.prototype,"owner",null),o=(0,n.k)([(0,n.A)("esri.core.support.OwningCollection")],o);let r=class extends o{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};(0,n.k)([(0,n.ee)({Type:n.b1,ensureType:(0,n.ef)(n.b1)})],r.prototype,"itemType",void 0),r=(0,n.k)([(0,n.A)("esri.support.GraphicsCollection")],r)},21303:function(e,t,i){i.d(t,{v:function(){return u}});var n,o=i(98503);const s=(0,o.g)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),r=s.jsonValues.slice();(0,o.h)(r,"orthometric");const a=(0,o.g)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let l=n=class extends o.v{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return s.write(e,t,i)}readHeightModel(e,t,i){return s.read(e)||(i?.messages&&i.messages.push(h(e,{context:i})),null)}readHeightUnit(e,t,i){return a.read(e)||(i?.messages&&i.messages.push(c(e,{context:i})),null)}readHeightUnitService(e,t,i){return(0,o.Y)(e)||a.read(e)||(i?.messages&&i.messages.push(c(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new n({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=(0,o.$)(t);return new n({heightModel:e.heightModel,heightUnit:i??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new n;return t.read(e,{origin:"web-scene"}),t}};function c(e,t){return new o.z("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}function h(e,t){return new o.z("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}(0,o.k)([(0,o.o)({type:s.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:r,default:"ellipsoidal"}}}})],l.prototype,"heightModel",void 0),(0,o.k)([(0,o.q)("web-scene","heightModel")],l.prototype,"writeHeightModel",null),(0,o.k)([(0,o.u)(["web-scene","service"],"heightModel")],l.prototype,"readHeightModel",null),(0,o.k)([(0,o.o)({type:a.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:a.jsonValues,write:a.write}}}})],l.prototype,"heightUnit",void 0),(0,o.k)([(0,o.u)("web-scene","heightUnit")],l.prototype,"readHeightUnit",null),(0,o.k)([(0,o.u)("service","heightUnit")],l.prototype,"readHeightUnitService",null),(0,o.k)([(0,o.o)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],l.prototype,"vertCRS",void 0),(0,o.k)([(0,o.u)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],l.prototype,"readVertCRS",null),l=n=(0,o.k)([(0,o.A)("esri.geometry.HeightModelInfo")],l);const u=l},28252:function(e,t,i){i.d(t,{f:function(){return l}});var n=i(98503),o=i(50257);async function s(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:o}=await Promise.all([i.e(2031),i.e(7489)]).then(i.bind(i,67489)).then((e=>e.p));try{return await o(t)}catch(s){const e=t?.portalItem,i=e?.id||"unset",o=e?.portal?.url||n.H.portalUrl;throw n.n.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+i+"')",s),s}}let r=0,a=class extends(n.bP.EventedMixin((0,n.da)(n.e))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new n.au(-180,-90,180,90,n.B.WGS84),this.id=Date.now().toString(16)+"-layer-"+r++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=n.B.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const t="string"==typeof e?{url:e}:e;return(await Promise.all([i.e(2031),i.e(8529)]).then(i.bind(i,58529))).fromUrl(t)}static fromPortalItem(e){return s(e)}initialize(){this.when().catch((e=>{(0,n.E)(e)||n.n.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})}))}destroy(){const e=this.parent;if(e){const t=this;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"referenceLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t),this._set("parent",null)}}get effectiveVisible(){let e=this.visible;const t=this.parent;return e&&t&&"effectiveVisible"in t&&(e&&=t.effectiveVisible),e}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){return(0,n.I)(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await(0,n.U)(e,{query:{f:"json"},responseType:"json"})).data;throw new n.s("layer:no-attribution-data","Layer does not have attribution data")}};(0,n.k)([(0,n.o)({type:String})],a.prototype,"attributionDataUrl",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],a.prototype,"effectiveVisible",null),(0,n.k)([(0,n.o)({type:n.au})],a.prototype,"fullExtent",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],a.prototype,"hasAttributionData",null),(0,n.k)([(0,n.o)({type:String,clonable:!1})],a.prototype,"id",void 0),(0,n.k)([(0,n.o)({type:Boolean,nonNullable:!0})],a.prototype,"legendEnabled",void 0),(0,n.k)([(0,n.o)({type:["show","hide","hide-children"]})],a.prototype,"listMode",void 0),(0,n.k)([(0,n.o)({type:Number,range:{min:0,max:1},nonNullable:!0})],a.prototype,"opacity",void 0),(0,n.k)([(0,n.o)({clonable:!1})],a.prototype,"parent",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],a.prototype,"parsedUrl",null),(0,n.k)([(0,n.o)({type:Boolean,readOnly:!0})],a.prototype,"persistenceEnabled",void 0),(0,n.k)([(0,n.o)({type:Boolean})],a.prototype,"popupEnabled",void 0),(0,n.k)([(0,n.o)({type:Boolean})],a.prototype,"attributionVisible",void 0),(0,n.k)([(0,n.o)({type:n.B})],a.prototype,"spatialReference",void 0),(0,n.k)([(0,n.o)({type:String})],a.prototype,"title",void 0),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0),(0,n.k)([(0,n.o)()],a.prototype,"url",void 0),(0,n.k)([(0,n.o)({type:o.p})],a.prototype,"visibilityTimeExtent",void 0),(0,n.k)([(0,n.o)({type:Boolean,nonNullable:!0})],a.prototype,"visible",void 0),a=(0,n.k)([(0,n.A)("esri.layers.Layer")],a);const l=a},68951:function(e,t,i){i.r(t),i.d(t,{default:function(){return x}});var n,o=i(98503),s=i(96510),r=i(49329),a=i(16787),l=i(7524),c=(i(92113),i(74362),i(70018));let h=n=class extends o.v{constructor(e){super(e),this.type="none"}clone(){return new n({type:this.type})}};var u;(0,o.k)([(0,o.bk)({none:"none",stayAbove:"stay-above"})],h.prototype,"type",void 0),h=n=(0,o.k)([(0,o.A)("esri.ground.NavigationConstraint")],h);let d=u=class extends((0,o.d9)(o.e)){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new o.V;const t=e=>{e.parent&&e.parent!==this&&"remove"in e.parent&&e.parent.remove(e),e.parent=this,"elevation"!==e.type&&"base-elevation"!==e.type&&o.n.getLogger(this).error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=e=>{e.parent=null};this.addHandles([this.layers.on("after-add",(e=>t(e.item))),this.layers.on("after-remove",(e=>i(e.item)))])}initialize(){this.when().catch((e=>{(0,o.E)(e)||o.n.getLogger(this).error("#load()","Failed to load ground",e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)(0,o.C)(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",(0,o.cW)(e,this._get("layers")))}writeLayers(e,t,i,n){const s=[];e&&(n={...n,layerContainerType:"ground"},e.forEach((e=>{if("write"in e){const t={};(0,r.o)(e)().write(t,n)&&s.push(t)}else n?.messages&&n.messages.push(new o.s("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in the ground`,{layer:e}))}))),t.layers=s}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return(0,a.t)(this,(e=>{e(this.layers)}))}async queryElevation(e,t){await this.load({signal:t?.signal});const{ElevationQuery:n}=await i.e(1004).then(i.bind(i,61004));(0,o.D)(t);const s=new n,r=this.layers.filter(m).toArray();return s.queryAll(r,e,t)}async createElevationSampler(e,t){await this.load({signal:t?.signal});const{ElevationQuery:n}=await i.e(1004).then(i.bind(i,61004));(0,o.D)(t);const s=new n,r=this.layers.filter(m).toArray();return s.createSamplerAll(r,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:(0,o.f)(this.surfaceColor),navigationConstraint:(0,o.f)(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new u({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,n){const s=t?.origin||"web-scene",r=t?.portal||null,a=t?.url||null,{populateOperationalLayers:l}=await Promise.all([i.e(3338),i.e(3297)]).then(i.bind(i,13338));(0,o.D)(n);const c=[];if(e.layers&&Array.isArray(e.layers)){const t={context:{origin:s,url:a,portal:r,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(l(this.layers,e.layers,t))}await Promise.allSettled(c)}};function p(e){return e&&"createElevationSampler"in e}function m(e){return"elevation"===e.type||p(e)}(0,o.k)([(0,o.o)({json:{read:!1}})],d.prototype,"layers",null),(0,o.k)([(0,o.q)("layers")],d.prototype,"writeLayers",null),(0,o.k)([(0,o.o)({readOnly:!0})],d.prototype,"resourceInfo",void 0),(0,o.k)([(0,o.o)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:o.bp,read:{reader:o.hs,source:"transparency"},write:{writer:(e,t)=>{t.transparency=(0,o.gu)(e)},target:"transparency"}}})],d.prototype,"opacity",void 0),(0,o.k)([(0,o.o)({type:o.aC,json:{type:[o.bp],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],d.prototype,"surfaceColor",void 0),(0,o.k)([(0,o.o)({type:h,json:{write:!0}})],d.prototype,"navigationConstraint",void 0),d=u=(0,o.k)([(0,o.A)("esri.Ground")],d);const g=d,f=new WeakMap;function y(e){return!e.destroyed&&(f.has(e)||e.addHandles([(0,o.aE)((()=>{const t=e.parent;return!(!t||!("type"in t))&&("catalog-dynamic-group"===t.type||y(t))}),(t=>f.set(e,t)),o.f1),(0,o.aH)((()=>f.delete(e)))]),f.get(e))}function v(e){return"object"==typeof e&&null!=e&&"loaded"in e&&!0===e.loaded&&"type"in e}function _(e){return!(!v(e)||!(0,o.d0)(e)?.operations?.supportsEditing||"editingEnabled"in e&&!(0,o.c$)(e)||y(e))}const w=()=>o.n.getLogger("esri.support.basemapUtils");function b(){return{}}function k(e){for(const t in e){const i=e[t];(0,o.C)(i),delete e[t]}}function M(e,t){let i;if("string"==typeof e){const n=e in s.s,r=!n&&e.includes("/");if(!n&&!r){if(o.H.apiKey)w().warn(`Unable to find basemap definition for: ${e}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const t=Object.entries(s.s).filter((([e,t])=>t.classic||t.is3d)).map((([e])=>`"${e}"`)).sort().join(", ");w().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${t}`)}return null}t&&(i=t[e]),i||(i=n?s.F.fromId(e):new s.F({style:{id:e}}),t&&(t[e]=i))}else i=(0,o.ef)(s.F,e);return i?.destroyed&&(w().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}const T={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function S(e){let t=null;if("string"==typeof e)if(e in T){const i=T[e];t=new g({resourceInfo:{data:{layers:[i]}}})}else o.n.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=(0,o.ef)(g,e);return t}let P=class extends((0,c.n)((0,c.l)(o.bP.EventedMixin(o.aD)))){constructor(e){super(e),this.allLayers=new l.n({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:e=>"layers"in e?e.layers:null}),this.allTables=(0,c.t)(this),this.basemap=null,this.editableLayers=new l.n({getCollections:()=>[this.allLayers],itemFilterFunction:_}),this.ground=new g,this._basemapCache=b()}destroy(){k(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=(0,o.C)(this.basemap),(0,o.C)(this.ground),this._set("ground",null)}castBasemap(e){return M(e,this._basemapCache)}castGround(e){return S(e)??this._get("ground")}findLayerById(e){return this.allLayers.find((t=>t.id===e))}findTableById(e){return this.allTables.find((t=>t.id===e))}};(0,o.k)([(0,o.o)({readOnly:!0,dependsOn:[]})],P.prototype,"allLayers",void 0),(0,o.k)([(0,o.o)({readOnly:!0})],P.prototype,"allTables",void 0),(0,o.k)([(0,o.o)({type:s.F,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],P.prototype,"basemap",void 0),(0,o.k)([(0,o.by)("basemap")],P.prototype,"castBasemap",null),(0,o.k)([(0,o.o)({readOnly:!0})],P.prototype,"editableLayers",void 0),(0,o.k)([(0,o.o)({type:g,nonNullable:!0})],P.prototype,"ground",void 0),(0,o.k)([(0,o.by)("ground")],P.prototype,"castGround",null),(0,o.k)([(0,o.o)()],P.prototype,"undoRedo",void 0),P=(0,o.k)([(0,o.A)("esri.Map")],P);const x=P},80774:function(e,t,i){i.r(t),i.d(t,{$:function(){return Vi},A:function(){return wr},B:function(){return Dr},C:function(){return Or},D:function(){return Er},E:function(){return yr},F:function(){return Cr},G:function(){return an},H:function(){return Nr},I:function(){return nl},J:function(){return qt},K:function(){return pl},L:function(){return vr},M:function(){return Vr},N:function(){return Mr},O:function(){return wi},P:function(){return ce},Q:function(){return vt},R:function(){return kr},S:function(){return Tr},T:function(){return Mt},U:function(){return wa},V:function(){return ec},_:function(){return ke},a:function(){return Gr},b:function(){return Xr},c:function(){return pn},d:function(){return ul},e:function(){return dn},f:function(){return j},g:function(){return Hi},h:function(){return Wr},i:function(){return Br},j:function(){return nn},k:function(){return un},l:function(){return hr},m:function(){return Ji},n:function(){return ln},o:function(){return Rr},p:function(){return Yi},q:function(){return Zr},r:function(){return Jr},s:function(){return Fr},t:function(){return Hr},u:function(){return _i},v:function(){return Xs},w:function(){return Ys},x:function(){return Js},y:function(){return Ia},z:function(){return Lr}});var n=i(98503),o=i(45996),s=i(7524),r=i(35271),a=i(49555),l=i(9949),c=i(32802),h=i(46585),u=i(60646),d=i(68951),p=i(87654),m=i(21303),g=i(50257),f=i(70018),y=i(31292),v=i(13193),_=i(5948),w=i(56707),b=i(39967),k=i(69539),M=i(25209),T=i(95062),S=i(58469),P=i(69852),x=i(85047),C=i(6780),E=i(76005),R=i(14408),I=i(92157),A=i(28549),L=i(41470),D=i(30),O=i(74855),V=i(85675),N=i(22676),z=i(48521);let F=class extends n.g0{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return null!=e&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],F.prototype,"row",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],F.prototype,"column",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],F.prototype,"rows",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],F.prototype,"columns",void 0),F=(0,n.k)([(0,n.A)("esri.CameraLayout")],F);const H=F;let G=class extends((0,n.a_)(n.v)){constructor(...e){super(...e),this.position=new n.bv([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new H}normalizeCtorArgs(e,t,i,n){if(e&&"object"==typeof e&&("x"in e||Array.isArray(e))){const o={position:e};return null!=t&&(o.heading=t),null!=i&&(o.tilt=i),null!=n&&(o.fov=n),o}return e}writePosition(e,t,i,o){const s=e.clone();s.x=(0,n.f$)(e.x||0),s.y=(0,n.f$)(e.y||0),s.z=e.hasZ?(0,n.f$)(e.z||0):e.z,t[i]=s.write({},o)}readPosition(e,t){const i=new n.bv;return i.read(e,t),i.x=(0,n.f$)(i.x||0),i.y=(0,n.f$)(i.y||0),i.z=i.hasZ?(0,n.f$)(i.z||0):i.z,i}equals(e){return null!=e&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};(0,n.k)([(0,n.o)({type:n.bv,json:{write:{isRequired:!0}}})],G.prototype,"position",void 0),(0,n.k)([(0,n.q)("position")],G.prototype,"writePosition",null),(0,n.k)([(0,n.u)("position")],G.prototype,"readPosition",null),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,n.by)((e=>o.a.normalize((0,n.f$)(e))))],G.prototype,"heading",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,n.by)((e=>(0,n.aP)((0,n.f$)(e),-180,180)))],G.prototype,"tilt",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0,json:{default:55,write:!0}}),(0,n.by)((e=>(0,n.aP)((0,n.f$)(e,55),1,170)))],G.prototype,"fov",void 0),(0,n.k)([(0,n.o)({type:H,nonNullable:!0,json:{read:!1,write:!1}})],G.prototype,"layout",void 0),G=(0,n.k)([(0,n.A)("esri.Camera")],G);const W=G;var U;let Z=U=class extends n.v{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new U({rotation:this.rotation,scale:this.scale,targetGeometry:null!=this.targetGeometry?this.targetGeometry.clone():null,camera:null!=this.camera?this.camera.clone():null})}};(0,n.k)([(0,n.o)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:q}}}}})],Z.prototype,"rotation",void 0),(0,n.k)([(0,n.by)("rotation")],Z.prototype,"castRotation",null),(0,n.k)([(0,n.o)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:q}}}}})],Z.prototype,"scale",void 0),(0,n.k)([(0,n.o)({types:n.b2,json:{read:n.b3,write:!0,origins:{"web-scene":{read:n.b3,write:{overridePolicy:q}}}}})],Z.prototype,"targetGeometry",void 0),(0,n.k)([(0,n.o)({type:W,json:{write:!0}})],Z.prototype,"camera",void 0),Z=U=(0,n.k)([(0,n.A)("esri.Viewpoint")],Z);const j=Z;function q(){return{enabled:!this.camera}}const B={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,n=this.values;return t<=i.xsmall?n.xsmall:t<=i.small?n.small:t<=i.medium?n.medium:t<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,n=this.values;return t<=i.xsmall?n.xsmall:t<=i.small?n.small:t<=i.medium?n.medium:t<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],n=t[1],o=this.values;return n>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},K={xsmall:544,small:768,medium:992,large:1200};function $(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function J(e,t){return t?B[e].valueToClassName[t].split(" "):[]}const X=e=>{let t=class extends e{constructor(...e){super(...e),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=K}initialize(){this.addHandles((0,n.aE)((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),n.cR))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(e){if(e!==this._get("breakpoints")){if(!$(e)){const t=JSON.stringify(K,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t),e=K}this._set("breakpoints",{...e})}}_updateClassNames(){if(!this.container)return;const e=n.ib.acquire(),t=n.ib.acquire();let i,o=!1;for(i in B){const n=this[i],s=B[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});n!==s&&(o=!0,this[i]=s,J(i,n).forEach((e=>t.push(e))),J(i,s).forEach((t=>e.push(t))))}o&&(this._applyClassNameChanges(e,t),n.ib.release(e),n.ib.release(t))}_applyClassNameChanges(e,t){const i=this.container;i&&(t.forEach((e=>i.classList.remove(e))),e.forEach((e=>i.classList.add(e))))}_removeActiveClassNames(){const e=this.container;if(!e)return;let t;for(t in B)J(t,this[t]).forEach((t=>e.classList.remove(t)))}};return(0,n.k)([(0,n.o)()],t.prototype,"breakpoints",null),(0,n.k)([(0,n.o)()],t.prototype,"orientation",void 0),(0,n.k)([(0,n.o)()],t.prototype,"widthBreakpoint",void 0),(0,n.k)([(0,n.o)()],t.prototype,"heightBreakpoint",void 0),t=(0,n.k)([(0,n.A)("esri.views.BreakpointsOwner")],t),t};let Y=class extends n.aD{constructor(){super(...arguments),this.items=new n.V,this._watchUpdatingTracking=new h.h,this._callbacks=new Map,this._projector=(0,c.s)(),this._hiddenProjector=(0,c.s)()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(e=>{for(const t of e.added){const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e)}for(const t of e.removed){const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t)}}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,i=this._hiddenProjector;let n;const o=()=>(n=e.render(),n);i.append(t,o),i.renderNow();const s={left:0,top:0,right:0,bottom:0};if(n?.domNode){const e=n.domNode.getBoundingClientRect();s.left=e.left,s.top=e.top,s.right=e.right,s.bottom=e.bottom}for(i.detach(o);t.firstChild;)t.removeChild(t.firstChild);return s}overlaps(e,t){const i=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(e,t){const i=!!t?.disableDecorations;if(!this.items.some((e=>e.visible&&!(i&&e.isDecoration))))return;const n=e.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach((e=>{i&&e.isDecoration||(n.save(),e.renderCanvas(n),n.restore())})),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};(0,n.k)([(0,n.o)({readOnly:!0})],Y.prototype,"surface",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Y.prototype,"items",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Y.prototype,"needsRender",null),(0,n.k)([(0,n.o)({readOnly:!0})],Y.prototype,"_watchUpdatingTracking",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Y.prototype,"updating",null),Y=(0,n.k)([(0,n.A)("esri.views.overlay.ViewOverlay")],Y);const Q=Y,ee=[0,0];function te(e){const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return ee[0]=i.left+(t?.pageXOffset??0),ee[1]=i.top+(t?.pageYOffset??0),ee}function ie(e){e&&(e.textContent="",e.parentNode&&e.parentNode.removeChild(e))}function ne(e){const t=document.createElement("div");return e.appendChild(t),t}const oe=16,se=750,re=512,ae=2,le=e=>{let t=class extends e{constructor(...e){super(...e),this._freqInfo={freq:oe,time:se},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([(0,n.aE)((()=>this.cursor),(e=>{const{surface:t}=this;t&&t.setAttribute("data-cursor",e)})),(0,n.aE)((()=>this.navigating),(e=>{const{surface:t}=this;t&&t.setAttribute("data-navigating",e.toString())}))])}initialize(){this.addHandles([(0,n.aE)((()=>this.ui),((e,t)=>this._handleUIChange(e,t)),n.cR),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui=(0,n.C)(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(e){const t=this._get("container"),i=(0,c.v)(e);if(i||"string"!=typeof e||n.n.getLogger(this).error("#container",`element with id '${e}' not found`),t===i)return;if(this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(ie(this.root),this._set("root",null)),this.userContent&&((0,c.x)(this.userContent,t),ie(this.userContent),this._set("userContent",null))),!i)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);i.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",(0,c.x)(i,o),i.appendChild(o),this._set("userContent",o);const s=document.createElement("div");s.className="esri-view-root",i.insertBefore(s,i.firstChild),this._set("root",s);const r=document.createElement("div");r.className="esri-view-surface",r.setAttribute("role","application"),r.tabIndex=0,s.appendChild(r),this._set("surface",r);const a=new Q;s.appendChild(a.surface),this._set("overlay",a),this.addHandles((0,n.aE)((()=>a.needsRender),(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=(0,n.jl)({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=(0,n.aJ)(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",i),this._startMeasuring()}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get size(){return[this.width,this.height]}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(e,t,i){const n=this.position;return e-=n?n[0]:0,t-=n?n[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}containerToPage(e,t,i){const n=this.position;return e+=n?n[0]:0,t+=n?n[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}_handleUIChange(e,t){this.removeHandles("ui"),t&&t!==e&&t.destroy(),e&&(e.view=this,this.addHandles((0,n.aE)((()=>this.root),(t=>{e.container=t?ne(t):null}),n.cR),"ui")),this._set("ui",e)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const e=this._freqInfo;e.freq=oe,e.time=se,this.addHandles([(0,n.eT)(window,"resize",(()=>{e.freq=oe,e.time=se})),(0,n.jl)({prepare:e=>{const t=this._measure(),i=this._freqInfo;if(i.time+=e.deltaTime,t&&(i.freq=oe,this._get("resizing")||this._set("resizing",!0)),i.time<i.freq)return;i.time=0;const n=this._position();i.freq=n||t?oe:Math.min(se,i.freq*ae),!t&&i.freq>=re&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const e=this.container,t=e?e.clientWidth:0,i=e?e.clientHeight:0;if(0===t||0===i)return this.suspended||this._set("suspended",!0),!1;const n=this.width,o=this.height;return t===n&&i===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:o,width:t,height:i}),!0)}_position(){const e=this.container,t=this.position,i=e&&te(e);return!!i&&(!t||i[0]!==t[0]||i[1]!==t[1])&&(this._set("position",[i[0],i[1]]),!0)}forceDOMReadyCycle(){}};return(0,n.k)([(0,n.o)()],t.prototype,"container",null),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"focused",null),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"height",void 0),(0,n.k)([(0,n.o)()],t.prototype,"messagesCommon",void 0),(0,n.k)([(0,n.o)({type:Q})],t.prototype,"overlay",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"position",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"resizing",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"root",void 0),(0,n.k)([(0,n.o)({value:null,readOnly:!0})],t.prototype,"size",null),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"surface",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"suspended",void 0),(0,n.k)([(0,n.o)()],t.prototype,"ui",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"userContent",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],t.prototype,"width",void 0),(0,n.k)([(0,n.o)()],t.prototype,"widthBreakpoint",void 0),t=(0,n.k)([(0,n.A)("esri.views.DOMContainer")],t),t},ce=(0,n.a$)("mac")?"Meta":"Control",he=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),ue=e=>he.has(e);let de=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return!1;return!0}},pe=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e)}onUninstall(){}registerIncoming(e,t,i){let n;"function"==typeof t?(i=t,n=[]):n=t||[];const o="string"==typeof e?new de(e,n):e,s=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},r=e=>{const t=this._incoming[e.match.eventType];if(t){const i=t.indexOf(e);t.splice(i,1),s(),this._manager&&this._manager.updateDependencies()}},a=new me(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&!t.includes(e)&&(t.push(e),s(),this._manager&&this._manager.updateDependencies())}});let l=this._incoming[o.eventType];return l||(l=[],this._incoming[o.eventType]=l),l.push(a),s(),this._manager&&this._manager.updateDependencies(),a}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new ge(e,{onEmit:(e,t,i,n)=>{this._manager?.emit(e.eventType,t,i,n)},onRemove:e=>{delete this._outgoing[e.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const i of t)if(i.match.matches(e)&&(i.callback?.(e),e.shouldStopPropagation()))break}},me=class{constructor(e,t,i){this.match=e,this._callback=t,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},ge=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,i){this._removed||this._handler.onEmit(this,e,t,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},fe=class extends pe{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(e=>this._update(e.data)))}_update(e){const t="touch"===e.native.pointerType?"touch":"mouse",{x:i,y:n}=e;t===this._value&&this._x===i&&this._y===n||(this._value=t,this._x=i,this._y=n,this._onChange(t,i,n))}},ye=class extends pe{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=(0,u.r)(!1),this._onPointerAdd=({data:e})=>{"touch"===e.pointerType&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{"touch"===e.pointerType&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},ve=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const i in e){const t=e[i],o=new n.k1(t,void 0,void 0,2,2);this._properties[i]={pool:o,acquired:[]}}this._afterDispatchHandle=(0,n.k2)((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const e of t.acquired)(0,n.k3)(e)||t.pool.release(e);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),i=this._properties[e];let n=i.pool.acquire();for(i.acquired.push(n);n===t;)i.acquired.push(n),n=i.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let i=0;for(const e of t.acquired)(0,n.k3)(e)?t.acquired[i++]=e:t.pool.release(e);t.acquired.length=i}}},_e=class extends n.aD{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=ce,this._latestPointerType="mouse",this._propertiesPool=new ve({latestPointerLocation:Te},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,t,i=ke.INTERNAL){if(this._nameToGroup[e]||0===t.length)return;const n={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=n;for(let o=n.handlers.length-1;o>=0;o--){const e=n.handlers[o];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(t,i,n,o,s)=>{this._emitInputEvent(e.priorityIndex+1,t,i,n,s,o)},setPointerCapture:(t,i)=>{this._setPointerCapture(n,e,t,i)},setEventCallback:t=>{e.eventCallback=t},setUninstallCallback:t=>{e.uninstallCallback=t},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback?.()})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):n.n.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return void 0!==this._nameToGroup[e]}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const e=this._handlers[i];e.priorityIndex=i,this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const n=this._handlersPriority[i];n.priorityIndex=i;let o=n.handler.hasSideEffects;if(!o)for(const t of n.handler.outgoingEventTypes)if(e.has(t)){o=!0;break}if(o)for(const i of n.handler.incomingEventMatches){e.add(i.eventType);for(const e of i.keyModifiers)ue(e)||t.add(e)}n.active=o}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,i){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(null==n||n.x!==t||n.y!==i){const e=this._propertiesPool.get("latestPointerLocation");e.x=t,e.y=i,this._set("latestPointerLocation",e)}}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId)}this._updateKeyModifiers(e,t);const i=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,i,n)}_updateKeyModifiers(e,t){if(!t)return;let i=!1;const n=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},o=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(n(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(n(),this._activeKeyModifiers.delete(e))};if("key-down"===e||"key-up"===e){const i=t.key;this._keyModifiers.has(i)&&o(i,"key-down"===e)}const s=t.native;o("Alt",!!s?.altKey),o("Control",!!s?.ctrlKey),o("Ctrl",!!s?.ctrlKey),o("Shift",!!s?.shiftKey),o("Meta",!!s?.metaKey),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new fe(((e,t,i)=>this._setLatestPointer(e,t,i))),this._multiTouchHandler=new ye,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],ke.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,ke.INTERNAL)}_setPointerCapture(e,t,i,n){const o=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,s),n?(s.add(o),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):s.has(o)&&(s.delete(o),0===s.size&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies()}_emitInputEventFromSource(e,t,i,n){this._emitInputEvent(0,e,t,i,n)}_emitInputEvent(e,t,i,n,o,s){const r=void 0!==n?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==o&&o,l={event:new we(t,i,r,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(l):this._doNewPropagation(l)}_doNewPropagation(e){this._currentPropagation={events:new r.s,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:t,priorityIndex:i}=e.events.pop(),n=t.data?.eventId;if(null==n||!this._stoppedPropagationEventIds.has(n))for(e.currentHandler=this._handlersPriority[i];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback?.(t),t.shouldStopPropagation()){null!=n&&this._stoppedPropagationEventIds.add(n);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const t=new r.s;t.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)t.push(i.events.pop());i.events=t,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(i.eventType!==e.eventType)continue;const t=i.keyModifiers.filter((t=>e.keyModifiers.includes(t)));if(t.length===i.keyModifiers.length!=(t.length===e.keyModifiers.length))return i.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const i of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(i,t[e])>=0;)e++;t.splice(e,0,i)}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t};return{injectEvent:(t,i)=>{e((()=>this._onEventReceived(t,i)))},disablePointerCapture:e}}};(0,n.k)([(0,n.o)({readOnly:!0})],_e.prototype,"hasPendingInputs",null),(0,n.k)([(0,n.o)({constructOnly:!0})],_e.prototype,"eventSource",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],_e.prototype,"recognizers",void 0),(0,n.k)([(0,n.o)()],_e.prototype,"_latestPointerType",void 0),(0,n.k)([(0,n.o)()],_e.prototype,"latestPointerType",null),(0,n.k)([(0,n.o)()],_e.prototype,"multiTouchActive",null),(0,n.k)([(0,n.o)({readOnly:!0})],_e.prototype,"latestPointerLocation",void 0),(0,n.k)([(0,n.o)()],_e.prototype,"_paused",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],_e.prototype,"updating",null),_e=(0,n.k)([(0,n.A)("esri.views.input.InputManager")],_e);let we=class{constructor(e,t,i,n,o){this.type=e,this.data=t,this.timestamp=i,this.modifiers=n,this.cancelable=o,this._propagationState=be.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=be.STOPPED}shouldStopPropagation(){return!!(this._propagationState&be.STOPPED)}async(e){this._propagationState|=be.PAUSED;const t=(e,t)=>{this._propagationState&=~be.PAUSED;const i=this._resumeCallback;if(this._resumeCallback=null,i&&i(),t)throw e;return e};return("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return!!(this._propagationState&be.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var be;(function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED"})(be||(be={}));const ke={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Me=class{};const Te=Me;function Se(e){return null!=e&&"open"in e&&"declaredClass"in e}function Pe(e){return null!=e&&"declaredClass"in e&&"dockOptions"in e}const xe=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([(0,n.aE)((()=>[this.ui,this.popup]),(([e,t],i)=>{const n="popup",o="manual";if(i){const[e,t]=i;e&&Se(t)&&(t.view=null,Pe(t)&&e.remove(t,n))}e&&Se(t)&&(t.view=this,Pe(t)&&e.add(t,{key:n,position:o,internal:!0}))}),n.cR),this.on("click",(e=>{this.popup&&this.popupEnabled&&("mouse"!==e.pointerType||0===e.button)&&(Se(this.popup)?this.popup.viewModel.handleViewClick(e):e.async((async()=>{await this.setupPopup(),Se(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(e)})))}),ke.WIDGET)]),(0,n.f2)((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{Promise.all([i.e(3313),i.e(6146),i.e(136),i.e(7509),i.e(9459),i.e(3281),i.e(3029),i.e(5420),i.e(6829)]).then(i.bind(i,14005))}))}destroy(){this.destroyed||this.closePopup()}async openPopup(e){if(Se(this.popup))return this.popup.open(e);try{if(await this.setupPopup(),!this.popup)return void n.n.getLogger(this).error(new n.s("view:null-popup","Popup is null and can't be opened"));this.popup.open(e)}catch{}}closePopup(){this._popupSetupTask?.abort(),Se(this.popup)&&this.popup.close()}async fetchPopupFeatures(e,t){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(e,t),t)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!Se(this.popup))return this._popupSetupTask=(0,n.ca)((async e=>{const{default:t}=await Promise.all([i.e(3313),i.e(6146),i.e(136),i.e(7509),i.e(9459),i.e(3281),i.e(3029),i.e(5420),i.e(6829)]).then(i.bind(i,14005));if((0,n.D)(e),!this.popup||Se(this.popup))return;const o=this.popup;delete o.open,delete o.close,this.popup=new t(o)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:e,hits:t},i){const o=[],s=[];let r=!1;const a=(0,n.k4)(i,(0,n.a$)("popup-view-fetch-timeout")??Ee),l=e=>{const t=new Ce(e);return s.push(t),o.push(t.promise),t},c=e=>{const t=s.at(-1);return t&&t.layerView===e&&!r?t:l(e)};for(const n of t)"graphic"in n?(c(n.layerView).graphics.push(n.graphic),r=!1):(o.push(n.layerView.fetchPopupFeaturesAtLocation(n.mapPoint,a)),r=!0);s.map((e=>e.resolve(a)));const h=(0,n.hM)(o).then((e=>e.filter((e=>!!e)).flat()));return{pendingFeatures:o,allGraphicsPromise:h,location:e}}async _getPopupHits(e,t){const{hits:i,location:o}=await this.popupHitTest(e);(0,n.D)(t);const s=[];for(const n of i)if("graphic"in n){if(this._isValidPopupGraphic(n.graphic,t)){const e=this._isValidPopupGraphicsLayerView(n.layerView)?n.layerView:void 0;s.push({graphic:n.graphic,layerView:e})}}else this._isValidPopupLocationLayerView(n.layerView)&&s.push({mapPoint:n.mapPoint,layerView:n.layerView});return{hits:s,location:o}}_isValidPopupGraphic(e,t){return e&&!!e.getEffectivePopupTemplate(t?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(e){return!e||(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesFromGraphics"in e}_isValidPopupLocationLayerView(e){return(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesAtLocation"in e}};return(0,n.k)([(0,n.o)()],t.prototype,"popup",void 0),(0,n.k)([(0,n.o)()],t.prototype,"popupEnabled",void 0),t=(0,n.k)([(0,n.A)("esri.views.PopupView")],t),t};let Ce=class{constructor(e){this.layerView=e,this._resolver=(0,n.aM)(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:t,graphics:i,_resolver:n}=this;if(!t)return n.resolve(i),n.promise;let o;return t.fetchPopupFeaturesFromGraphics(i,e).catch((e=>(o=e,null))).then((e=>{e?n.resolve(e):n.reject(o)})),n.promise}};const Ee=5e3;let Re=class extends p.n{constructor(e){super(e),this.addHandles(this.on("before-add",(e=>{null!=e.item&&e.item.parent===this.owner&&(n.n.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),e.preventDefault())})))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Re=(0,n.k)([(0,n.A)("esri.support.AnalysesCollection")],Re);let Ie=class extends n.aD{constructor(e){super(e),this.view=null,this.baseLayerViews=new n.V,this.referenceLayerViews=new n.V,this._loadingHandle=(0,n.aE)((()=>this.view?.map?.basemap),(e=>{e&&e.load().catch((()=>{}))}),n.cR)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){if(this.view?.suspended)return!1;const e=this.view?.map?.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some((e=>e.updating))||this.referenceLayerViews.some((e=>e.updating)))}};(0,n.k)([(0,n.o)({constructOnly:!0})],Ie.prototype,"view",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ie.prototype,"baseLayerViews",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ie.prototype,"referenceLayerViews",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ie.prototype,"suspended",null),(0,n.k)([(0,n.o)({type:Boolean,readOnly:!0})],Ie.prototype,"updating",null),Ie=(0,n.k)([(0,n.A)("esri.views.BasemapView")],Ie);const Ae=Ie;function Le(e){return"tryRecycleWith"in e}function De(e){return null!=e&&"object"==typeof e&&"layerViews"in e}let Oe=class{constructor(e,t,i){this.layer=e,this.view=t,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=(0,n.aM)(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,(0,n.aK)(this._controller.signal,(()=>{const t=new n.s("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(t)}))}tryRecycle(e){if(!this.done||!this.layerView||!Le(this.layerView))return null;const t=this.layer.type,i=this._controller.signal;for(let o=0;o<e.length;o++){const s=e[o];if(s.type!==t)continue;const r=this.layerView.tryRecycleWith(s,{signal:i});if(r){e.splice(o,1),this.layer=s;const t=this.layerView,i=t.view;return this.promise=Promise.race([r.then((()=>((0,n.D)(this._controller.signal),s.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{view:i,layerView:t}),s.emit("layerview-create",{view:i,layerView:t}),i.emit("layerview-create",{view:i,layerView:t}),t))),new Promise(((e,t)=>(0,n.aK)(this._controller.signal,(()=>t((0,n.aN)())))))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:t,view:i}=this;t.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:t,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:i}=this;this._map=i.map;try{let s,r;if(await t.load({signal:e}),t.prefetchResources&&await t.prefetchResources({signal:e}),ze(t))s=await t.createLayerView(i,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new n.s("layer:view-not-supported","No layerview implementation was found");const o=await this.layerViewImporter.importLayerView(t);(0,n.D)(e),s="default"in o?new o.default({layer:t,view:i}):new o({layer:t,view:i})}const a=()=>{r=(0,n.aJ)(r),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,this.done=!0};r=(0,n.aK)(e,a),(0,n.D)(e);try{await s.when()}catch(o){throw a(),o}if(!this._map?.allLayers?.includes(t))return a(),void this._deferred.reject(new n.s("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=s,t.emit("layerview-create",{view:i,layerView:s}),i.emit("layerview-create",{layer:t,layerView:s}),this.done=!0,this._deferred.resolve(s)}catch(s){t.emit("layerview-create-error",{view:i,error:s}),i.emit("layerview-create-error",{layer:t,error:s}),this.done=!0,this._deferred.reject(new n.s("layerview:create-error","layerview creation failed",{layer:t,error:s}))}}},Ve=class extends n.aD{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new h.h,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const e=this.view.map?.allLayers;if(e)for(const t of e)this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t)},this._reschedule=()=>this.destroyed?Promise.reject():(null==this._workPromise&&(this._workPromise=(0,n.aM)(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles((0,n.aI)(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),null==this._workPromise)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const t=new Set,i=[],o=this.view.ready,s=e=>{if(null!=e)for(const n of e)if(n){t.add(n);const e=this._layerLayerViewInfoMap.get(n);e&&o?e.start():e||this._recyclingInfoMap.has(n)||i.push(n),"layers"in n&&n.layers&&s(n.layers)}};for(const a of this._rootCollectionNames)s((0,n.fm)(this,a));for(const[n,a]of this._layerLayerViewInfoMap)if(!t.has(n)){this._layerLayerViewInfoMap.delete(a.layer);const e=a.tryRecycle(i);e?(this.notifyChange("updating"),this._recyclingInfoMap.set(a.layer,a),e.then((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(a.layer),this._layerLayerViewInfoMap.set(a.layer,a),this._reschedule()})).catch((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(a.layer),a.destroy(),this._reschedule()}))):a.destroy()}for(const[n,a]of this._recyclingInfoMap)t.has(n)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(a.layer),a.destroy());for(const n of i)this._createLayerView(n);this._refreshCollections();const r=[e?.ground?.layers,e?.basemap?.baseLayers,e?.basemap?.referenceLayers,e?.layers].filter((e=>!!e));t.forEach((e=>"layers"in e&&r.push(e.layers))),this.addHandles(r.map((e=>this._watchUpdatingTracking.addOnCollectionChange((()=>e),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([(0,n.aG)((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),(0,n.aE)((()=>{const e=this.view,t=e?.map;return[t?.basemap,t?.ground,t?.layers,e?.ready]}),(()=>this._reschedule()),n.f1)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),(0,f.a)(this._recyclingInfoMap),(0,f.a)(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,null!=this._workPromise&&(this._workPromise.reject((0,n.aN)()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return null!=this._workPromise||this._watchUpdatingTracking.updating||(0,n.fW)(this._layerLayerViewInfoMap,(e=>!e.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){this.destroyed||((0,f.a)(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new n.s("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,t){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const n=i.layerView;return!(!n||!t||n.parent===t)||!!(i.done&&n&&"layers"in e&&e.layers?.length)&&e.layers.some((e=>this.isCreatingLayerViewsForLayer(e,n)))}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners((0,n.fm)(this,e),(0,n.fm)(this,t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,i){if(!e||!t)return void(t&&t.removeAll());let n=0;for(const o of e){const e=this._layerLayerViewInfoMap.get(o);if(!e?.layerView)continue;const s=e.layerView;s.layer=o,s.parent=i,t.at(n)!==s&&t.splice(n,0,s),"layers"in o&&De(s)&&this._populateLayerViewsOwners(o.layers,s.layerViews,s),n+=1}n<t.length&&t.splice(n,t.length)}_createLayerView(e){e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new Oe(e,this.view,this.layerViewImporter);t.promise.then((()=>this._refreshCollections()),(t=>{t&&((0,n.E)(t)||"cancelled:layerview-create"===t.name)||n.n.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:t}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};(0,n.k)([(0,n.o)()],Ve.prototype,"_workPromise",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ve.prototype,"_watchUpdatingTracking",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ve.prototype,"_layersToLayerViews",null),(0,n.k)([(0,n.o)({readOnly:!0})],Ve.prototype,"_rootCollectionNames",null),(0,n.k)([(0,n.o)()],Ve.prototype,"layerViewImporter",void 0),(0,n.k)([(0,n.o)()],Ve.prototype,"supportsGround",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Ve.prototype,"updating",null),(0,n.k)([(0,n.o)({readOnly:!0})],Ve.prototype,"updatingRemaining",null),(0,n.k)([(0,n.o)({constructOnly:!0})],Ve.prototype,"view",void 0),Ve=(0,n.k)([(0,n.A)("esri.views.LayerViewManager")],Ve);const Ne=Ve;function ze(e){return"createLayerView"in e&&null!=e.createLayerView}let Fe=class extends n.aD{constructor(e){super(e),this.factor=1.5,this.offset=(0,n.eU)(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};(0,n.k)([(0,n.o)({type:Number})],Fe.prototype,"factor",void 0),(0,n.k)([(0,n.o)({nonNullable:!0})],Fe.prototype,"offset",void 0),(0,n.k)([(0,n.o)()],Fe.prototype,"position",void 0),(0,n.k)([(0,n.o)({type:Number,range:{min:0}})],Fe.prototype,"size",void 0),(0,n.k)([(0,n.o)()],Fe.prototype,"maskUrl",void 0),(0,n.k)([(0,n.o)()],Fe.prototype,"maskEnabled",void 0),(0,n.k)([(0,n.o)()],Fe.prototype,"overlayUrl",void 0),(0,n.k)([(0,n.o)()],Fe.prototype,"overlayEnabled",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Fe.prototype,"version",null),(0,n.k)([(0,n.o)({type:Boolean})],Fe.prototype,"visible",void 0),Fe=(0,n.k)([(0,n.A)("esri.views.Magnifier")],Fe);const He=Fe;function Ge(e){return!!(null!=e&&"object"==typeof e&&"createQuery"in e&&e.createQuery&&"on"in e&&e.on)}let We=class extends n.bP.EventedAccessor{constructor(e){super(e),this._selectionMap=new y.s,this._sources=new n.V,this._trashCan=[],this._layerEditHandles=new n.V,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([(0,n.aE)((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),(0,n.aG)((()=>this.sources),"change",(e=>{const t=this._selectionMap;for(const i of e.removed)t.delete(i);this._refreshListeners(),this._refreshVisualization()}),{onListenerAdd:()=>this._refreshListeners()})]);const e=new n.V;this.view.when().then((()=>{this.view.map&&(this.view.map.allLayers.flatten((e=>"sublayers"in e&&e.sublayers?e.sublayers:null)).forEach((t=>{(Ge(t)&&!(0,n.k5)(t)||(0,n.k6)(t))&&e.add(t)})),this.sources=e)}))}destroy(){this._layerEditHandles.drain(n.aJ)}get selections(){return Array.from(this._selectionMap.entries()).map((e=>{const[t,i]=e;return{layer:t,selection:[...i.selection]}}))}get count(){let e=0;for(const t of this._selectionMap.values())e+=t.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){(0,n.cW)(e,this._sources)}async getSelectedFeatures(e,t={},i="layerView"){const{view:o,selections:s}=this,r=(void 0!==e?s.filter((t=>e.includes(t.layer))):s).filter((e=>e.selection.length>0)).map((async e=>{const{layer:s,selection:r}=e,a=(0,n.k6)(s)?s.parent:s;if(null==a||!je(a))return null;if("layer"===i)return Be(a,r,t);if(Ue(a))return null;const l=await o.whenLayerView(a).catch((()=>null));return l?Be(l,r,t):null}));return(await Promise.all(r)).filter((e=>null!=e))}updateSelection(e){const t=new Map;for(const[n,s]of this._selectionMap)t.set(n,[...s.selection]);let i=!1;const o=e.current.concat(e.added);for(const s of o){const e=s.sourceLayer,o=s.getObjectId();if(this.sources.includes(e)&&(Ge(e)||(0,n.k6)(e))&&null!==o){const s=(0,n.ao)(t,e,(()=>[]));s.includes(o)||(s.push(o),i=!0)}}for(const s of e.removed){const e=s.sourceLayer,o=s.getObjectId();if(this.sources.includes(e)&&(Ge(e)||(0,n.k6)(e))&&null!==o){const n=t.get(e),s=n?.indexOf(o);void 0!==s&&s>=0&&(n?.splice(s,1),i=!0)}}if(i){const{_selectionMap:e,_trashCan:i}=this,o=[];for(const[s,r]of t){const t=e.get(s);void 0!==t&&i.push(t),e.set(s,{selection:r}),o.push({layer:s,selection:r,...(0,n.c_)(void 0!==t?t.selection:[],r)})}this._onSelectionChange(o)}}setSelection(e,t){this._setSelection(e,t)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,t){const i=this._selectionMap.get(e),n=void 0!==i?[...i.selection]:[];for(const o of t)n.includes(o)||n.push(o);this._setSelection(e,n)}removeFromSelection(e,t){const i=this._selectionMap.get(e);if(!i)return;const n=[];for(const o of i.selection)t.includes(o)||n.push(o);this._setSelection(e,n)}toggleInSelection(e,t){const i=this._selectionMap.get(e);if(!i||0===i.selection.length)return void this._setSelection(e,t);const o=new Set(i.selection),s=new Set(t),r=(0,n.k7)(o,s);this._setSelection(e,Array.from(r))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const t=[];for(const[i,n]of this._selectionMap.entries())t.push({layer:i,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(t)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){if(null==this.view||null==this.sources)return;for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();const{sources:e,view:t,_selectionMap:i,showHighlight:o}=this,s=this._vizTaskId;for(const r of e){const e=i.get(r),a=(0,n.k6)(r)?r.parent:r;if(null!=a&&je(a)){if(Ue(a))continue;t.whenLayerView(a).then((t=>{e?.highlightHandle?.remove(),null!=e&&o&&s===this._vizTaskId&&"highlight"in t&&"function"==typeof t.highlight&&e.selection.length>0&&(e.highlightHandle=t.highlight(e.selection,"selection"))})).catch((()=>{e?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(n.aJ);for(const e of this.sources){const t=(0,n.k6)(e)?e.parent:e;if(null!=t&&Ge(t)){const i=t.on("edits",(t=>{this._handleEditChanges(t,e)}));this._layerEditHandles.push(i)}}}_handleEditChanges(e,t){if(void 0!==e.deletedFeatures&&e.deletedFeatures.length>0&&this._selectionMap.has(t)){const i=e.deletedFeatures.filter((e=>null==e.error)).map((e=>e.objectId)).filter(n.bQ);this.removeFromSelection(t,i)}}_setSelection(e,t){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(void 0===i||!qe(i,{selection:t})){void 0!==i&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...t]});const o={layer:e,selection:[...t],...(0,n.c_)(void 0!==i?i.selection:[],t)};this._onSelectionChange([o])}}};(0,n.k)([(0,n.o)({readOnly:!0,nonNullable:!0})],We.prototype,"selections",null),(0,n.k)([(0,n.o)({readOnly:!0,nonNullable:!0})],We.prototype,"count",null),(0,n.k)([(0,n.o)({constructOnly:!0,nonNullable:!0})],We.prototype,"view",void 0),(0,n.k)([(0,n.o)({readOnly:!0,nonNullable:!0})],We.prototype,"hasSelection",null),(0,n.k)([(0,n.o)()],We.prototype,"showHighlight",void 0),(0,n.k)([(0,n.o)()],We.prototype,"sources",null),We=(0,n.k)([(0,n.A)("esri.views.SelectionManager")],We);const Ue=e=>(0,n.k6)(e)?!0===e.parent?.isTable:e.isTable,Ze=e=>void 0!==e.layer,je=e=>void 0!==e?.when,qe=(e,t)=>{if(null==e&&null==t)return!0;if(null!=e&&null==t||null==e&&null!=t)return!1;if(null!=e&&null!=t&&null!=e.selection&&null!=t.selection){const i=[...e.selection],n=[...t.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1}return!0},Be=async(e,t,i={})=>{let n;if(Ze(e)){const o=e;n=void 0===o?null:await o.queryFeatures(new v.b({...i,objectIds:t})).then((t=>({data:t,layer:e.layer})))}else{const o=e;n=void 0===o?null:await o.queryFeatures(new v.b({...i,objectIds:t})).then((e=>({data:e,layer:o})))}return n},Ke=We;let $e=class extends((0,n.a_)(n.aD)){constructor(e){super(e),this.accentColor=new n.aC([255,127,0]),this.textColor=new n.aC([255,255,255])}};(0,n.k)([(0,n.o)({type:n.aC,nonNullable:!0})],$e.prototype,"accentColor",void 0),(0,n.k)([(0,n.o)({type:n.aC,nonNullable:!0})],$e.prototype,"textColor",void 0),$e=(0,n.k)([(0,n.A)("esri.views.Theme")],$e);const Je=$e;var Xe;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"})(Xe||(Xe={}));const Ye=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],Qe={};function et(e){return!!Qe[e]}function tt(e){for(const t of e)if(!et(t))return!1;return!0}Ye.forEach((e=>{Qe[e]=!0}));let it=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach((({handler:e,priority:t},i)=>this.inputManager?.installHandlers(i,[e],t)))}disconnect(){this.inputManager&&this._handlers.forEach(((e,t)=>this.inputManager?.uninstallHandlers(t))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,i,o){const s=Array.isArray(e)?e:e.split(",");if(!tt(s))return s.some(et)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,a;Array.isArray(t)?a=t:(r=t,a=[]),"function"==typeof i?r=i:o=i,o=o??ke.DEFAULT;const l=this._createUniqueGroupName(),c=new nt(this.view,s,a,r);this._handlers.set(l,{handler:c,priority:o});for(const n of s){const e=this._handlerCounts.get(n)||0;this._handlerCounts.set(n,e+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],o),(0,n.aH)((()=>this._removeHandler(l,s)))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const e of t){const t=this._handlerCounts.get(e);void 0===t||(1===t?this._handlerCounts.delete(e):this._handlerCounts.set(e,t-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},nt=class extends pe{constructor(e,t,i,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",i,(t=>n(rt(e,t))));break;case"double-click":this.registerIncoming("double-click",i,(t=>n(at(e,t))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(t=>n(lt(e,t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(t=>n(ct(e,t))));break;case"hold":this.registerIncoming("hold",i,(t=>n(ht(e,t))));break;case"drag":this.registerIncoming("drag",i,(e=>{const t=this._wrapDrag(e);t&&n(t)}));break;case"key-down":this.registerIncoming("key-down",i,(e=>n(dt(e))));break;case"key-up":this.registerIncoming("key-up",i,(e=>n(pt(e))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(e=>n(mt(e,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(e=>n(mt(e,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(e=>n(mt(e,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(e=>n(gt(e))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(e=>n(ft(e))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(e=>n(mt(e,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(e=>n(mt(e,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(e=>{n(yt(e))}));break;case"focus":this.registerIncoming("focus",i,(e=>{n(ot(e))}));break;case"blur":this.registerIncoming("blur",i,(e=>{n(st(e))}))}}_wrapDrag(e){const t=e.data,{x:i,y:o}=t.center,{action:s,pointerType:r,button:a}=t;if("start"===s&&(this._latestDragStart=t),!this._latestDragStart)return;const l=t.pointer.native,c=t.buttons,{cancelable:h,timestamp:u}=e,d={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return"end"===s&&(this._latestDragStart=void 0),{type:"drag",action:s,x:i,y:o,origin:d,pointerType:r,button:a,buttons:c,radius:t.radius,angle:(0,n.dg)(t.angle),native:l,timestamp:u,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}};function ot(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function st(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function rt(e,t){const{pointerType:i,button:o,buttons:s,x:r,y:a,native:l,eventId:c}=t.data,{cancelable:h,timestamp:u}=t;return{type:"click",pointerType:i,button:o,buttons:s,x:r,y:a,native:l,timestamp:u,screenPoint:(0,n.eU)(r,a),mapPoint:ut(e,r,a),eventId:c,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function at(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:a,eventId:l}=t.data,{cancelable:c,timestamp:h}=t;return{type:"double-click",pointerType:i,button:n,buttons:o,x:s,y:r,native:a,timestamp:h,mapPoint:ut(e,s,r),eventId:l,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function lt(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:a,eventId:l}=t.data,c=a.pointerId,{cancelable:h,timestamp:u}=t;return{type:"immediate-click",pointerId:c,pointerType:i,button:n,buttons:o,x:s,y:r,native:a,timestamp:u,mapPoint:ut(e,s,r),eventId:l,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function ct(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:a,eventId:l}=t.data,c=a.pointerId,{cancelable:h,timestamp:u}=t;return{type:"immediate-double-click",pointerId:c,pointerType:i,button:n,buttons:o,x:s,y:r,native:a,timestamp:u,mapPoint:ut(e,s,r),eventId:l,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function ht(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:a}=t.data,{cancelable:l,timestamp:c}=t;return{type:"hold",pointerType:i,button:n,buttons:o,x:s,y:r,native:a,timestamp:c,mapPoint:ut(e,s,r),cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function ut(e,t,i){return e.toMap((0,n.eU)(t,i),{exclude:[]})}function dt(e){const{key:t,repeat:i,native:n}=e.data,{cancelable:o,timestamp:s}=e;return{type:"key-down",key:t,repeat:i,native:n,timestamp:s,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function pt(e){const{key:t,native:i}=e.data,{cancelable:n,timestamp:o}=e;return{type:"key-up",key:t,native:i,timestamp:o,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function mt(e,t){const{x:i,y:n,button:o,buttons:s,native:r,eventId:a}=e.data,l=r.pointerId,c=r.pointerType,{cancelable:h,timestamp:u}=e;return{type:t,x:i,y:n,pointerId:l,pointerType:c,button:o,buttons:s,native:r,timestamp:u,eventId:a,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function gt(e){const{x:t,y:i,buttons:n,native:o,eventId:s}=e.data.currentEvent,{button:r}=e.data.startEvent,a=e.data.startEvent.native.pointerId,l=e.data.startEvent.native.pointerType,c=e.data.action,h={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:u,timestamp:d}=e;return{type:"pointer-drag",x:t,y:i,pointerId:a,pointerType:l,button:r,buttons:n,action:c,origin:h,native:o,timestamp:d,eventId:s,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function ft(e){const{cancelable:t,data:i,timestamp:n}=e,{x:o,y:s,deltaY:r,native:a}=i;return{type:"mouse-wheel",x:o,y:s,deltaY:r,native:a,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function yt(e){const{action:t,state:i,device:n}=e.data,{cancelable:o,timestamp:s}=e,{buttons:r,axes:a}=i;return{type:"gamepad",device:n,timestamp:s,action:t,buttons:r,axes:a,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}var vt,_t,wt;function bt(e){return[e.on("before-add",(t=>{const i=t.item;if(null==i||e.includes(i))return n.n.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()})),e.on("after-remove",(e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()}))]}function kt(e){return e.visible&&null!=e.getEditableFlag&&e.getEditableFlag(vt.USER)&&e.getEditableFlag(vt.MANAGER)}function Mt(e){return(0,n.eU)(e.x,e.y)}function Tt(e,t){const i=(e instanceof HTMLElement?e:e.surface)?.getBoundingClientRect();return i?(0,n.eU)(t.clientX-i.left,t.clientY-i.top):(0,n.eU)(0,0)}function St(e,t){return t instanceof Event?Tt(e,t):Mt(t)}function Pt(e){if(e instanceof Event)return!0;if("object"==typeof e&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}(function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"})(vt||(vt={})),function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"}(_t||(_t={})),function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"}(wt||(wt={}));let xt=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,t){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":Rt(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:"start"===e.action?this._externallyDragging=!0:"end"===e.action&&(this._externallyDragging=!1),this._stopDrag&&(i(),"end"===e.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!It(e))break;const n=Mt(e),o=Et(n,e.pointerType,t.forEachTool);if(null==o)break;const s=o.manipulator,r=o.tool;null==s||null==r||!s.interactive||s.grabbable&&s.grabbableForEvent(e)||!s.grabbing||s.dragging||this._releaseManipulatorBeforeDragging(s,e,t),null!=s&&null!=r&&s.interactive&&s.grabbable&&s.grabbableForEvent(e)&&!s.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:s,tool:r,start:n,pointerType:e.pointerType}),1===this._grabbedManipulators.size&&null==t.activeTool&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),s.grabbing=!0,s.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!It(e))break;const o=this._grabbedManipulators.get(e.pointerId),s=o?.manipulator,r=o?.tool;if(null==s||null==r)break;const a=Mt(e);a.x=(0,n.aP)(a.x,0,t.view.width),a.y=(0,n.aP)(a.y,0,t.view.height);const l=o.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":"update"!==e.action&&1!==this._grabbedManipulators.size||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:r,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}i();break}case"immediate-click":{const n=Mt(e),o=Et(n,e.pointerType,t.forEachTool);if(At(e)||t.forEachTool((e=>{if((null==o||o.tool!==e||e.automaticManipulatorSelection)&&e.manipulators){let t=!1;e.manipulators.forEach((({manipulator:e})=>{e.selected&&(e.selected=!1,t=!0)})),t&&e.onManipulatorSelectionChanged&&e.onManipulatorSelectionChanged()}})),null==o)break;const{manipulator:s,tool:r}=o;if(!s.interactive)break;s.selectable&&r.automaticManipulatorSelection&&(s.selected=!s.selected,r.onManipulatorSelectionChanged&&r.onManipulatorSelectionChanged());const a=e.native.shiftKey;s.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),Lt(s,i);break}case"click":{const n=Mt(e),o=Et(n,e.pointerType,t.forEachTool),s=o?.manipulator;if(null==s||!s.interactive)break;const r=e.native.shiftKey;s.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:r}),i();break}case"double-click":{const n=Mt(e),o=Et(n,e.pointerType,t.forEachTool),s=null!=o?o.manipulator:null;if(null==s||!s.interactive)break;const r=e.native.shiftKey;s.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:r,stopPropagation:i}),Lt(s,i);break}case"immediate-double-click":{const n=Mt(e),o=Et(n,e.pointerType,t.forEachTool),s=null!=o?o.manipulator:null;if(null==s||!s.interactive)break;const r=e.native.shiftKey;s.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:r,stopPropagation:i}),"mouse"===e.pointerType&&Lt(s,i);break}}this._onFocusChange(t.forEachTool)}_releaseManipulatorBeforeDragging(e,t,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Mt(t)}),this._grabbedManipulators.forEach((({manipulator:t},i)=>{t===e&&this._grabbedManipulators.delete(i)})),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,t){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;null!=i&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Mt(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(t.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=Ct(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=Ct(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,i=new Set;this._grabbedManipulators.forEach((({tool:e})=>{t.add(e)})),this._hoveredManipulators.forEach((({tool:e})=>{i.add(e)})),e((e=>{e.hasGrabbedManipulators=t.has(e),e.hasHoveredManipulators=i.has(e);const o=this._grabbedManipulators.values(),s=(0,n.cA)(o,(({tool:t})=>t===e));e.firstGrabbedManipulator=null!=s?s.manipulator:null}))}clearPointers(e,{forEachTool:t,setActiveTool:i},n=!0,o){const s=(t,i)=>t===e&&(null==o||o===i);this._grabbedManipulators.forEach((({tool:e,manipulator:t,pointerType:i},n)=>{s(e,t)&&(this._grabbedManipulators.delete(n),t.grabbing=!1,t.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}))})),this._draggedManipulators.forEach((({tool:e,manipulator:t},i)=>{s(e,t)&&(this._draggedManipulators.delete(i),t.dragging=!1,t.events.emit("drag",{action:"cancel"}))})),n&&this._hoveredManipulators.forEach((({tool:e,manipulator:t},i)=>{s(e,t)&&(this._hoveredManipulators.delete(i),t.hovering=!1)})),this._afterManipulatorRelease(i),this._onFocusChange(t)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach(((t,i)=>{this._updateHoveredStateForPointerAtScreenPosition((0,n.eU)(t.x,t.y),i,t.pointerType,e)}))}handleHoverEvent(e,t){const i=e.type;"pointer-up"!==i&&"immediate-click"!==i&&"pointer-move"!==i||!Rt(e.pointerType)||("pointer-up"!==i&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Mt(e),e.pointerId,e.pointerType,t))}_updateHoveredStateForPointerAtScreenPosition(e,t,i,n){let o=Et(e,i,n);const s=this._hoveredManipulators.get(t)?.manipulator;null==o||o.manipulator.interactive||(o=null),null!=o&&s===o.manipulator||(null!=s&&(s.hovering=!1),null!=o?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorRelease(e){0===this._grabbedManipulators.size&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach((({manipulator:t},i)=>{e===i&&(this._hoveredManipulators.delete(e),t.hovering=!1)}))}};function Ct(e){for(const{manipulator:t}of e.values())if(null!=t&&t.interactive){if(t.grabbing&&t.grabCursor)return t.grabCursor;if(t.cursor)return t.cursor}return null}function Et(e,t,i){let n=null;return i((i=>{if(null==i.manipulators||!kt(i))return!1;const o=i.manipulators.intersect(e,t);return null!=o&&(n={tool:i,manipulator:o},!0)})),n}function Rt(e){return"mouse"===e}function It(e){return"mouse"!==e.pointerType||0===e.button}function At(e){return!!e.native.shiftKey}function Lt(e,t){e?.consumesClicks&&t()}const Dt="attached",Ot="tools",Vt=1e3;let Nt=class extends n.aD{constructor(e){super(e),this._updatingHandles=new h.h,this._clock=n.k8,this._manipulatorState=new xt,this.tools=new n.V,this.cursor=null,this._interacting=!1,this._interactingTimeout=Vt,this._interactingTimeoutHandle=null,this._forEachTool=e=>{for(const t of this.tools.items)if(e(t))return}}initialize(){this.addHandles([this.view.on(Ye,(e=>{this._handleInputEvent(e)}),ke.TOOL),...bt(this.tools),this.tools.on("before-add",(({item:e})=>{this._updateToolEditableFlag(e)})),this.tools.on("before-remove",(({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((e=>e.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(null!=e&&!this.view.ready)return void n.n.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),t?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const e=kt(i);null!=this.activeTool&&e||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!e)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((e=>e.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=(0,n.aJ)(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){"3d"===this.view.type?this.addHandles([(0,n.aE)((()=>{const{state:e}=this.view;return"camera"in e&&e.camera}),(()=>this._forEachManipulator((e=>e.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(e=>this._forEachManipulator((t=>t.onElevationChange(e)))))],Dt):this.addHandles((0,n.aE)((()=>this.view.extent),(()=>this._forEachManipulator((e=>e.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Dt),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool((t=>{t.manipulators&&t.manipulators.forEach((({manipulator:i})=>e(i,t)))}))}_handleInputEvent(e){let t=!1;const i={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};null!=this.activeTool?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((e=>{!t&&e.visible&&e.handleInputEvent(i)})),!t&&"key-down"===e.type&&"Escape"===e.key&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),t||null==this.activeTool||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),"pointer-move"===e.type&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(Ot),this._forEachTool((e=>{if(e instanceof n.aD){const t=(0,n.aE)((()=>[e.cursor,e.visible,e.editable]),(()=>{kt(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(t,Ot)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",(t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)})),e.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],Ot)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag?.(vt.MANAGER,null==this.activeTool||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;null==e&&this._forEachTool((t=>!(null==t.cursor||!t.visible)&&(e=t.cursor,!0))),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter((t=>(null==e||t!==e)&&!t.created&&t.removeIncompleteOnCancel)).forEach((e=>{this.tools.remove(e)}))}get test(){}};(0,n.k)([(0,n.o)({constructOnly:!0,nonNullable:!0})],Nt.prototype,"view",void 0),(0,n.k)([(0,n.o)({value:null})],Nt.prototype,"activeTool",null),(0,n.k)([(0,n.o)({readOnly:!0,type:n.V})],Nt.prototype,"tools",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Nt.prototype,"cursor",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Nt.prototype,"updating",null),(0,n.k)([(0,n.o)()],Nt.prototype,"_interacting",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Nt.prototype,"interacting",null),Nt=(0,n.k)([(0,n.A)("esri.views.ToolViewManager")],Nt);let zt=class extends n.aD{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":Ht.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return null!=this.nativeIndex&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Gt[this.deviceType]}};(0,n.k)([(0,n.o)({nonNullable:!0,readOnly:!0})],zt.prototype,"nativeIndex",void 0),(0,n.k)([(0,n.o)({type:String,readOnly:!0})],zt.prototype,"deviceType",null),(0,n.k)([(0,n.o)({type:Number,readOnly:!0})],zt.prototype,"axisThreshold",null),zt=(0,n.k)([(0,n.A)("esri.views.input.gamepad.GamepadInputDevice")],zt);const Ft=zt,Ht=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Gt={standard:.15,spacemouse:.025,unknown:0};let Wt=class extends n.aD{constructor(...e){super(...e),this.devices=new n.V,this.enabledFocusMode="document"}};(0,n.k)([(0,n.o)({type:n.V.ofType(Ft),readOnly:!0})],Wt.prototype,"devices",void 0),(0,n.k)([(0,n.o)({type:["document","view","none"]})],Wt.prototype,"enabledFocusMode",void 0),Wt=(0,n.k)([(0,n.A)("esri.views.input.gamepad.GamepadSettings")],Wt);const Ut=Wt;let Zt=class extends n.aD{constructor(){super(...arguments),this.gamepad=new Ut}};(0,n.k)([(0,n.o)({readOnly:!0})],Zt.prototype,"gamepad",void 0),Zt=(0,n.k)([(0,n.A)("esri.views.input.Input")],Zt);const jt=Zt,qt=()=>n.H.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;let Bt=class extends n.aD{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};(0,n.k)([(0,n.o)({type:Boolean,nonNullable:!0})],Bt.prototype,"enabled",void 0),(0,n.k)([(0,n.o)({type:Ft})],Bt.prototype,"device",void 0),(0,n.k)([(0,n.o)({type:["pan","zoom"],nonNullable:!0})],Bt.prototype,"mode",void 0),(0,n.k)([(0,n.o)({type:["forward-down","forward-up"],nonNullable:!0})],Bt.prototype,"tiltDirection",void 0),(0,n.k)([(0,n.o)({type:Number,nonNullable:!0})],Bt.prototype,"velocityFactor",void 0),Bt=(0,n.k)([(0,n.A)("esri.views.navigation.gamepad.GamepadSettings")],Bt);const Kt=Bt;let $t=class extends n.aD{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Kt,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!qt()}};(0,n.k)([(0,n.o)({type:Boolean})],$t.prototype,"browserTouchPanEnabled",void 0),(0,n.k)([(0,n.o)({type:Kt,nonNullable:!0})],$t.prototype,"gamepad",void 0),(0,n.k)([(0,n.o)({type:Boolean})],$t.prototype,"momentumEnabled",void 0),(0,n.k)([(0,n.o)({type:Boolean})],$t.prototype,"mouseWheelZoomEnabled",void 0),$t=(0,n.k)([(0,n.A)("esri.views.navigation.Navigation")],$t);const Jt=$t;var Xt;function Yt(e){if("integrated-mesh-3dtiles"===e.type)return null;const t=e.url?(0,_.d)(e.url):void 0;return(null!=e.spatialReference?.vcsWkid||null==t||"ImageServer"!==t.serverType)&&Qt(e)&&e.heightModelInfo?e.heightModelInfo:ti(e)?m.v.deriveUnitFromSR(oi,e.spatialReference):null}function Qt(e){return"heightModelInfo"in e}function ei(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function ti(e){return ei(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):ni(e)}function ii(e){return null!=e.layers||ni(e)||ei(e)||Qt(e)}function ni(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"focusArea":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(Xt||(Xt={}));const oi=new m.v({heightModel:"gravity-related-height"});let si,ri=null;async function ai(e){ri||(ri=i.e(1780).then(i.bind(i,21780)).then((e=>si=e))),await ri,(0,n.D)(e)}async function li(e,t,i,n){if(!e)return null;const o=e.spatialReference;return(0,a._)()||(0,a.J)(o,t)?(0,a.K)(e,t):si?si.projectGeometry(e,t,i,n):(await Promise.race([ai(n),(0,a.W)(n)]),li(e,t,i,n))}let ci=class extends n.aD{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=(0,n.eO)(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return null==this.userSpatialReference||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),t=[];return null!=this.priorityCollection&&t.push(this.priorityCollection),t.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),t}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,(t=>{const i=this._getSupportedSpatialReferences(t);if(i.length>0){const t=this._narrowDownSpatialReferenceCandidates(e,i);null!=t&&(e=t)}return 1===e?.length}))&&1!==e?.length)return{updating:!0};const t=this._pickSpatialReferenceCandidate(e);return{spatialReference:t?.spatialReference??null,viewingMode:t?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),t=this.spatialReference;if(!t)return{updating:this._spatialReferenceTask.updating};let i;const n=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers}],(e=>!(!("tileInfo"in e)||!e.tileInfo?.spatialReference.equals(t))&&(i=e,!0)),(e=>"tileInfo"in e));return i?{tileInfo:i.tileInfo,updating:!1}:{updating:n}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const t=this._collectLayers(this.mapCollections,(t=>{const i=Yt(t);return!!i&&(e={heightModelInfo:i,vcsWkid:t.spatialReference?.vcsWkid,latestVcsWkid:t.spatialReference?.latestVcsWkid},!0)}),(e=>ii(e)));return{...e,updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],t=this._collectLayers(this.mapCollections,(t=>{const i="fullExtents"in t&&t.fullExtents||(null!=t.fullExtent?[t.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:i[0],o=i.find((e=>e.spatialReference.equals(this.spatialReference)))??n;if(o)return e.push({extent:o,layer:t}),!0;if(this._getSupportedSpatialReferences(t).length>0)for(const s of i)e.push({extent:s,layer:t});return!1}));return{candidates:e,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(null==e||0===e.length)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),o=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&o.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:null!=this._projectExtentTask.task&&!this._projectExtentTask.task.finished}:(null!=this._projectExtentTask.task&&(this._projectExtentTask.task=(0,n.eO)(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:o.clone(),task:(0,n.ca)((async e=>{try{const t=await li(i.extent,o,"portalItem"in i.layer?i.layer.portalItem:void 0,e);this._projectExtentTask={...this._projectExtentTask,task:null,output:t}}catch{if((0,n.fp)(e))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(null==e)return t;const i=new Array;for(const n of e)for(const e of t){if(!n.spatialReference.equals(e.spatialReference))continue;const t=ui(n.viewingMode,e.viewingMode);if(!1!==t){i.push({spatialReference:n.spatialReference,viewingMode:t});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return null==e||e.length<1?t?{spatialReference:t,viewingMode:null}:null:(null!=t&&e.length>1&&e.some((({spatialReference:e})=>e.equals(t)))&&(e=e.filter((({spatialReference:e})=>e.equals(t)))),e.length>1&&e.some((({viewingMode:e})=>e!==w.l.Local))&&(e=e.filter((({viewingMode:e})=>e!==w.l.Local))),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return[];const i=[];for(const n of t){const t=this.getSpatialReferenceSupport(n,e);if(null!=t){const e=t.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:t,viewingMode:n}of e)this.requiresExtentInSpatialReference&&null!=this.userSpatialReference&&!t.equals(this.userSpatialReference)||i.push({spatialReference:t,viewingMode:n})}}return i}_pickExtentCandidate(e){const t=this.spatialReference;return e.find((({extent:e})=>t.equals(e.spatialReference)))||e[0]}_collectLayers(e,t,i=()=>!0){if("loaded"!==this._loadMaybe(this.map?.()))return!0;const n=new hi(i,t);for(const o of e)if(this._collectCollection(o,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const i of e.layers)if(t.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":if(t.updating||(t.done=t.pushLayer(i)),t.done||t.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},t)}if(t.done||t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&null!=e.loadStatus?"not-loaded"===e.loadStatus?(e.load().catch((e=>{(0,n.E)(e)})),"loading"):e.loadStatus:"loaded"}};(0,n.k)([(0,n.o)()],ci.prototype,"required",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],ci.prototype,"map",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],ci.prototype,"getSpatialReferenceSupport",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"defaultSpatialReference",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"userSpatialReference",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"sourcePreloadCount",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"priorityCollection",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"requiresExtentInSpatialReference",void 0),(0,n.k)([(0,n.o)()],ci.prototype,"suspended",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"ready",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"heightModelInfoReady",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"spatialReference",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"extent",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"heightModelInfo",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"vcsWkid",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"latestVcsWkid",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"viewingMode",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"tileInfo",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"mapCollections",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"_spatialReferenceTask",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"_tileInfoTask",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"_heightModelInfoTask",null),(0,n.k)([(0,n.o)({readOnly:!0})],ci.prototype,"_extentCandidatesTask",null),(0,n.k)([(0,n.o)()],ci.prototype,"_extentTask",null),(0,n.k)([(0,n.o)()],ci.prototype,"_projectExtentTask",void 0),ci=(0,n.k)([(0,n.A)("esri.views.support.DefaultsFromMap")],ci);let hi=class{constructor(e,t){this.layerFilter=e,this.pushLayer=t,this.preloading=-1,this.updating=!1,this.done=!1}};function ui(e,t){return null!=e?null!=t?e===t&&e:e:t}var di;let pi=di=class extends(n.bP.EventedMixin((0,n.gs)(n.aD))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new n.eS,this.updatingHandles=new h.h,this.allLayerViews=new s.n({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:fi}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new p.c,this.analyses=new Re,this.typeSpecificPreconditionsReady=!0,this.layerViews=new n.V,this.magnifier=new He,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new jt,this.navigation=new Jt,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new it(this),this.persistableViewModels=new n.V,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add((0,n.aE)((()=>this.preconditionsReady),(e=>{const t=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,di.views.add(this)):(this._lockedSpatialReference=null,di.views.remove(this)),this.notifyChange("spatialReference"),!e&&t)this.toolViewManager?.detach(),null!=this.analysisViewManager&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(e&&!t){try{this._startup()}catch(i){return void queueMicrotask((()=>{this.fatalError=new n.s("startup-error",null,i)}))}null!=this.analysisViewManager&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),n.az))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,(0,n.f2)((()=>this.ready)))))),this.basemapView=new Ae({view:this}),this.layerViewManager=new Ne({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new Nt({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new Ke({view:this}),this.addHandles([(0,n.aE)((()=>this.initialExtentRequired),(e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e}),n.f1),(0,n.aE)((()=>this.ready),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)}),n.az),(0,n.aE)((()=>this._userSpatialReference),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)}),n.f1)])}_setupSpatialReferenceLogger(){let e=null;this.addHandles([(0,n.aE)((()=>this.defaultsFromMap?.ready),(t=>{const i=this.map?.allLayers.length>0;if(t&&!this.spatialReference&&i){if(null!=e)return;const t=(0,n.aH)((()=>e=(0,n.eO)(e)));e=(0,n.ca)((async t=>{try{await(0,n.eX)(this.spatialReferenceWarningDelay,null,t)}catch{return}finally{e=null}n.n.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),this.addHandles(t,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")}),{sync:!0})])}destroy(){this.destroyed||(di.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=(0,n.C)(this.graphics),this.analyses=(0,n.C)(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),(0,n.C)(this.analysisViewManager),this.toolViewManager=(0,n.C)(this.toolViewManager),this.layerViewManager=(0,n.C)(this.layerViewManager),this.selectionManager=(0,n.C)(this.selectionManager),this.basemapView=(0,n.C)(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((e=>e.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=(0,n.C)(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return n.n.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new ci({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,t)=>this.getSpatialReferenceSupport(e,t),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||n.e.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(n.n.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),n.e.isLoadable(e)&&e.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const t=e.clone();return t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,t}return e}set spatialReference(e){const t=!(0,n.bh)(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??n.dL}set timeZone(e){this._userTimeZone=e,(0,n.hO)(e)||n.n.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new Je}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(e){throw new n.s("importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return null!=this.getSpatialReferenceSupport(e)}when(e,t){return this.isResolved()&&!this.ready&&n.n.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&((0,n.aF)((()=>this.destroyed||!1===this.preconditionsReady),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};pi.views=new n.V,(0,n.k)([(0,n.o)()],pi.prototype,"_userSpatialReference",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"activeTool",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"allLayerViews",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"groundView",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"animation",null),(0,n.k)([(0,n.o)()],pi.prototype,"basemapView",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"center",null),(0,n.k)([(0,n.o)()],pi.prototype,"defaultsFromMapSettings",null),(0,n.k)([(0,n.o)()],pi.prototype,"defaultsFromMap",null),(0,n.k)([(0,n.o)()],pi.prototype,"fatalError",void 0),(0,n.k)([(0,n.o)({type:n.au})],pi.prototype,"extent",null),(0,n.k)([(0,n.o)((0,p.l)(p.c,"graphics"))],pi.prototype,"graphics",void 0),(0,n.k)([(0,n.o)((0,p.l)(Re,"analyses"))],pi.prototype,"analyses",void 0),(0,n.k)([(0,n.o)({readOnly:!0,type:m.v})],pi.prototype,"heightModelInfo",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"interacting",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"navigating",null),(0,n.k)([(0,n.o)({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],pi.prototype,"preconditionsReady",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"typeSpecificPreconditionsReady",void 0),(0,n.k)([(0,n.o)({type:n.V,readOnly:!0})],pi.prototype,"layerViews",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"resolution",null),(0,n.k)([(0,n.o)({type:He})],pi.prototype,"magnifier",void 0),(0,n.k)([(0,n.o)({value:null,type:d["default"]})],pi.prototype,"map",null),(0,n.k)([(0,n.o)()],pi.prototype,"padding",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"ready",void 0),(0,n.k)([(0,n.o)({type:n.B})],pi.prototype,"spatialReference",null),(0,n.k)([(0,n.o)()],pi.prototype,"spatialReferenceWarningDelay",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"stationary",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"supportsGround",void 0),(0,n.k)([(0,n.o)({type:g.p})],pi.prototype,"timeExtent",null),(0,n.k)([(0,n.o)({type:String,nonNullable:!0})],pi.prototype,"timeZone",null),(0,n.k)([(0,n.o)()],pi.prototype,"tools",null),(0,n.k)([(0,n.o)()],pi.prototype,"toolViewManager",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"type",void 0),(0,n.k)([(0,n.o)({type:Number})],pi.prototype,"scale",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"updating",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"initialExtentRequired",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"initialExtent",null),(0,n.k)([(0,n.o)()],pi.prototype,"cursor",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"input",void 0),(0,n.k)([(0,n.o)({type:Jt,nonNullable:!0})],pi.prototype,"navigation",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"layerViewManager",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"analysisViewManager",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"selectionManager",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"width",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"height",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"resizing",void 0),(0,n.k)([(0,n.o)({value:null,readOnly:!0})],pi.prototype,"size",null),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"suspended",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"viewEvents",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],pi.prototype,"persistableViewModels",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_isValid",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_readyCycleForced",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_lockedSpatialReference",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_userTimeZone",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_lockedTimeZone",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_userTimeExtent",void 0),(0,n.k)([(0,n.o)()],pi.prototype,"_lockedTimeExtent",void 0),(0,n.k)([(0,n.o)({type:Je})],pi.prototype,"theme",void 0),(0,n.k)([(0,n.o)({readOnly:!0,type:Je})],pi.prototype,"effectiveTheme",null),pi=di=(0,n.k)([(0,n.A)("esri.views.View")],pi);const mi=globalThis.$arcgis;mi&&!mi.views&&Object.defineProperty(mi,"views",{configurable:!1,enumerable:!0,writable:!1,value:pi.views});const gi=pi;function fi(e){return e.layerViews}let yi=class extends n.k9{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=(0,n.aM)(),this.addResolvingPromise(this._resolver.promise)}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._resolver?.reject(new n.s("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._resolver?.resolve())}update(e,t){t||(t=(0,n.aO)(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};(0,n.k)([(0,n.o)({readOnly:!0})],yi.prototype,"done",null),(0,n.k)([(0,n.o)({readOnly:!0,type:String})],yi.prototype,"state",void 0),(0,n.k)([(0,n.o)()],yi.prototype,"target",void 0),yi=(0,n.k)([(0,n.A)("esri.views.ViewAnimation")],yi),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(yi||(yi={}));const vi=yi;function _i(){return[1,0,0,1,0,0]}function wi(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function bi(e,t,i,n,o,s){return[e,t,i,n,o,s]}function ki(e,t){return new Float64Array(e,t,6)}const Mi=_i();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Mi,clone:wi,create:_i,createView:ki,fromValues:bi},Symbol.toStringTag,{value:"Module"}));const Ti=96,Si=39.37,Pi=180/Math.PI;function xi(e){return e.wkid?e:e.spatialReference||n.B.WGS84}function Ci(e,t){return t.type?(0,k.o)(e,t.x,t.y):(0,k.r)(e,t)}function Ei(e){return(0,n.bq)(e)}function Ri(e,t,i=0){let o=e.width,s=e.height;if(0!==i){const t=(0,n.eI)(i),r=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t));o=e.width*r+e.height*a,s=e.width*a+e.height*r}const r=Math.max(1,t[0]),a=Math.max(1,t[1]);return Math.max(o/r,s/a)*ji(e.spatialReference)}async function Ii(e,t,i,o){let s,r;if(!e||Array.isArray(e)&&!e.length)return null;if(n.V.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&"object"==typeof e[0]){const n=e.every((e=>"attributes"in e)),s=e.some((e=>!e.geometry));let r=e;if(n&&s&&t&&t.allLayerViews){const i=new Map;for(const t of e){const e=t.layer,n=i.get(e)||[],o=t.attributes[e.objectIdField];null!=o&&n.push(o),i.set(e,n)}const n=[];i.forEach(((e,i)=>{const o=t.allLayerViews.find((e=>e.layer.id===i.id));if(o&&"queryFeatures"in o){const t=i.createQuery();t.objectIds=e,t.returnGeometry=!0,n.push(o.queryFeatures(t))}}));const o=await Promise.all(n),s=[];for(const e of o)if(e&&e.features&&e.features.length)for(const t of e.features)null!=t.geometry&&s.push(t.geometry);r=s}for(const e of r)o=await Ii(e,t,i,o);return o}if(Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])s=new n.bv(e);else if(e instanceof n.cH)s=e;else if("geometry"in e)if(e.geometry)s=e.geometry;else if(e.layer){const i=e.layer,n=t.allLayerViews.find((e=>e.layer.id===i.id));if(n&&"queryFeatures"in n){const t=i.createQuery();t.objectIds=[e.attributes[i.objectIdField]],t.returnGeometry=!0,s=(await n.queryFeatures(t))?.features?.[0]?.geometry}}if(null==s)return null;switch(s.type){case"point":r=new n.au({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":r=(0,S.v)(s);break;default:r=s.extent}if(!r)return null;(0,a._)()||(0,a.J)(r.spatialReference,i)||await(0,a.W)();const l=(0,a.K)(r,i);if(!l)return null;if(o){const e=l.center,t=e.clone();t.x=(0,S.P)(e.x,o.center.x,i),t.x!==e.x&&l.centerAt(t),o=o.union(l)}else o=l;return o}function Ai(e){if(e&&(!Array.isArray(e)||"number"!=typeof e[0])&&("object"==typeof e||Array.isArray(e)&&"object"==typeof e[0])){if("layer"in e&&null!=e.layer?.minScale&&null!=e.layer.maxScale){const t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every((e=>"layer"in e))){let t=0,i=0;for(const n of e){const e=n.layer;e?.minScale&&e.maxScale&&(t=e.minScale<t?e.minScale:t,i=e.maxScale>i?e.maxScale:i)}return t&&i?{min:t,max:i}:null}}}function Li(e,t){const i=xi(e);return(0,n.bh)(i,t)||i.imageCoordinateSystem||t.imageCoordinateSystem?e:(0,a.K)(e,t)}async function Di(e,t){if(!e||!t)return new j({targetGeometry:new n.bv,scale:0,rotation:0});let i=t.spatialReference;const{constraints:o,padding:s,viewpoint:r,size:l}=t,c=[s?l[0]-s.left-s.right:l[0],s?l[1]-s.top-s.bottom:l[1]];let h=null;e instanceof j?h=e:e.viewpoint?h=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(h=e.target);let u=null;h?.targetGeometry?u=h.targetGeometry:e instanceof n.au?u=e:e instanceof n.cH?u=await Ii(e,t,i):e&&(u=await Ii(e.center,t,i)||await Ii(e.target,t,i)||await Ii(e,t,i)),!u&&r?.targetGeometry?u=r.targetGeometry:!u&&t.extent&&(u=t.extent),i||(i=xi(t.spatialReference||t.extent||u)),(0,a._)()||(0,n.bh)(u.spatialReference,i)||(0,a.J)(u.spatialReference,i)||await(0,a.W)();const d=Li(u,i),p="center"in d?d.center:d;!1!==t.pickClosestTarget&&"point"===p.type&&"point"===r.targetGeometry?.type&&(p.x=(0,S.P)(p.x,r.targetGeometry.x,p.spatialReference));let m=0;h?m=h.rotation:e.hasOwnProperty("rotation")?m=e.rotation:r&&(m=r.rotation);let g=0;g=null!=h?.targetGeometry&&"point"===h.targetGeometry.type?h.scale:"scale"in e&&e.scale?e.scale:"zoom"in e&&-1!==e.zoom&&o&&o.effectiveLODs?o.zoomToScale(e.zoom):Array.isArray(u)||"point"===u.type||"extent"===u.type&&0===u.width&&0===u.height?r.scale:Ri(Li(u.extent,i),c,m);const f=Ai(e.target??e);f&&(f.min&&f.min<g?g=f.min:f.max&&f.max>g&&(g=f.max));let y=new j({targetGeometry:p,scale:g,rotation:m});return o&&(y=o.fit(y),o.constrainByGeometry(y),o.rotationEnabled||(y.rotation=r.rotation)),y}function Oi(e,t){const i=e.targetGeometry,n=t.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function Vi(e,t,i){return i?(0,k.o)(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):(0,k.l)(e,t,.5)}const Ni=function(){const e=(0,b.n)();return function(t,i,n){const o=i.targetGeometry;Ci(e,o);const s=.5*Wi(i);return t.xmin=e[0]-s*n[0],t.ymin=e[1]-s*n[1],t.xmax=e[0]+s*n[0],t.ymax=e[1]+s*n[1],t.spatialReference=o.spatialReference,t}}();function zi(e,t,i,n,o){return en(e,t,i.center),e.scale=Ri(i,n),o?.constraints?.constrain(e),e}function Fi(e,t,i,n){return Ki(e,t,i,n),(0,T.u)(e,e)}const Hi=function(){const e=(0,b.n)();return function(t,i,n){return(0,k.B)(t,qi(t,i),Vi(e,i,n))}}(),Gi=function(){const e=_i(),t=(0,b.n)();return function(i,n,o,s){const r=Wi(n),a=Zi(n);return(0,k.o)(t,r,r),(0,T.l)(e,t),(0,T.c)(e,e,a),(0,T.a)(e,e,Hi(t,o,s)),(0,T.a)(e,e,[0,s.top-s.bottom]),(0,k.o)(i,e[4],e[5])}}();function Wi(e){return e.scale*Ui(e.targetGeometry?.spatialReference)}function Ui(e){return null!=e&&(0,n.cg)(e)?1/(Ei(e)*Si*Ti):1}function Zi(e){return(0,M.u)(e.rotation)||0}function ji(e){return(0,n.cg)(e)?Ei(e)*Si*Ti:1}function qi(e,t){return(0,k.l)(e,t,.5)}const Bi=function(){const e=(0,b.n)(),t=(0,b.n)(),i=(0,b.n)();return function(n,o,s,r,a,l){return(0,k.x)(e,o),(0,k.l)(t,s,.5*l),(0,k.o)(i,1/r*l,-1/r*l),(0,T.k)(n,t),a&&(0,T.c)(n,n,a),(0,T.f)(n,n,i),(0,T.a)(n,n,e),n}}(),Ki=function(){const e=(0,b.n)();return function(t,i,n,o){const s=Wi(i),r=Zi(i);return Ci(e,i.targetGeometry),Bi(t,e,n,s,r,o)}}(),$i=function(){const e=(0,b.n)();return function(t,i,n,o){const s=Wi(i);return Ci(e,i.targetGeometry),Bi(t,e,n,s,0,o)}}();function Ji(e){const t=(0,n.bF)(e);return t?t.valid[1]-t.valid[0]:0}function Xi(e,t){return Math.round(Ji(e)/t)}const Yi=function(){const e=(0,b.n)(),t=(0,b.n)(),i=[0,0,0];return function(n,o,s){(0,k.e)(e,n,o),(0,k.v)(e,e),(0,k.e)(t,n,s),(0,k.v)(t,t),(0,k.y)(i,e,t);let r=Math.acos((0,k.j)(e,t)/((0,k.q)(e)*(0,k.q)(t)))*Pi;return i[2]<0&&(r=-r),isNaN(r)&&(r=0),r}}(),Qi=function(){const e=(0,b.n)();return function(t,i,n,o){const s=t.targetGeometry;return Oi(t,i),Gi(e,i,n,o),s.x+=e[0],s.y+=e[1],t}}(),en=function(e,t,i){Oi(e,t);const n=e.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,e},tn=function(){const e=(0,b.n)();return function(t,i,n,o,s){s||(s="center"),(0,k.B)(e,n,o),(0,k.l)(e,e,.5);const r=e[0],a=e[1];switch(s){case"center":(0,k.o)(e,0,0);break;case"left":(0,k.o)(e,-r,0);break;case"top":(0,k.o)(e,0,a);break;case"right":(0,k.o)(e,r,0);break;case"bottom":(0,k.o)(e,0,-a);break;case"top-left":(0,k.o)(e,-r,a);break;case"bottom-left":(0,k.o)(e,-r,-a);break;case"top-right":(0,k.o)(e,r,a);break;case"bottom-right":(0,k.o)(e,r,-a)}return un(t,i,e),t}}();function nn(e,t,i){return Oi(e,t),e.rotation+=i,e}function on(e,t,i){return Oi(e,t),e.rotation=i,e}const sn=function(){const e=(0,b.n)();return function(t,i,n,o,s){return Oi(t,i),isNaN(n)||0===n||(cn(e,o,i,s),t.scale=i.scale*n,hn(e,e,t,s),un(t,t,(0,k.o)(e,e[0]-o[0],o[1]-e[1]))),t}}();function rn(e,t,i){return Oi(e,t),e.scale=i,e}const an=function(){const e=(0,b.n)();return function(t,i,n,o,s,r){return Oi(t,i),isNaN(n)||0===n||(cn(e,s,i,r),t.scale=i.scale*n,t.rotation+=o,hn(e,e,t,r),un(t,t,(0,k.o)(e,e[0]-s[0],s[1]-e[1]))),t}}(),ln=function(){const e=(0,b.n)(),t=(0,b.n)();return function(i,n,o,s,r,a,l){return Hi(t,a,l),(0,k.u)(e,r,t),s?an(i,n,o,s,e,a):sn(i,n,o,e,a)}}(),cn=function(){const e=_i();return function(t,i,n,o){return(0,k.S)(t,i,Fi(e,n,o,1))}}(),hn=function(){const e=_i();return function(t,i,n,o){return(0,k.S)(t,i,Ki(e,n,o,1))}}(),un=function(){const e=(0,b.n)(),t=_i();return function(i,n,o){Oi(i,n);const s=Wi(n),r=i.targetGeometry;return(0,T.M)(t,Zi(n)),(0,T.f)(t,t,(0,b.r)(s,s)),(0,k.S)(e,o,t),r.x+=e[0],r.y+=e[1],i}}();function dn(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function pn(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function mn(e,t,i,n,o,s,r,a,l){const c=new Float32Array(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=n,c[4]=o,c[5]=s,c[6]=r,c[7]=a,c[8]=l,c}function gn(e,t){return new Float32Array(e,t,9)}function fn(e){return e instanceof Float32Array&&e.length>=2}function yn(e){return Array.isArray(e)&&e.length>=2}function vn(e){return fn(e)||yn(e)}var _n;Object.freeze(Object.defineProperty({__proto__:null,clone:pn,create:dn,createView:gn,fromValues:mn},Symbol.toStringTag,{value:"Module"}));const wn=[0,0];let bn=_n=class extends n.v{constructor(e){super(e),this._viewpoint2D={center:(0,b.n)(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new n.au,this.id=0,this.inverseTransform=_i(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=_i(),this.transformNoRotation=_i(),this.displayMat3=dn(),this.displayViewMat3=dn(),this.viewMat3=dn(),this.viewMat2d=(0,T.n)(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[e,t]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,t),this.toMap([0,0],e,t),this.toMap([0,0],e,0)]}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=Oi(i,e.viewpoint),this._set("size",(0,k.r)(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new _n({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return vn(t)?(0,k.S)(e,t,this.inverseTransform):(wn[0]=t,wn[1]=i,(0,k.S)(e,wn,this.inverseTransform))}toScreen(e,t,i){return vn(t)?(0,k.S)(e,t,this.transform):(wn[0]=t,wn[1]=i,(0,k.S)(e,wn,this.transform))}toScreenNoRotation(e,t,i){return vn(t)?(0,k.S)(e,t,this.transformNoRotation):(wn[0]=t,wn[1]=i,(0,k.S)(e,wn,this.transformNoRotation))}wrapMapCoordinate(e,t){(0,k.r)(e,t);const[i]=t,[n]=this.center,{extent:o,spatialReference:s}=this;let{xmin:r,xmax:a}=o;if(s.isWrappable){const e=Ji(s)/2;r=Math.max(r,n-e),a=Math.min(a,n+e)}return(i<r||i>a)&&(e[0]=(0,S.P)(i,n,s)),e}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size");return Bi(e,i,o,t,0,n),e}_update(){const{center:e,spatialReference:t,scale:i,rotation:o}=this._viewpoint2D,s=this._get("pixelRatio")||1,r=this._get("size"),a=new j({targetGeometry:new n.bv(e[0],e[1],t),scale:i,rotation:o});if(this._set("viewpoint",a),!r||!t||!i)return;this.resolution=Wi(a),this.rotation=o,this.scale=i,this.spatialReference=t,(0,k.r)(this.center,e);const l=0!==r[0]?2/r[0]:0,c=0!==r[1]?-2/r[1]:0;(0,P.r)(this.displayMat3,l,0,0,0,c,0,-1,1,1);const h=(0,P.o)(this.viewMat3),u=(0,x.t)(r[0]/2,r[1]/2),d=(0,x.t)(-r[0]/2,-r[1]/2),p=(0,M.u)(o);(0,P.M)(h,h,u),(0,P.h)(h,h,p),(0,P.M)(h,h,d),(0,P.i)(this.displayViewMat3,this.displayMat3,h);const m=(0,T.k)(this.viewMat2d,u);return(0,T.c)(m,m,p),(0,T.a)(m,m,d),Ni(this.extent,a,r),Ki(this.transform,a,r,s),(0,T.u)(this.inverseTransform,this.transform),$i(this.transformNoRotation,a,r,s),this.worldScreenWidth=Xi(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};(0,n.k)([(0,n.o)({readOnly:!0})],bn.prototype,"id",void 0),(0,n.k)([(0,n.o)({value:1,json:{write:!0}})],bn.prototype,"pixelRatio",null),(0,n.k)([(0,n.o)({json:{write:!0}})],bn.prototype,"size",null),(0,n.k)([(0,n.o)()],bn.prototype,"spatialReference",void 0),(0,n.k)([(0,n.o)({type:j,json:{write:!0}})],bn.prototype,"viewpoint",null),(0,n.k)([(0,n.o)({readOnly:!0})],bn.prototype,"visibleArea",null),bn=_n=(0,n.k)([(0,n.A)("esri.views.2d.ViewState")],bn);const kn=bn;var Mn,Tn;let Sn=Mn=class extends n.aD{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Mn({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};(0,n.k)([(0,n.o)()],Sn.prototype,"left",void 0),(0,n.k)([(0,n.o)()],Sn.prototype,"top",void 0),(0,n.k)([(0,n.o)()],Sn.prototype,"right",void 0),(0,n.k)([(0,n.o)()],Sn.prototype,"bottom",void 0),Sn=Mn=(0,n.k)([(0,n.A)("esri.views.2d.PaddedViewState.Padding")],Sn);let Pn=Tn=class extends kn{constructor(...e){super(...e),this.paddedViewState=new kn,this._updateContent=(()=>{const e=(0,b.n)();return()=>{const t=this._get("size"),i=this._get("padding");if(!t||!i)return;const n=this.paddedViewState;(0,k.o)(e,i.left+i.right,i.top+i.bottom),(0,k.e)(e,t,e),(0,k.r)(n.size,e);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles((0,n.aE)((()=>[this.size,this.padding]),(()=>this._updateContent()),n.az)),this.padding=new Sn,this.size=[0,0]}set padding(e){this._set("padding",e||new Sn)}set viewpoint(e){if(e){this.paddedViewState.viewpoint=e;let t=e;const i=this._get("padding");i&&(t=Qi(e.clone(),e,this._get("size"),i));const{targetGeometry:n,rotation:o,scale:s}=t,{x:r,y:a,spatialReference:l}=n,c=this._viewpoint2D;c.center[0]=r,c.center[1]=a,c.rotation=o,c.scale=s,c.spatialReference=l,this._update()}}clone(){return new Tn({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};(0,n.k)([(0,n.o)()],Pn.prototype,"paddedViewState",void 0),(0,n.k)([(0,n.o)({type:Sn})],Pn.prototype,"padding",null),(0,n.k)([(0,n.o)()],Pn.prototype,"viewpoint",null),Pn=Tn=(0,n.k)([(0,n.A)("esri.views.2d.PaddedViewState")],Pn);const xn=Pn;let Cn=class{constructor(e){this._view=e,this.viewpoint=new j({targetGeometry:new n.bv,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,t]=this._view.size;return Math.sqrt(e*e+t*t)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return Ui(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,t){t.pan=(0,n.ka)(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,t.rotate=(0,n.eI)(i),t.sourceZoom=this.scale,t.targetZoom=e.scale}interpolate(e,t,i){const{pan:o,rotate:s,zoom:r,zoomOffset:a}=i,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=(0,n.iK)(e.center.x,t.center.x,o),l.y=(0,n.iK)(e.center.y,t.center.y,o),this.viewpoint.scale=(0,n.iK)(e.scale,t.scale+a,r);let c=e.rotation;const h=t.rotation;Math.abs(h-c)>=180&&(c+=360*(c<h?1:-1)),this.viewpoint.rotation=(0,n.iK)(c,h,s)}copyFrom(e){Oi(this.viewpoint,e.viewpoint),this._view=e.view}};const En=e=>e*e,Rn=e=>1-En(1-e),In=e=>2**(10*(e-1)),An=e=>1-In(1-e);function Ln(e){const t=2*(e-Math.sqrt((e-1)*e)),i=t/2/e;return n=>n<i?e*n*n:t*n-t+1}function Dn(e,t){return(i,n)=>i<t?t*e(i/t,n):1-e((1-i)/(1-t),n)*(1-t)}const On=Dn(Ln(1),.5);let Vn=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Nn={desiredScreenFlow:2,minDuration:(0,n.cP)(500),maxDuration:(0,n.cP)(8e3)},zn={...Nn,maxDuration:(0,n.cP)(4e3)};let Fn=class e{constructor(e){this._createCamera=e,this.compared=new Vn,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Nn.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const t=new e(this._createCamera);return t.copyFrom(this),t}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,i){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Nn.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>(0,M.e)()}get hasFov(){return Math.abs(this.compared.fov)>(0,M.e)()}get hasRotate(){return this.compared.rotate>(0,M.e)()}},Hn=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Gn=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((e,t)=>(0,n.gJ)(e+t.time)),(0,n.gJ)(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,n=0;const o=this.definition,s=this.segments.reduce(((e,t)=>e||t.definition.hasZoom),!1);for(let r=0;r<this.segments.length;r++){const a=this.segments[r],l=a.definition;if(e<=a.time||r===this.segments.length-1){if(this.segmentInterpolateComponentsAt(a,0===a.time?0:e/a.time,t),o.hasPan&&!isNaN(t.pan)&&isFinite(o.compared.pan)?t.pan=(i+l.compared.pan*t.pan)/o.compared.pan:t.pan=1,o.hasRotate&&!isNaN(t.rotate)&&isFinite(o.compared.rotate)?t.rotate=(n+l.compared.rotate*t.rotate)/o.compared.rotate:t.rotate=1,s&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const{sourceZoom:e,targetZoom:i}=l.compared,n=t.zoom*(i-e)+e,o=this.segments[0].definition.compared.sourceZoom,s=this.segments[this.segments.length-1].definition.compared.targetZoom,r=Math.abs(i-o)>Math.abs(e-o)?i:e;t.zoomOffset=r-s,t.zoom=(n-o)/(r-o)}else t.zoom=1;return t}e-=a.time,i+=l.compared.pan,n+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i)}},Wn=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,i=t.sourceZoom,n=t.targetZoom;this._zoomSign=i>n?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(i);const o=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=t.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:i,hasPan:o,hasRotate:s}=this.definition;let r=0,a=0;i&&(o&&(r=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(a=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(i&&o&&s){const e=r+a+r*a;this._zoomPixelFlow=r*a/e*l,this._panPixelFlow=a/e*l,this._rotatePixelFlow=r/e*l}else if(i&&o){const e=1+r;this._zoomPixelFlow=r/e*l,this._panPixelFlow=1/e*l}else if(i&&s){const e=1+a;this._zoomPixelFlow=a/e*l,this._rotatePixelFlow=1/e*l}else if(o&&s){const e=this._panPixelsAtSource/this._rotatePixels,t=1+e;this._panPixelFlow=e/t*l,this._rotatePixelFlow=1/t*l}else o?this._panPixelFlow=l:i?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);if(this._time=(0,n.gJ)(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const e=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=e,this._panPixelFlow/=e,this._rotatePixelFlow/=e}}get rotateTime(){return this.definition.hasRotate?(0,n.gJ)(this._rotatePixels/this._rotatePixelFlow):(0,n.gJ)(0)}get zoomTime(){return this.definition.hasZoom?(0,n.gJ)(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):(0,n.gJ)(0)}get fovTime(){return this.definition.hasFov?(0,n.gJ)(Math.abs(this.definition.compared.fov)/Un):(0,n.gJ)(0)}get panTime(){if(!this.definition.hasPan)return(0,n.gJ)(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return(0,n.gJ)(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return(0,n.gJ)(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(0===e||1===e)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(t*(t/i)**-e-t)/(i-t)}return e}_interpolateComponentsFov(e){if(0===e)return this.definition.segmentStart;if(1===e)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:t,segmentEnd:i}=this.definition;return t+e*(i-t)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(0===e||1===e)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),t.zoom=this._interpolateComponentsZoom(e),t.pan=this._interpolateComponentsPan(e),t.rotate=this._interpolateComponentsRotate(e),t.zoomOffset=0,t.fov=this._interpolateComponentsFov(e)}};const Un=(0,n.eI)(45);function Zn(e,t,i){const n=t-e.compared.sourceZoom,o=e.halfWindowPanAtZoom(n);return-e.halfWindowSize*(i.ascensionFactor*Math.LN2*e.compared.pan+o)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*o)}function jn(e,t,i){const n=1/t,o=Math.log(e.compared.sourceZoom*n),s=1/e.desiredPixelFlow,r=1/Math.LN2,a=t-e.compared.sourceZoom,l=1/a,c=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(a))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*n*s*r*l*c-e.halfWindowSize*o*s*r*l+e.halfWindowSize*o*s*r*c/(a*a)}function qn(e,t,i){const n=t-e.compared.sourceZoom,o=1/n,s=1/t,r=Math.log(e.compared.sourceZoom*s),a=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(n))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*s*a+2*o*r+2*s-2*r*a/(n*n)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Bn(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)}function Kn(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function $n(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function Jn(e,t,i){return-e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))}function Xn(e,t,i){return e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))}function Yn(e,t,i){return-2*e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))}function Qn(e,t,i){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))}function eo(e,t,i){const n=Math.log(t/e.compared.targetZoom),o=1/e.desiredPixelFlow,s=1/Math.LN2,r=-t+e.compared.targetZoom,a=1/r,l=(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*n*o*s*a+e.halfWindowSize*n*o*s*l/(r*r)+e.halfWindowSize*o*s*a*l/t}function to(e,t,i){const n=t-e.compared.targetZoom,o=1/n,s=1/t,r=Math.log(t/e.compared.targetZoom),a=(e.halfWindowPanAtZoom(t)+i.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*s*a-2*o*r+2*s+2*r*a/(n*n)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)}function io(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)}function no(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function oo(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function so(e){const t=e.compared.sourceZoom-e.compared.targetZoom;if(0===t)return e.compared.pan*e.halfWindowSize/(e.desiredPixelFlow*e.halfWindowPanAtZoom(e.compared.sourceZoom));const i=Math.LN2*e.compared.pan,n=t,o=e.halfWindowPanAtZoom(n),s=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*o);return e.compared.sourceZoom<=e.compared.targetZoom?s*(i-o):s*(i+o)}function ro(e,t){let i=ao(e,t);const n={ascensionFactor:null!=t.ascensionFactor?t.ascensionFactor:.5,descensionFactor:null!=t.descensionFactor?t.descensionFactor:.5},o=0===n.ascensionFactor,s=0===n.descensionFactor,r=o?Bn:Zn,a=o?Kn:jn,l=o?$n:qn,c=s?io:Qn,h=s?no:eo,u=s?oo:to,d=t=>r(e,t,n)+Jn(e,t,n)+c(e,t,n),p=t=>a(e,t,n)+Xn(e,t,n)+h(e,t,n),m=t=>l(e,t,n)+Yn(e,t,n)+u(e,t,n);let g=d(i);const f=so(e);let y;const v=t.maximumIterations||20,_=null!=t.maximumDistance?t.maximumDistance:1/0;for(y=0;y<v;y++){const n=t.desiredSlope??1e-6;let o=p(i);Math.abs(o)>n&&(o+=n);const s=o/m(i);if(isNaN(s)||i>=_&&s<0){if(!isFinite(_))return null;i=_,g=d(i);break}if(i-=s,i<e.compared.sourceZoom||i<e.compared.targetZoom)return null;const r=d(i);if(Math.abs(r-g)/g<=.005)break;g=r}return g>.7*f||i<e.compared.sourceZoom||i<e.compared.targetZoom?null:i}function ao(e,t){const i=Math.max(e.compared.sourceZoom,e.compared.targetZoom),n=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return n<i?null!=t.maximumDistance?i+(t.maximumDistance-i)/2:1.5*i:t.maximumDistance?Math.min(t.maximumDistance,n):n}let lo=class extends Gn{constructor(e,t){super(),this._preallocSegments=[new Wn,new Wn,new Wn],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=t?.apex?ro(e,t.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,t?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i),e===this._ascensionSegment?i.zoom=Rn(i.zoom):e===this._descensionSegment&&(i.zoom=En(i.zoom))}_updateWithApex(e,t){const[i,n,o]=this._preallocSegments,s=t?.ascensionFactor??.5,r=Math.min(1-s,null!=t?.ascensionFactor&&null!=t.descensionFactor?t.descensionFactor:.5),a=1-s-r;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*s,i.definition.compared.rotate=this.definition.compared.rotate*s,i.definition.segmentEnd=s,i.update(),this._ascensionSegment=i,this.segments.push(i),a>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=i.definition.segmentEnd,n.definition.segmentEnd=i.definition.segmentEnd+a,n.update(),this.segments.push(n)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*r,o.definition.compared.rotate=this.definition.compared.rotate*r,o.definition.segmentStart=s+a,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const co=new Hn;let ho=class{get time(){return this._time}get isLinear(){return 1===this.path.segments.length}constructor(e){this._time=(0,n.cP)(0),this._easing=On,this.definition=new Fn(e),this.path=new lo}update(e,t,i){this.definition.update(e,t,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings((0,n.gI)(isFinite(this.path.time)?this.path.time:(0,n.gJ)(0)),i),this._easing=i.easing??(this._time>=1e3?On:An)}cameraAt(e,t){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,co);t.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const t=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(i-t)}_applyTimeSettings(e,t){const i=null!=t.speedFactor?t.speedFactor:1,o=t.minDuration??Nn.minDuration/i,s=t.maxDuration??Nn.maxDuration/i;return null!=t.duration?t.duration:(0,n.cP)(Math.min(Math.max(e/i,o),s))}};const uo=2e3,po=64;let mo=class{constructor(e){this._view=e,this._animation=new ho((()=>new Cn(this._view))),this._current=new Cn(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,t,i={}){Oi(this._current.viewpoint,e),Oi(this._source.viewpoint,e),Oi(this._target.viewpoint,t),this._animation.update(this._source,this._target,i)}applyRatio(e,t){this._animation.cameraAt(t,this._current),Oi(e,this._current.viewpoint)}},go=class extends n.aD{constructor(e){super(e),this._animation=null,this._destinationViewState=new xn,this.updateFunction=null,this.easing=C.t.ease,this.viewpoint=new j({targetGeometry:new n.bv,scale:0,rotation:0}),this._updateTask=(0,n.jl)({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new mo(e.view)}destroy(){this._updateTask=(0,n.aJ)(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,t,i){this.stop();const o=this.viewpoint;Oi(o,t);const s=("string"==typeof i?.easing?(0,C.r)(i.easing):i?.easing)||this.easing,r=e.target;this._transition.update(this.viewpoint,r,{apex:{maximumDistance:Math.min(Math.min(t.scale,r.scale)*po,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:"auto"===i?.animationMode?(0,n.cP)(1/0):i?.maxDuration??zn.maxDuration,speedFactor:i?.speedFactor,easing:"function"==typeof s?e=>s(e):void 0}),"auto"===i?.animationMode&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=r,fo(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,r,{duration:(0,n.cP)(0)}));const a=()=>{this.animation===e&&this._updateTask&&("finished"===e.state&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const i=new vi({target:e.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==vi.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const e=performance.now()-this._startTime,t=this._transition.duration,i=t>0?e/t:1,n=i>=1;this._transition.applyRatio(this.viewpoint,i),n&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function fo(e,t,i,o){if(null!=t?.duration)return!0;const{time:s,isLinear:r}=e,a=t?.speedFactor||1,l=t?.maxDuration??zn.maxDuration/a;if((0,n.a$)("esri-goto-debug")&&(console.log("speed factor:",a),console.log("adjusted duration:\t\t",s),console.log("adjusted max duration:\t",l),console.log("is linear:",r)),s>l)return(0,n.a$)("esri-goto-debug")&&console.warn(`failed "auto" heuristic: animations must be shorter than ${l/1e3}s`),!1;if(r){const e=(0,b.n)(),t=(0,n.eU)(...o.toScreen(e,...i.center)),r=(0,n.eU)(...i.toScreen(e,...o.center)),c=null!=r&&r.x>-1*i.size[0]&&r.x<2*i.size[0]&&r.y>-1*i.size[1]&&r.y<2*i.size[1],h=null!=t&&t.x>-1*o.size[0]&&t.x<2*o.size[0]&&t.y>-1*o.size[1]&&t.y<2*o.size[1];if((0,n.a$)("esri-goto-debug")&&(console.log("dest is within 1.5 screens at start view:",c),console.log("start is within 1.5 screens at dest view:",h)),s>uo/a&&!c&&!h)return(0,n.a$)("esri-goto-debug")&&console.warn(`failed "auto" heuristic: linear animations must be...\n  - shorter than ${uo/1e3/a}s, or\n  - shorter than ${l/1e3}s and the destination is close enough to the starting screen, or\n  - shorter than ${l/1e3}s and the start point is close enough to the destination screen`),!1}return!0}(0,n.k)([(0,n.o)()],go.prototype,"easing",void 0),(0,n.k)([(0,n.o)()],go.prototype,"view",void 0),(0,n.k)([(0,n.o)()],go.prototype,"viewpoint",void 0),go=(0,n.k)([(0,n.A)("esri.views.2d.AnimationManager")],go);const yo=go;let vo=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=(0,E.I)(),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),null==this.view.animation?.target||(0,n.aO)(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=e=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:t,graphicsView:i,labelManager:n,state:{id:o}}=this.view;t.forEach(this._updateLayerView,this),null!=n&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),null!=i&&(i.lastUpdateId!==o&&(i.viewChange(),i.lastUpdateId=o),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=E.a.ANIMATING:this.view.interacting?this._scheduler.state=E.a.INTERACTING:this._scheduler.state=E.a.IDLE,this._scheduler.updateBudget(e)&&this._scheduler.frame()}}destroy(){this.stop(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new xn,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=(0,n.aE)((()=>e.stationary),(e=>{this.stationary=e,this.requestFrame()})),this._frameTaskHandle=(0,n.jl)(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const t=this.view.state,i=e.lastUpdateId;null!=i&&(this.stationary||e.moving)||(e.moving=!0),i!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}},_o=class extends n.aD{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,t){if(!e)return void n.n.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new vi;this.view.animation=i,await(0,n.f2)((()=>this.view.ready),t);const o={...t,animate:t?.animate??!qt(),animationMode:t?.animationMode??"auto"},{extent:s,spatialReference:r,size:a,viewpoint:l,constraints:c,padding:h,allLayerViews:u}=this.view,d=Di(e,{extent:s,spatialReference:r,size:a,viewpoint:l,constraints:c,padding:h,allLayerViews:u,pickClosestTarget:t?.pickClosestTarget??!0});return i?.update(d),this._gotoTask={},o.animate?this._gotoAnimated(d,o):this._gotoImmediate(d,o)}_gotoImmediate(e,t){const i=this._gotoTask,o=this.view.animation,s=e.then((e=>{if((0,n.D)(t),i!==this._gotoTask)throw new n.s("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=o.target=e,o.finish()}));return this._cancellableGoTo(i,o,s,t)}_gotoAnimated(e,t){const i=this._gotoTask,o=this.view.animation;if(!o)return Promise.resolve();const s=e.then((e=>{if((0,n.D)(t),i!==this._gotoTask)throw new n.s("view:goto-interrupted","Goto was interrupted");return o.update(e),this.view.animationManager.animate(o,this.view.viewpoint,t),o.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,o,s,t)}_cancellableGoTo(e,t,i,o){const s=()=>e===this._gotoTask;return(0,n.bu)(i,o).finally((()=>{s()&&(t.done||t.stop())}))}};function wo(){return Promise.all([Promise.all([i.e(2753),i.e(7800)]).then(i.bind(i,47800)),Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(2137),i.e(4831),i.e(238),i.e(655),i.e(2309)]).then(i.bind(i,12309))])}(0,n.k)([(0,n.o)({constructOnly:!0})],_o.prototype,"view",void 0),_o=(0,n.k)([(0,n.A)("esri.views.2d.GoToManager")],_o);const bo=()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(2137),i.e(4831),i.e(4435),i.e(1714),i.e(8990)]).then(i.bind(i,38990)))),ko=()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(1110),i.e(7032),i.e(8631),i.e(6260),i.e(474)]).then(i.bind(i,40474)).then((e=>e.F)))),Mo={"base-dynamic":()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(3650),i.e(1635)]).then(i.bind(i,57194)))),"base-tile":bo,"bing-maps":bo,catalog:()=>wo().then((()=>Promise.all([i.e(2614),i.e(832)]).then(i.bind(i,40832)))),"catalog-dynamic-group":()=>wo().then((()=>Promise.all([i.e(2614),i.e(2648)]).then(i.bind(i,12648)))),"catalog-footprint":()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(1110),i.e(7032),i.e(8631),i.e(6260),i.e(474),i.e(2643)]).then(i.bind(i,32643)))),csv:ko,"geo-rss":()=>wo().then((()=>Promise.all([i.e(3313),i.e(136),i.e(7509),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(9739)]).then(i.bind(i,96973)))),feature:ko,geojson:ko,parquet:ko,graphics:()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(6260),i.e(3410)]).then(i.bind(i,72894)))),group:()=>wo().then((()=>Promise.all([i.e(2614),i.e(3983)]).then(i.bind(i,63983)))),imagery:()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(879),i.e(3650),i.e(1714),i.e(4925),i.e(9798)]).then(i.bind(i,99798)))),"imagery-tile":()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(879),i.e(4925),i.e(3182)]).then(i.bind(i,75180)))),kml:()=>wo().then((()=>Promise.all([i.e(3313),i.e(136),i.e(7509),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(238),i.e(7440)]).then(i.bind(i,76441)))),"knowledge-graph":()=>wo().then((()=>Promise.all([i.e(2614),i.e(429)]).then(i.bind(i,40429)))),"link-chart":()=>wo().then((()=>Promise.all([i.e(2614),i.e(429)]).then(i.bind(i,40429)))),"knowledge-graph-sublayer":ko,"map-image":()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(3650),i.e(4435),i.e(1714),i.e(7806)]).then(i.bind(i,97806)))),"map-notes":()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(1366)]).then(i.bind(i,95682)))),media:()=>wo().then((()=>Promise.all([i.e(3313),i.e(136),i.e(7509),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(2137),i.e(4831),i.e(909)]).then(i.bind(i,53539)))),"ogc-feature":()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(1110),i.e(7032),i.e(8631),i.e(6260),i.e(474),i.e(6317)]).then(i.bind(i,56317)))),"open-street-map":bo,"oriented-imagery":ko,route:()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(8848),i.e(2519)]).then(i.bind(i,2239)))),stream:()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(1110),i.e(7032),i.e(8631),i.e(6260),i.e(474),i.e(2707)]).then(i.bind(i,12707)))),"subtype-group":()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(1110),i.e(7032),i.e(8631),i.e(6260),i.e(474),i.e(4197)]).then(i.bind(i,14197)))),tile:bo,"vector-tile":()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6964),i.e(3210)]).then(i.bind(i,93210)))),video:()=>wo().then((()=>Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(6408)]).then(i.bind(i,78224)))),wcs:()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(879),i.e(4925),i.e(3182)]).then(i.bind(i,75180)))),"web-tile":bo,wfs:ko,wms:()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(3650),i.e(4849)]).then(i.bind(i,78877)))),wmts:()=>wo().then((()=>Promise.all([i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(8046)]).then(i.bind(i,69308)))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,focusArea:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function To(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new n.s(`${i}:view-not-supported`,`${t} is not supported in 2D`)}const So={hasLayerViewModule:e=>null!=Mo[e.type],importLayerView:e=>{const t=Mo[e.type];if(null==t)throw To(e);return t(e)}};function Po(e,t){const{spatialReference:i}=t,o=[t.x,t.y];let s=Number.POSITIVE_INFINITY,r=0,a=0;const l=[0,0],c="extent"===e.type?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(const h of c)for(let e=0;e<h.length-1;e++){(0,n.kb)(l,o,h,e);const t=(0,k.m)(o,l);t<s&&(s=t,r=l[0],a=l[1])}return{coordinate:new n.bv({x:r,y:a,spatialReference:i}),distance:s}}var xo;let Co=xo=class extends((0,n.i6)(n.aD)){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(null==this.geometry||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return(0,a.K)(this.geometry,this.spatialReference)}catch(e){return n.n.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(null==this.normalizedGeometry)return e;const i=e.targetGeometry;if("extent"===this.normalizedGeometry.type?(0,n.h7)(this.normalizedGeometry,i):(0,n.kc)(this.normalizedGeometry,i))return e;const{coordinate:o}=Po(this.normalizedGeometry,i);return o&&(e.targetGeometry=o),e}clone(){return new xo({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};var Eo;(0,n.k)([(0,n.o)({constructOnly:!0})],Co.prototype,"geometry",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Co.prototype,"normalizedGeometry",null),(0,n.k)([(0,n.o)({constructOnly:!0})],Co.prototype,"spatialReference",void 0),Co=xo=(0,n.k)([(0,n.A)("esri.views.2d.constraints.GeometryConstraint")],Co);let Ro=Eo=class extends((0,n.i6)(n.aD)){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new Eo({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};(0,n.k)([(0,n.o)()],Ro.prototype,"enabled",void 0),(0,n.k)([(0,n.o)()],Ro.prototype,"rotationEnabled",void 0),Ro=Eo=(0,n.k)([(0,n.A)("esri.views.2d.constraints.RotationConstraint")],Ro);const Io=Ro;var Ao;let Lo=Ao=class extends((0,n.i6)(n.aD)){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:n,minZoom:o,maxZoom:s}=this,r=-1,a=-1,l=!1,c=!1;if(0!==i&&0!==n&&i<n&&([i,n]=[n,i]),!t?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const h of t)!l&&i>0&&i>=h.scale&&(r=h.level,l=!0),!c&&n>0&&n>=h.scale&&(a=e?e.level:-1,c=!0),e=h;-1===o&&(o=0===i?0:r),-1===s&&(s=0===n?t.length-1:a),o=Math.max(o,0),o=Math.min(o,t.length-1),s=Math.max(s,0),s=Math.min(s,t.length-1),o>s&&([o,s]=[s,o]),i=t[o].scale,n=t[s].scale,t.splice(0,o),t.splice(s-o+1,t.length),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",o),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,n=this.effectiveMaxScale,o=e.targetGeometry,s=t&&t.targetGeometry,r=0!==n&&e.scale<n,a=0!==i&&e.scale>i;if(r||a){const r=a?i:n;if(t&&s){const i=(r-t.scale)/(e.scale-t.scale);o.x=s.x+(o.x-s.x)*i,o.y=s.y+(o.y-s.y)*i}e.scale=r}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.floor(e),n=Math.ceil(e);return t[i]+(e-i)*(t[n]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,n;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let o=0;o<t.length-1;o++){if(i=t[o],n=t[o+1],n===e)return o+this.effectiveMinZoom+1;if(i>e&&n<e)return o+this.effectiveMinZoom+1-(e-n)/(i-n)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new Ao({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t),this._scales[0])),this._lodByScale[e].scale}};(0,n.k)([(0,n.o)({readOnly:!0})],Lo.prototype,"effectiveLODs",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Lo.prototype,"effectiveMinZoom",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Lo.prototype,"effectiveMaxZoom",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Lo.prototype,"effectiveMinScale",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Lo.prototype,"effectiveMaxScale",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"lods",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"minZoom",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"maxZoom",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"minScale",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"maxScale",void 0),(0,n.k)([(0,n.o)()],Lo.prototype,"snapToZoom",void 0),Lo=Ao=(0,n.k)([(0,n.A)("esri.views.2d.constraints.ZoomConstraint")],Lo);const Do=Lo,Oo={base:null,key:"type",typeMap:{extent:n.au,polygon:n.bC}};let Vo=class extends n.aD{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new n.V}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Co({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new Io({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,n=this.maxZoom,o=this.minScale,s=this.maxScale,r=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===n&&e.minScale===o&&e.maxScale===s&&e.snapToZoom===r?e:new Do({lods:t,minZoom:i,maxZoom:n,minScale:o,maxScale:s,snapToZoom:r})}canZoomInTo(e){const t=this.effectiveMaxScale;return 0===t||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return 0===t||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),this.customConstraints.forEach((i=>i.constrain(e,t))),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach((t=>t.applyPanConstraint?.(e))),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"effectiveLODs",null),(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"effectiveMinScale",null),(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"effectiveMaxScale",null),(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"effectiveMinZoom",null),(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"effectiveMaxZoom",null),(0,n.k)([(0,n.o)({types:Oo,value:null})],Vo.prototype,"geometry",null),(0,n.k)([(0,n.o)({type:[l.p]})],Vo.prototype,"lods",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"minScale",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"maxScale",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"minZoom",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"maxZoom",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"rotationEnabled",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"snapToZoom",void 0),(0,n.k)([(0,n.o)({type:n.V})],Vo.prototype,"customConstraints",void 0),(0,n.k)([(0,n.o)()],Vo.prototype,"view",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Vo.prototype,"version",null),(0,n.k)([(0,n.o)({type:Co,readOnly:!0})],Vo.prototype,"_geometry",null),(0,n.k)([(0,n.o)({type:Io})],Vo.prototype,"_rotation",null),(0,n.k)([(0,n.o)({readOnly:!0,type:Do})],Vo.prototype,"_zoom",null),Vo=(0,n.k)([(0,n.A)("esri.views.2d.MapViewConstraints")],Vo);const No=Vo;let zo=class extends n.aD{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([(0,n.aE)((()=>this.constraints?.version),(e=>{this.constraints&&e&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),n.az)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return this.state.commitProperty("id"),new n.bv({x:e[0],y:e[1],spatialReference:t})}set center(e){if(null==e)return;if(!this.ready)return void this._set("center",e);let t;try{t=this._project(e,this.state.spatialReference)}catch(o){return void n.n.getLogger(this).error(new n.s("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:o}))}const i=this.viewpoint;en(i,i,t),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(null==e)return;if(!e.width||!e.height)return void n.n.getLogger(this).error(new n.s("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let t;try{t=this._project(e,this.state.spatialReference)}catch(o){return void n.n.getLogger(this).error(new n.s("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:o}))}const i=this.viewpoint;zi(i,i,t,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;on(t,t,e),this.viewpoint=t}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.viewpoint;rn(t,t,e),this.viewpoint=t}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(null==e)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let t,i;try{t=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new n.s("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):null==e.targetGeometry&&(i=new n.s("mapview:invalid-viewpoint","geometry not defined"))}catch(s){i=new n.s("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(i)return void n.n.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const o=new j({targetGeometry:new n.bv,scale:0,rotation:0});Oi(o,t),this.constraints?.constrain(o,this.state.paddedViewState.viewpoint),this.state.viewpoint=o,this._set("viewpoint",o)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.constraints?.zoomToScale(e)??0;if(!t)return void this._set("zoom",-1);const i=this.viewpoint;rn(i,i,t),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:t,constraints:i}=this,n=this._get("center"),o=this._get("extent"),s=this._get("scale"),r=this._get("rotation"),a=this._get("viewpoint"),l=this._get("zoom"),c=null!=l&&null!=i&&i.zoomToScale(l)||void 0;let h,u,d;const p=a?.rotation,m=a?.targetGeometry;"extent"===m?.type?h=m:"point"===m?.type&&(u=m,d=a?.scale);const g=o??h;return{center:n??u??g?.center,rotation:r??p,scale:(s??c??d??(g&&Ri(g,[e[0]-t.left-t.right,e[1]-t.top-t.bottom])))||void 0}}startup(e,t,i,o){const s=e.targetGeometry;try{this._project(e,i)}catch(r){n.n.getLogger(this).warn(new n.z("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:i,error:r})),e.targetGeometry=o||new n.bv({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new xn({padding:this.padding,size:t,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,t],spatialReference:i,rotation:o,scale:s}=this.state.paddedViewState,r=new n.bv({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",o),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){const t=this.state.paddedViewState.clone();if(null==this._scaleBeforeChangingSpatialReference)this._scaleBeforeChangingSpatialReference=t.scale;else{const e=t.viewpoint.clone();e.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=e}const i=t.clone(),[o,s]=t.center;let r=null;try{r=this._project(new n.bv({x:o,y:s,spatialReference:t.spatialReference}),e)}catch(l){(0,n.gN)()||n.n.getLogger(this).warn(new n.z("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:r?.toJSON(),spatialReference:e,error:l}))}r||(r=new n.bv({x:0,y:0,spatialReference:e}));const a=en(new j({targetGeometry:new n.bv,scale:0,rotation:0}),t.viewpoint,r);i.viewpoint=a;try{const o=[t.size[0]/2,t.size[1]/2],s=[o[0]+20,o[1]],r=t.toMap([0,0],s),{x:l,y:c}=this._project(new n.bv({x:r[0],y:r[1],spatialReference:t.spatialReference}),e);r[0]=l,r[1]=c,i.toScreen(r,r);const h=Yi(o,r,s),u=Math.hypot(r[0]-o[0],r[1]-o[1])/20;!Number.isFinite(u)||Math.abs(u)>4?(a.rotation=0,a.targetGeometry=new n.bv({x:0,y:0,spatialReference:e})):(a.scale*=u,a.scale>(0,n.a$)("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(h)?h:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,t){if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();i.size=[e,t],tn(n,n,o,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints?.constrain(n,void 0)??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const t=[0,0],[i,o]=this.state.toMap(t,[e.x,e.y]),s=this.state.spatialReference;return new n.bv({x:i,y:o,spatialReference:s})}toScreen(e,t){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),o=[i.x,i.y];return!1===t?.pickClosestTarget||this.state.paddedViewState.wrapMapCoordinate(o,o),this.state.toScreen(o,o),(0,n.eU)(o[0],o[1])}_project(e,t){const i=e?.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||(0,n.bh)(t,i.spatialReference))return e;const o=(0,a.K)(i,t);if(!o)throw new n.s("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return Fo(e)?(e.targetGeometry=o,e):o}};function Fo(e){return"esri.Viewpoint"===e?.declaredClass}function Ho(e,t){switch(t){case"primary":return"touch"===e.pointerType||0===e.button;case"secondary":return"touch"!==e.pointerType&&2===e.button;case"tertiary":return"touch"!==e.pointerType&&1===e.button}}(0,n.k)([(0,n.o)({type:n.bv})],zo.prototype,"center",null),(0,n.k)([(0,n.o)()],zo.prototype,"constraints",void 0),(0,n.k)([(0,n.o)({type:n.au})],zo.prototype,"extent",null),(0,n.k)([(0,n.o)({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],zo.prototype,"padding",null),(0,n.k)([(0,n.o)()],zo.prototype,"ready",void 0),(0,n.k)([(0,n.o)()],zo.prototype,"resizeAlign",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],zo.prototype,"resolution",null),(0,n.k)([(0,n.o)({type:Number})],zo.prototype,"rotation",null),(0,n.k)([(0,n.o)({type:Number})],zo.prototype,"scale",null),(0,n.k)([(0,n.o)({readOnly:!0})],zo.prototype,"state",void 0),(0,n.k)([(0,n.o)({type:j})],zo.prototype,"viewpoint",null),(0,n.k)([(0,n.o)({readOnly:!0})],zo.prototype,"visibleArea",null),(0,n.k)([(0,n.o)()],zo.prototype,"zoom",null),zo=(0,n.k)([(0,n.A)("esri.views.2d.ViewStateManager")],zo);let Go=class extends pe{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,(e=>this._handleDoubleClick(e,t)))}_handleDoubleClick(e,t){Ho(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Wo=class extends pe{constructor(e,t,i){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",i,(e=>this._handleDoubleTapDrag(e)))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:i}=t;if(i!==this.pointerType)return;e.stopPropagation();const{action:n,delta:o}=t,{view:s}=this,{mapViewNavigation:r}=s;switch(n){case"begin":{const{scale:e}=s;this._startScale=e,this._currentScale=e,this._previousDelta=o,r.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const e=1.015**o.y,t=this._startScale*e,i=t/this._currentScale;r.setViewpointImmediate(i),this._currentScale=t;break}case"end":{const{constraints:e}=s,{effectiveLODs:t,snapToZoom:i}=e;if(!i||!t)return void r.end();const n=e.snapScale(this._currentScale),a=(o.y>0?Math.max(n,e.snapToPreviousScale(this._startScale)):Math.min(n,e.snapToNextScale(this._startScale)))/this._currentScale;r.zoom(a).then((()=>{r.end()}));break}}}},Uo=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,i=t.pointers.size;switch(t.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Zo=class extends pe{constructor(e,t,i){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",i,(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Uo({start:(e,t)=>{this.view.mapViewNavigation.pan.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{this.view.mapViewNavigation.pan.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{this.view.mapViewNavigation.pan.end(this.view,t.data),t.stopPropagation()},condition:(e,t)=>1===e&&Ho(t.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},jo=class extends pe{constructor(e,t,i){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Uo({start:(e,t)=>{n.rotate.begin(this._view,t.data),t.stopPropagation()},update:(e,t)=>{n.rotate.update(this._view,t.data),t.stopPropagation()},end:(e,t)=>{n.rotate.end(),t.stopPropagation()},condition:(e,t)=>1===e&&Ho(t.data,this.pointerAction)}),this.registerIncoming("drag",i,(e=>this._dragEventSeparator.handle(e)))}};function qo(e){let t=e*e;return e<0&&(t*=-1),t}function Bo(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function Ko(e,t,i){const n=i,o=e.state,s=e.device,r="forward-down"===t.tiltDirection?1:-1,a=1;return"standard"===s.deviceType?(n.translation[0]=qo(o.axes[0]),n.translation[1]=qo(o.axes[1]),n.translation[2]=qo(o.buttons[7])-qo(o.buttons[6]),n.heading=qo(o.axes[2]),n.tilt=qo(o.axes[3])):"spacemouse"===s.deviceType&&(n.translation[0]=1.2*qo(o.axes[0]),n.translation[1]=1.2*qo(o.axes[1]),n.translation[2]=2*-qo(o.axes[2]),n.heading=1.2*qo(o.axes[5]),n.tilt=1.2*qo(o.axes[3])),n.tilt*=r,(0,I.g)(n.translation,n.translation,a),n}function $o(e){return 0===e.translation[0]&&0===e.translation[1]&&0===e.translation[2]&&0===e.heading&&0===e.tilt&&0===e.zoom}let Jo=class extends pe{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new n.eS,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(e=>this._handleGamePadEvent(e))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([(0,n.aE)((()=>this._view.navigation.gamepad?.enabled),(e=>{e?(this._handle.resume(),this._frameTask||(this._frameTask=(0,n.jl)({update:e=>this._frameUpdate(e.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),n.cR)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||("end"===e.data.action?(this._currentDevice=null,Bo(this._transformation)):(this._currentDevice=e.data.device,Ko(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if($o(t))return;const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=Yo*n*e;un(i,i,[t.translation[0]*o,-t.translation[1]*o]);const s=1+t.translation[2]*Qo*e,r=this._view.constraints.rotationEnabled?-t.heading*Xo*e:0,a=this._view.size,l=[a[0]/2,a[1]];an(i,i,s,r,l,a);const c=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=c}};const Xo=.06,Yo=.7,Qo=6e-4;function es(e){const t=()=>e("visible"===document.visibilityState);return document.addEventListener("visibilitychange",t),(0,n.aH)((()=>document.removeEventListener("visibilitychange",t)))}let ts=class extends pe{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=e=>{const t=this._keyMap[e.data.key];if(e.modifiers.has("Meta")||e.modifiers.has("Control"))return void this._stopMovement();if(null==t)return;e.stopPropagation(),e.preventDefault();const i="key-down"===e.type;if(this._pressedKeys[i?"add":"delete"](t),i){if(this._direction===t)return;this._direction=t,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const e=void 0===this._timeout,t=this._pressedKeys.size>0;e||t?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),null==this._direction&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=es((e=>e?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const t=null!=this._currentDirection;if(null!=e){if(t||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else t&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=void 0===e?void 0:setTimeout((()=>{this._timeout=void 0,e()}),this._stickyKeyDuration)}},is=class extends pe{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",i,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",i,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",i,(()=>this._handleStop())),this._visibilityHandle=es((e=>e?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=null!=n,this._pressed){if(e.preventDefault(),t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var ns;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(ns||(ns={}));let os=class extends pe{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",i,(e=>this._handleKeyDown(e))),t.zoomIn.forEach((e=>this._keysToZoomAction[e]=ns.IN)),t.zoomOut.forEach((e=>this._keysToZoomAction[e]=ns.OUT))}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:o}=this.view;let s=null;switch(n){case ns.IN:s=o.zoomIn();break;case ns.OUT:s=o.zoomOut();break;default:return}o.begin(),s.then((()=>o.end())),e.stopPropagation()}};const ss=.6;let rs=class extends pe{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:i,y:n,deltaY:o}=e.data,s=1/ss**(1/60*o),r=t.zoom(s,[i,n]);r&&(this._canZoom=!1,r.catch((()=>{})).then((()=>{this._canZoom=!0,t.end()})))}},as=class extends pe{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const t=this.view.mapViewNavigation;this._dragEventSeparator=new Uo({start:(e,i)=>{t.pinch.begin(this.view,i.data),i.stopPropagation()},update:(e,i)=>{t.pinch.update(this.view,i.data),i.stopPropagation()},end:(e,i)=>{t.pinch.end(this.view),i.stopPropagation()},condition:e=>e>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function ls(e){const t=e.native;return t?{buttons:t.buttons.map((e=>e.pressed?e.value||1:0)),axes:t.axes.map((t=>us(t,e.axisThreshold)))}:{buttons:[],axes:[]}}function cs(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}function hs(e){for(let t=0;t<e.axes.length;t++)if(0!==e.axes[t])return!1;for(let t=0;t<e.buttons.length;t++)if(0!==e.buttons[t])return!1;return!0}function us(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}let ds=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=e=>{this._connectGamepad(e.gamepad)},this._onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this._inputDevices[i];n&&(this._emitGamepadEvent(t,ls(n),!1),this._inputDevices.splice(i,1),this._latestUpdate.splice(i,1),this._input.gamepad.devices.remove(n),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(ms((e=>this._connectGamepad(e))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Ft(e);"unknown"!==t.deviceType&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this._frameTask&&(this._frameTask=(0,n.jl)({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!e||"view"===this._input.gamepad.enabledFocusMode&&!t;ms((e=>{const t=this._inputDevices[e.index];if(!t)return;const n=this._latestUpdate[e.index],o=ls(t),s=i||hs(o);n&&(n.timestamp===e.timestamp||!n.active&&s||cs(n.state,o))||this._emitGamepadEvent(e,o,!s)}))}_emitGamepadEvent(e,t,i){const n=this._latestUpdate[e.index],o=n&&n.active;if(!o&&!i)return;const s=!o&&i?"start":o&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:s})}};function ps(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}function ms(e){for(const t of navigator.getGamepads())ps(t)&&e(t)}const gs=(0,n.a$)("edge"),fs=(0,n.a$)("chrome"),ys=(0,n.a$)("ff"),vs=(0,n.a$)("safari"),_s="esri-view-surface",ws={touchNone:`${_s}--touch-none`,touchPan:`${_s}--touch-pan`};let bs=class e{constructor(e,t){this._input=t,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new ds(e,this._input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e)})),this._gamepadSource=(0,n.C)(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(ks[t],e),delete this._active[t]}e&&e.forEach((e=>{if(!this._active[e]&&ks[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(ks[e],t),this._active[e]=t}})),this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1}setPointerCapture(e,t){t?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?ws.touchNone:ws.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?ws.touchPan:ws.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(ws.touchNone),this._element.classList.remove(ws.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(t,i){const n=Tt(this._element,t);return e.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,t){const{key:i}=t;i&&"key-up"===e&&this._keyDownState.delete(i);const n={native:t,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&(0,n.a$)("mac")&&0===e.deltaY?e.deltaX:e.deltaY}_handleMouseWheel(e,t){let i=this._getDeltaFromTrackpadOrMouseWheel(t);switch(t.deltaMode){case 0:gs&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}gs?i*=.7:fs||vs?i*=.6:ys&&(i*=1.375);const n=100,o=Math.abs(i);o>n&&(i=i/o*200/(1+Math.exp(-.02*(o-n))));const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:i});this._callback(e,s)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const i={native:t};t.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};bs.test={disableSubpixelCoordinates:!1};const ks={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Ms=class extends pe{constructor(){super(!0),this.registerIncoming("context-menu",(e=>e.data.native.preventDefault()))}};const Ts={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Ss(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function Ps(e,t){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}function xs(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:(0,n.eU)()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){const[i,n]=e,[o,s]=[n.x-i.x,n.y-i.y];return t.radius=Math.sqrt(o*o+s*s)/2,t.center.x=(i.x+n.x)/2,t.center.y=(i.y+n.y)/2,t}let i=0,o=0;for(let n=0;n<e.length;n++)i+=e[n].x,o+=e[n].y;i/=e.length,o/=e.length;const s=e.map((e=>e.x-i)),r=e.map((e=>e.y-o));let a=0,l=0,c=0,h=0,u=0,d=0,p=0;for(let n=0;n<s.length;n++){const e=s[n],t=r[n],i=e*e,o=t*t;a+=i,l+=o,c+=e*t,h+=i*e,u+=o*t,d+=e*o,p+=t*i}const m=.5*(h+d),g=.5*(u+p),f=a*l-c*c,y=(m*l-g*c)/f,v=(a*g-c*m)/f,_=(0,n.eU)(y+i,v+o);return{radius:Math.sqrt(y*y+v*v+(a+l)/e.length),center:_}}function Cs(e){const{native:t}=e,{pointerId:i,button:n,pointerType:o}=t;return"mouse"===o?`${i}:${n}`:`${o}`}let Es=class extends pe{constructor(e=Ts.maximumDoubleClickDelay,t=Ts.maximumDoubleClickDistance,i=Ts.maximumDoubleTouchDelay,o=Ts.maximumDoubleTouchDistance,s=n.k8){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=o,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=(0,n.eU)(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Uo({start:(e,t)=>this._dragStart(e,t),update:(e,t)=>this._dragUpdate(t),end:(e,t)=>this._dragEnd(t)}),this.registerIncoming("drag",(e=>this._dragEventSeparator.handle(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((e=>{e.doubleTapTimeout=(0,n.aJ)(e.doubleTapTimeout)}))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleTapTimeout)return!0;return!1}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=(0,n.aJ)(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,t){if(!this._doubleTapDragReady||1!==e)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:o}=t,{center:s}=i;this._dragStartCenter=s;const r=Rs("begin",(0,n.eU)(0,0),i);this._doubleTapDrag.emit(r,void 0,o),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:o}=t,s=Rs("update",(0,n.eU)(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(s,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:o}=t,s=Rs("end",(0,n.eU)(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(s,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,i=Cs(t),n=this._pointerState.get(i),{pointerType:o}=t.native;if(n){const s="touch"===o?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),Ss(n.event.data,t)>s?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:i}=t.native,n=Cs(t),o="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout((()=>this._clearPointerDown(n)),o);this._pointerState.set(n,{event:e,doubleTapTimeout:s}),this.refreshHasPendingInputs()}};function Rs(e,t,i){const{button:n,buttons:o,pointer:s,pointers:r,pointerType:a,timestamp:l}=i;return{action:e,delta:t,button:n,buttons:o,pointer:s,pointers:r,pointerType:a,timestamp:l}}let Is=class extends pe{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,i,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:Ds(this._activePointerMap),pointer:t,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const t=e.native.pointerId,i=Ls(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const o=Os(n,As(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(i)}_updatePointer(e){if(e&&null==e.x&&null==e.y)return;const t=e.native.pointerId,i=this._activePointerMap.get(t);i?i.event=e:this._addPointer(e)}_removePointer(e){const t=Ls(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=Ls(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=Os(i,t)-e,i.lastAngle=Os(i,t)-e}))}_emitEvent(e,t,i){const n=Ls(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,i=(0,n.cP)(e.timestamp);this._activePointerMap.get(t)&&(1===this._activePointerMap.size?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,(0,n.cP)(e.timestamp))))}_handlePointerDrag(e){const t=e.data,i=t.currentEvent,o=(0,n.cP)(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,o)):(this._addPointer(i),this._emitEvent("added",i,o),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,o))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}};function As(e){const t=[];return e.forEach((e=>{t.push((0,n.eU)(e.event.x,e.event.y))})),xs(t)}function Ls(e){const t=As(e);let i=0;return e.forEach((e=>{let n=Os(e,t),o=n-e.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=e.lastAngle+o,e.lastAngle=n;const s=n-e.initialAngle;i+=s})),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function Ds(e){const t=new Map;return e.forEach(((e,i)=>t.set(i,e.event))),t}function Os(e,t){const i=e.event,n=i.x-t.center.x,o=i.y-t.center.y;return Math.atan2(o,n)}var Vs;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(Vs||(Vs={}));let Ns=class extends pe{constructor(e=Ts.maximumDoubleClickDelay,t=Ts.maximumDoubleClickDistance,i=Ts.maximumDoubleTouchDelay,o=Ts.maximumDoubleTouchDistance,s=n.k8){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=o,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=Cs(t);if(!this._pointerState.has(i)){const e={downButton:t.native.button,x:t.x,y:t.y,immediateDoubleClick:null};this._pointerState.set(i,e),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,i=Cs(t),n=this._pointerState.get(i);if(n&&n.downButton===t.native.button){const i=n.immediateDoubleClick,o="touch"===e.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;i?(i.timeoutHandle.remove(),Ss(i,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,i.modifiers),this._removeState(t))):Ss(n,e.data)>o?this._removeState(t):this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const i="touch"===e.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),i)}}_removeState(e){const t=Cs(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},zs=class extends pe{constructor(e=Ts.maximumClickDelay,t=Ts.movementUntilMouseDrag,i=Ts.movementUntilPenDrag,o=Ts.movementUntilTouchDrag,s=Ts.holdDelay,r=n.k8){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=o,this._holdDelay=s,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(e=>this._handlePointerLoss(e,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(e=>this._handlePointerLoss(e,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(e=>this._handlePointerLoss(e,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(e=>this._handlePointerMove(e))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{e.holdTimeout=(0,n.aJ)(e.holdTimeout)})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=t.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const t=this._pointerState.get(i);if(t){if(!t.isDragging){const i=t.previousEvent;this._pointerHold.emit(i,void 0,e.modifiers),t.holdEmitted=!0}t.holdTimeout=null}}),this._holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const t=e.data,i=t.native.pointerId,n=this._pointerState.get(i);n&&(n.isDragging?this._pointerDrag.emit(Fs("update",n,t),void 0,n.modifiers):Ps(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,i=t.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(Fs("start",n,t)):this._pointerDrag.emit(Fs("start",n,n.previousEvent),e.timestamp))}))}_handlePointerLoss(e,t){const i=e.data,n=i.native.pointerId,o=this._pointerState.get(n);o&&(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(Fs("end",o,"pointer-up"===t?i:o.previousEvent),void 0,o.modifiers):"pointer-up"===t&&o.downButton===i.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}};function Fs(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}let Hs=class extends pe{constructor(e=Ts.maximumDoubleClickDelay,t=Ts.maximumDoubleClickDistance,i=Ts.maximumDoubleTouchDelay,o=Ts.maximumDoubleTouchDistance,s=n.k8){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=o,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(e=>this._handleImmediateClick(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e)))}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimer=(0,n.aJ)(e.doubleClickTimer)))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleClickTimer)return!0;return!1}_clearDoubleClickTimer(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=(0,n.aJ)(i.doubleClickTimer),t&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const t=e.data,{pointerType:i}=t.native,n=Gs(t);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:s,modifiers:r}=o.event,a="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Ss(s,t)>a?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),2===o.pointerDownCount&&this._doubleClick.emit(s,void 0,r))}_handlePointerDown(e){const t=Cs(e.data),i=this._pointerState.get(t);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:i}}=t,n=Cs(t),o="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(n)),o);this._pointerState.set(n,{event:e,doubleClickTimer:s,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Gs(e){const{pointerId:t,pointerType:i,button:n}=e.native;return"mouse"===i?`${t}:${n}`:`${i}`}const Ws={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Us=class extends n.aD{initialize(){const e=()=>this.view?.ready;this.addHandles([(0,n.aF)((()=>!e()),(()=>this._disconnect())),(0,n.aF)(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=(0,n.C)(this._inputManager)}_connect(){const e=this.view.surface,t=new bs(e,this.view.input),i=[new Ns,new zs,new Hs,new Is(this.view.navigation),new Es],o=new _e({eventSource:t,recognizers:i});o.installHandlers("prevent-context-menu",[new Ms],ke.INTERNAL),o.installHandlers("navigation",[new as(this.view),new Jo(this.view),new rs(this.view),new Go(this.view),new Go(this.view,[Ws.counter]),new Zo(this.view,"primary"),new ts(this.view,Ws.pan),new os(this.view,Ws.zoom),new is(this.view,Ws.rotate),new jo(this.view,"secondary"),new Wo(this.view,"touch")],ke.INTERNAL),this.view.viewEvents.connect(o),this._source=t,this._inputManager=o,(0,n.aE)((()=>this.view?.navigation?.browserTouchPanEnabled),(e=>{this._source&&(this._source.browserTouchPanningEnabled=!e)}),n.cR)}get test(){}};(0,n.k)([(0,n.o)()],Us.prototype,"view",void 0),(0,n.k)([(0,n.o)()],Us.prototype,"latestPointerType",null),(0,n.k)([(0,n.o)()],Us.prototype,"latestPointerLocation",null),(0,n.k)([(0,n.o)()],Us.prototype,"multiTouchActive",null),Us=(0,n.k)([(0,n.A)("esri.views.2d.input.MapViewInputManager")],Us);const Zs=Us,js={added:[],removed:[]},qs=new Set,Bs=new R.e(0,0,0,0);function Ks(e,t){const i=(0,n.bF)(t);if(!i)return null;const[o,s]=i.valid;return e[2]>s?[(0,n.bS)([e[0],e[1],s,e[3]]),(0,n.bS)([o,e[1],o+e[2]-s,e[3]])]:e[0]<o?[(0,n.bS)([o,e[1],e[2],e[3]]),(0,n.bS)([s-(o-e[0]),e[1],s,e[3]])]:null}let $s=class extends n.bP{constructor(e){super(),this._tiles=new Map,this._index=(0,T.i)(9,(0,n.a$)("esri-csp-restrictions")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||0===(0,n.kd)(e)||0===(0,n.ke)(e))return[];const t=Ks(e,this.tileScheme.spatialReference);return null!=t?[...new Set([...this.boundsIntersections(t[0]),...this.boundsIntersections(t[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const e=new T.g(this.tileScheme,i);this._tiles.set(i,e),this._index.insert(e),t.added.push(e)}for(const i of e.removed)if(this.has(i)){const e=this.get(i);this._tiles.delete(i),this._index.remove(e),t.removed.push(e)}this.tiles.length=0,this._tiles.forEach((e=>this.tiles.push(e))),(t.added.length||t.removed.length)&&this.emit("update",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:i,lodInfo:n}=t,{level:o}=n;if(i.length>0)for(const{row:s,colFrom:r,colTo:a}of i)for(let e=r;e<=a;e++){const t=Bs.set(o,s,n.normalizeCol(e),n.getWorldForColumn(e)).id;if(qs.add(t),!this.has(t)){const e=new T.g(this.tileScheme,t);this._tiles.set(t,e),this._index.insert(e),this.tiles.push(e),js.added.push(e)}}for(let s=this.tiles.length-1;s>=0;s--){const e=this.tiles[s];qs.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(s,1),this._index.remove(e),js.removed.push(e))}(js.added.length||js.removed.length)&&this.emit("update",js),T.s.pool.release(t),qs.clear(),js.added.length=0,js.removed.length=0}};const Js=1,Xs=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],Ys=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Qs=256,er=new n.aC("cyan"),tr=1,ir=.25;new n.aC("black");const nr="default",or="temporary",sr=new n.aC("yellow");let rr=class extends n.aD{constructor(e){super(e),this.color=er.clone(),this.haloOpacity=tr,this.fillOpacity=ir}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};(0,n.k)([(0,n.o)({type:n.aC})],rr.prototype,"color",void 0),(0,n.k)([(0,n.o)({type:n.aC})],rr.prototype,"haloColor",void 0),(0,n.k)([(0,n.o)()],rr.prototype,"haloOpacity",void 0),(0,n.k)([(0,n.o)()],rr.prototype,"fillOpacity",void 0),rr=(0,n.k)([(0,n.A)("esri.views.support.HighlightOptions")],rr);const ar=rr;var lr;let cr=lr=class extends ar{constructor(e){super(e),this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(e){return super.equals(e)&&this.haloWidth===e.haloWidth&&this.haloBlur===e.haloBlur}get optionsKey(){return`${this.color};${this.haloColor};${this.haloOpacity};${this.fillOpacity};${this.haloWidth};${this.haloBlur}`}clone(){return new lr({color:this.color.clone(),haloColor:this.haloColor?.clone(),haloOpacity:this.haloOpacity,fillOpacity:this.fillOpacity,haloWidth:this.haloWidth,haloBlur:this.haloBlur})}};(0,n.k)([(0,n.o)()],cr.prototype,"haloWidth",void 0),(0,n.k)([(0,n.o)()],cr.prototype,"haloBlur",void 0),cr=lr=(0,n.k)([(0,n.A)("esri.views.2d.support.HighlightOptions")],cr);const hr=cr,ur=()=>n.n.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function dr(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=(1-e.haloBlur)*e.haloWidth,t.outerHaloWidth=e.haloBlur*e.haloWidth/2,t.innerHaloWidth=e.haloBlur*e.haloWidth/2,t.outlinePosition=0}const pr=[0,0,0,0];let mr=class{constructor(){this.type="single",this._highlightOptions=new hr,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Qs),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,t){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,A.F),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<A.K)-1,activeGradient:this}]}_updateGradientTexture(e){const{optionsKey:t}=this._highlightOptions;if(t===this._optionsShadeTexKey)return;this._optionsShadeTexKey=t,dr(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,n=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,o=i.outlinePosition-i.outlineWidth/2,s=i.outlinePosition+i.outlineWidth/2,r=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,a=Math.sqrt(Math.PI/2)*Js,l=Math.abs(n)>a?Math.round(10*(Math.abs(n)-a))/10:0,c=Math.abs(r)>a?Math.round(10*(Math.abs(r)-a))/10:0;let h;l&&!c?ur().error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&c?ur().error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&c&&ur().error("The highlight is "+Math.max(l,c)+"px away from the edge of the feature; consider reducing some width values.");const u=[void 0,void 0,void 0,void 0];function d(e,t,i){u[0]=(1-i)*e[0]+i*t[0],u[1]=(1-i)*e[1]+i*t[1],u[2]=(1-i)*e[2]+i*t[2],u[3]=(1-i)*e[3]+i*t[3]}const{_texelData:p}=this;for(let m=0;m<Qs;++m)h=n+m/(Qs-1)*(r-n),h<n?(u[0]=0,u[1]=0,u[2]=0,u[3]=0):h<o?d(pr,i.outlineColor,(h-n)/(o-n)):h<s?[u[0],u[1],u[2],u[3]]=i.outlineColor:h<r?d(i.outlineColor,i.fillColor,(h-s)/(r-s)):[u[0],u[1],u[2],u[3]]=i.fillColor,p[4*m]=255*u[0],p[4*m+1]=255*u[1],p[4*m+2]=255*u[2],p[4*m+3]=255*u[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=r,!this._shadeTex){const t=new D.p;t.wrapMode=L.D.CLAMP_TO_EDGE,t.width=Qs,t.height=1,this._shadeTex=new D.m(e,t)}this._shadeTex.updateData(0,0,0,Qs,1,this._texelData)}},gr=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let t=0;t<e.length;t++)this.gradients[t]||(this.gradients[t]=new mr),this.gradients[t].setHighlightOptions(e[t].options);for(let t=e.length+1;t<this.gradients.length;t++)this.gradients[t].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const t=[];for(let i=0;i<this.gradients.length;i++){const n=this.gradients[i];t.push({activeReasons:e,activeGradient:n}),e<<=1}return t}};var fr,yr,vr,_r,wr,br,kr,Mr,Tr;(function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"})(fr||(fr={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(yr||(yr={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(vr||(vr={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(_r||(_r={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(wr||(wr={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(br||(br={})),function(e){e[e.All=0]="All",e[e.Highlight=1]="Highlight",e[e.InsideEffect=2]="InsideEffect",e[e.OutsideEffect=3]="OutsideEffect"}(kr||(kr={})),function(e){e[e.BATCHING=0]="BATCHING",e[e.STRICT_ORDER=1]="STRICT_ORDER",e[e.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(Mr||(Mr={})),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT"}(Tr||(Tr={}));const Sr={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:L.O.EQUAL,mask:255,op:{fail:L.I.KEEP,zFail:L.I.KEEP,zPass:L.I.REPLACE}}}},Pr={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},xr={...Sr,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function Cr({pixelRatio:e,state:t,displayLevel:i,requiredLevel:o},s){const r=1/2**(i-s.key.level),a=1/2**(o-s.key.level);return{displayMat3:t.displayMat3,displayViewMat3:t.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:t.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:a,tileOffset:[s.x,s.y],currentScale:t.scale,currentZoom:i,metersPerSRUnit:(0,n.bq)(t.spatialReference),rotation:t.rotation,pixelRatio:e}}function Er(e){return"highlight"===e.passOptions?.type}function Rr(e){return"hittest"===e.passOptions?.type}function Ir(e){if(!Rr(e))return null;const{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}}function Ar(e){if(!Er(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}function Lr(e,t,i){const n={};for(const o in i)i[o]instanceof Function?n[o]=i[o](e,t):n[o]=i[o];return n}function Dr(e,t){const{attributeView:i,context:n}=e;return{storage:i.getUniforms(n),view:Cr(e,t),hittestRequest:Ir(e),highlight:Ar(e)}}function Or(e){return{inside:e.selection===kr.InsideEffect,outside:e.selection===kr.OutsideEffect}}function Vr(e){return Rr(e)?Pr:Er(e)&&"clear"===e.passOptions.stepType?xr:Sr}function Nr(e){const{row:t,col:i}=e.key,n=i*A.a,o=t*A.a;return{tileOffsetFromLocalOrigin:[n%A.Q,o%A.Q],maxIntsToLocalOrigin:[Math.floor(n/A.Q),Math.floor(o/A.Q)]}}const zr=new n.ax({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function Fr(e){return zr.toJSON(e)}function Hr(e){const{bandCount:t,attributeTable:i,colormap:n,pixelType:o}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=n||"u8"===o||"s8"===o)}function Gr(e,t){return null==t?(e?.destroy(),null):("single"===e?.type&&Array.isArray(t)&&(e.destroy(),e=null),"multi"!==e?.type||Array.isArray(t)||(e.destroy(),e=null),e||(e=Array.isArray(t)?new gr:new mr),Array.isArray(t)?"multi"===e.type&&e.setHighlightOptions(t):"single"===e.type&&e.setHighlightOptions(t),e)}function Wr(e,t,i,n){const{painter:o,highlightGradient:s}=e,{highlight:r}=o.effects;if(!s)return;const a=e.passOptions,l=s.getReasonsWithGradients();for(let c=0;c<l.length;c++){const s={...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"burn",highlightAll:t}};if(r.bind(s),i(s),c<l.length-1){let o=0;for(let e=c+1;e<l.length;e++)o|=l[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[c].activeGradient,activeReasons:o,stepType:"clear",highlightAll:t}})}const a={...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"draw",highlightAll:t}};o.setPipelineState(Vr(e)),o.updatePipelineState(e.context),r.draw(a),r.unbind()}e.passOptions=a}const Ur=e=>parseFloat(e)/100;function Zr(e,t,i){const n="string"==typeof e.left?Ur(e.left)*t:e.left,o="string"==typeof e.right?Ur(e.right)*t:e.right,s="string"==typeof e.top?Ur(e.top)*i:e.top,r="string"==typeof e.bottom?Ur(e.bottom)*i:e.bottom,a=s;return{xmin:n,xmax:Math.max(t-o,n),ymin:a,ymax:Math.max(i-r,s)}}function jr(e,t,i,o){switch(t.type){case"rect":{const{width:n,height:o}=e,{xmin:s,xmax:r,ymin:a,ymax:l}=Zr(t,n,o),{x:c,y:h}=i;return c>s&&c<r&&h>a&&h<l}case"path":return 0===t.path.length||!Array.isArray(t.path[0][0])||(0,n.gD)(t.path,[i.x,i.y]);case"geometry":return null==t.geometry||("polygon"===t.geometry.type?(0,n.kc)(t.geometry,o):(0,n.h7)(t.geometry,o))}}var qr;let Br=qr=class extends n.aD{constructor(...e){super(...e),this.name="default",this.options=new hr}clone(){return new qr({name:this.name,options:this.options.clone()})}};(0,n.k)([(0,n.o)({type:String})],Br.prototype,"name",void 0),(0,n.k)([(0,n.o)({type:hr})],Br.prototype,"options",void 0),Br=qr=(0,n.k)([(0,n.A)("esri.views.2d.support.HighlightGroup")],Br);const Kr=n.V.ofType(Br);function $r(){return new Kr([{name:nr,options:new hr},{name:or,options:new hr({color:sr})}])}function Jr(e){if(!e.highlights)return null;const t=e.highlights.findIndex((e=>"default"===e.name));return-1===t?null:e.highlights.items[t].options}function Xr(e,t){if(!e.highlights){if(!t)return;e.highlights=new Kr([{name:"default",options:new hr}])}const i=e.highlights.findIndex((e=>"default"===e.name));t?e.highlights.items[i].options=t:e.highlights.removeAt(i)}async function Yr(e,t,i){const o=Pt(t)?St(e,t):t;if(!e.ready||isNaN(o.x)||isNaN(o.y))return{screenPoint:o,results:[]};let s=new Set;const r=new Set;let a=!1,l=null,c=null;i?.include?ea(i.include,Qr(e,(e=>{s.add(e),ia(e,(e=>r.add(e)))}),((e,t)=>{r.add(e),s.add(t)}),(e=>{l||(l=new Set),l.add(e)}),(e=>s.add(e)),(()=>a=!0))):(a=!0,s=new Set(e.allLayerViews),s.forEach((e=>{ia(e,(e=>r.add(e)))}))),i?.exclude&&ea(i.exclude,Qr(e,(e=>{s.delete(e),ia(e,(e=>r.delete(e)))}),(e=>r.delete(e)),(e=>{c||(c=new Set),c.add(e)})));const h=e.toMap(o),u=e.allLayerViews.filter((t=>!t.suspended&&s.has(t)&&t.clips.every((t=>jr(e,t,o,h))))).reverse();let d=[...a?e.graphicsView.hitTest(h).map((e=>({type:"graphic",graphic:e,layer:null,mapPoint:h}))):[],...await Promise.all(u.map((e=>e.hitTest(h,o))).toArray())].filter(n.bQ).flat().filter(n.bQ);return d=d.filter((e=>"graphic"!==e.type||"subtype-group"!==e.layer?.type||r.has(e.graphic.layer))),l&&(d=d.filter((e=>!("graphic"in e)||!e.graphic||l?.has(ta(e.graphic))))),c&&(d=d.filter((e=>!("graphic"in e)||!e.graphic||!c?.has(ta(e.graphic))))),{screenPoint:o,results:d}}function Qr(e,t,i,o,s,r){return a=>{if(a instanceof n.b1){if(a.layer===e)r?.();else{const t=e.allLayerViews.find((e=>e.layer===a.layer));t&&s?.(t)}o(ta(a))}else if(!("layer"in a)||!("element"in a))if("subtype-sublayer"===a.type){const t=e.allLayerViews.find((e=>e.layer===a.parent));t&&i(a,t)}else{const i=e.allLayerViews.find((e=>e.layer===a));i&&t(i)}}}function ea(e,t){if(e)if((0,n.kf)(e))for(const i of e)if((0,n.kf)(i))for(const e of i)t(e);else t(i);else t(e)}function ta(e){const t=e.getObjectId();return t?`${e.layer?.uid??e.sourceLayer?.uid??"MapView"}/${t}`:`"MapView/${e.uid}`}function ia({layer:e},t){"subtype-group"===e?.type&&e.sublayers.forEach((e=>{t(e)}))}function na(e,t,i){const{ctx:n,canvas:o}=sa(e,i),s=n.getImageData(0,0,e.width,e.height),r=ca(o,t);return ra(o),{dataUrl:r,data:s}}function oa(e,t){const{ctx:i,canvas:n}=sa(e,t),o=i.getImageData(0,0,e.width,e.height);return ra(n),o}function sa(e,t){const i=aa();t.premultipliedAlpha&&ga(e),i.width=e.width,i.height=e.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(e,0,0),t.flipY&&ma(n),{ctx:n,canvas:i}}function ra(e){e.width=0,e.height=0}function aa(){return null==la&&(la=document.createElement("canvas")),la}$r().items.map((e=>e.name));let la=null;function ca(e,t){const i=fa[t.format],n=t.quality/100;return e.toDataURL(i,n)}function ha(e,t){const i=pa(e),o=_a[i];return{format:i,quality:(0,n.aP)(t??o,0,100)}}function ua(e,t){return t/Math.max(e[0],e[1])}function da(e,t,i,n=0,o=0,s=e.width-n,r=e.height-o,a=!1){const{data:l}=e,{width:c,height:h,data:u}=t,d=s/c,p=r/h,m=Math.ceil(d/2),g=Math.ceil(p/2),f=e.width;for(let y=0;y<h;y++)for(let e=0;e<c;e++){const t=4*(e+(a?h-y-1:y)*c);let s=0,r=0,v=0,_=0,w=0,b=0;const k=(y+.5)*p;for(let a=Math.floor(y*p);a<(y+1)*p;a++){const t=Math.abs(k-(a+.5))/g,c=(e+.5)*d,h=t*t;for(let u=Math.floor(e*d);u<(e+1)*d;u++){const e=Math.abs(c-(u+.5))/m,t=Math.sqrt(h+e*e);if(t>=1)continue;let d=2*t*t*t-3*t*t+1;const p=4*(n+u+(o+a)*f);b+=d*l[p+3],r+=d,!i&&l[p+3]<255&&(d=d*l[p+3]/255),v+=d*l[p],_+=d*l[p+1],w+=d*l[p+2],s+=d}}u[t]=v/s,u[t+1]=_/s,u[t+2]=w/s,u[t+3]=b/r}return t}function pa(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return va}}function ma(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}function ga(e){const t=e.data,i=t.length;for(let n=0;n<i;n+=4){const e=t[n+3];if(255!==e&&e>0){const i=255/e;t[n]=t[n]*i,t[n+1]=t[n+1]*i,t[n+2]=t[n+2]*i}}}const fa={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},ya=98,va="png",_a={png:100,jpg:ya,jpeg:ya},wa=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:O.s,encode:na,encodeData:oa,getFormatAndQuality:ha,getMaximumResolutionScale:ua,resampleHermite:da,toDataUrl:ca},Symbol.toStringTag,{value:"Module"})),ba={flipY:!0,premultipliedAlpha:!0};async function ka(e,t){const i=await Ta(e,t),{format:n,quality:o}=ha(t?.format,t?.quality);return na(i,{format:n,quality:o},ba)}async function Ma(e,t){const i=await Ta(e,t);return oa(i,ba)}function Ta(e,t){const i=xa(t||{},Pa(e.stage,e.size),e.size,e.padding),n=Sa(t,e.allLayerViews);return e.stage.takeScreenshot(i,n,e.backgroundColor,t?.rotation)}function Sa(e={},t){if(!e.layers)return;const i=[];return e.layers.forEach((e=>{const n=t.find((t=>t.layer.id===e.id));n?.container&&i.push(n.container)})),i}function Pa(e,t){return Math.min(4,ua(t,Math.min(4096,e.context.parameters.maxTextureSize)))}function xa(e,t,i,n){e.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let o=null;null!=e.width&&null!=e.height?o=[e.width,e.height]:null==e.width&&null!=e.height?o=[e.height,e.height]:null!=e.width&&null==e.height?o=[e.width,e.width]:null==e.width&&null==e.height&&(o=null);const s=i[0]-(n.left+n.right),r=i[1]-(n.top+n.bottom);let a,l,c=e.area||{x:0,y:0,width:s,height:r};if(o){const e=s/r,t=o[0]/o[1];if(t>e){const e=c.width/t;c={x:c.x,y:Math.round(c.y+(c.height-e)/2),width:c.width,height:Math.round(e)}}else{const e=c.height*t;c={x:Math.round(c.x+(c.width-e)/2),y:c.y,width:Math.round(e),height:c.height}}}else o=[c.width,c.height];return o[0]>c.width?(a=Math.min(o[0]/c.width,t),l=o[0]/c.width/a):(a=1,l=o[0]/c.width),{cropArea:{x:Math.round((c.x+n.left)*a),y:Math.round((c.y+n.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}const Ca=160;let Ea=class extends n.aD{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),null==this._timer&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=Ca&&this.clear()}),Ca))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};(0,n.k)([(0,n.o)()],Ea.prototype,"_timer",void 0),(0,n.k)([(0,n.o)()],Ea.prototype,"stationary",null),Ea=(0,n.k)([(0,n.A)("esri.views.2d.support.StationaryManager")],Ea);const Ra=e=>e.includes("Brush");let Ia=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Ra(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function Aa(e){const t=(0,V.t)();return t.available?"3d"===e&&t.majorPerformanceCaveat?new n.s("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new n.s("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new n.s("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new n.s("webgl:required","WebGL2 is required but not supported.",(new Error).stack)}function La(e){return e&&"nodeType"in e}function Da(e){return e&&"function"==typeof e.render}const Oa={component:"esri-component"};let Va=class extends n.aD{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(Oa.component),t&&t.classList.remove(Oa.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?"string"==typeof e||La(e)?(this._set("widget",null),(0,c.v)(e)):(Da(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};(0,n.k)([(0,n.o)()],Va.prototype,"id",null),(0,n.k)([(0,n.o)()],Va.prototype,"node",null),(0,n.k)([(0,n.by)("node")],Va.prototype,"castNode",null),(0,n.k)([(0,n.o)({readOnly:!0})],Va.prototype,"widget",void 0),Va=(0,n.k)([(0,n.A)("esri.views.ui.Component")],Va);const Na=Va,za={left:0,top:0,bottom:0,right:0},Fa={bottom:30,top:15,right:15,left:15},Ha="esri-ui",Ga={ui:Ha,corner:`${Ha}-corner`,innerContainer:`${Ha}-inner-container`,manualContainer:`${Ha}-manual-container`,cornerContainer:`${Ha}-corner-container`,topLeft:`${Ha}-top-left`,topRight:`${Ha}-top-right`,bottomLeft:`${Ha}-bottom-left`,bottomRight:`${Ha}-bottom-right`};function Wa(e){return e&&!e._started&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}function Ua(e){return 0===e?"0":`${e}px`}function Za(e){const t="object"==typeof e&&null!==e&&Object.getPrototypeOf(e);return null!==t&&t!==Object.prototype||!("component"in e||"index"in e||"position"in e)?null:e}function ja(e,{top:t,bottom:i,left:n,right:o}){e.style.top=t,e.style.bottom=i,e.style.left=n,e.style.right=o}let qa=class extends n.bP.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=(0,n.av)(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&ja(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&ja(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([(0,n.aE)((()=>[this.view?.padding,this.container]),this._applyViewPadding,n.cR),(0,n.aE)((()=>this.padding),this._applyUIPadding,n.cR),(0,n.aE)((()=>[this.container,this._locale]),(([e,t])=>{e&&e.setAttribute("lang",t)}),n.cR),(0,n.iQ)((e=>{this._locale=e}))])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(Ga.ui),(0,c.t)(e),this._attachContainers(e)),t&&(t.classList.remove(Ga.ui),ja(t,{top:"",bottom:"",left:"",right:""}),t.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(0===e)return e;const t=this._getViewPadding(),{top:i,bottom:n}=t;return Math.max(e-i-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return"number"==typeof e?{bottom:e,top:e,right:e,left:e}:{...Fa,...e}}get width(){const e=this.view?.width??0;if(0===e)return e;const t=this._getViewPadding(),{left:i,right:n}=t;return Math.max(e-i-n,0)}add(e,t){let i,n,o;if(Array.isArray(e))return void e.forEach((e=>this.add(e,t)));const s=Za(e);s&&({index:i,position:t,component:e,key:n}=s),t&&"object"==typeof t&&({index:i,key:n,position:t,internal:o}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,i,n,o)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map((e=>this.remove(e,t)));const i=this._find(e);if(i){if(this._componentMap.has(i)&&this._componentMap.get(i)?.key!==t)return;const e=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(e,1)[0]}}empty(e,t={removeInternal:!1}){if(Array.isArray(e)){for(const i of e)this.empty(i,t);return}const i=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter((e=>null!=e&&(!this._componentMap.get(e)?.internal||t.removeInternal)));for(const o of n)this.remove(o)}move(e,t){if(Array.isArray(e)&&e.forEach((e=>this.move(e,t))),!e)return;let i;const n=Za(e)||Za(t);if(n&&(i=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const o=this.remove(e);o&&this.add(o,{position:t,index:i})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getComponents(e,t={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap((e=>this._getComponentsAtPosition(e,t))):this._getComponentsAtPosition(e,t):this._components.filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((({widget:e,node:t})=>e??t))}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,i,o,s){e instanceof Na||(e=new Na({node:e}));const{widget:r}=e;null!=r&&r instanceof n.aD&&r.addHandles((0,n.aH)((()=>{queueMicrotask((()=>this.remove(e)))})),this._removeWidgetHandleKey),this._place({component:e,position:t,index:i}),this._components.push(e),this._componentMap.set(e,{key:o,internal:s})}_find(e){return e?e instanceof Na?this._findByComponent(e):"string"==typeof e?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.view?.padding??za}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ga.innerContainer,Ga.cornerContainer);const t=document.createElement("div");t.classList.add(Ga.innerContainer,Ga.manualContainer);const i=document.createElement("div");i.classList.add(Ga.topLeft,Ga.corner),e.appendChild(i);const n=document.createElement("div");n.classList.add(Ga.topRight,Ga.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Ga.bottomLeft,Ga.corner),e.appendChild(o);const s=document.createElement("div");s.classList.add(Ga.bottomRight,Ga.corner),e.appendChild(s),this._innerContainer=e,this._manualContainer=t;const r=(0,c.u)();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":o,"bottom-right":s,"top-leading":r?n:i,"top-trailing":r?i:n,"bottom-leading":r?s:o,"bottom-trailing":r?o:s},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.position??"manual",{component:i,index:n}=e,o=this._positionNameToContainerLookup[t],s=null!=n&&n>-1;if(Wa(i.widget)&&i.widget.startup(),!s)return void o.appendChild(i.node);const r=Array.from(o.children);if(0===n){const{firstChild:e}=o;return void(e?e.parentNode?.insertBefore(i.node,e):o.appendChild(i.node))}if(n>=r.length)return void o.appendChild(i.node);const a=r[n];a.parentNode?.insertBefore(i.node,a)}_toPixelPosition(e){return{top:Ua(e.top),left:Ua(e.left),right:Ua(e.right),bottom:Ua(e.bottom)}}_findByComponent(e){return this._components.find((t=>t===e))??null}_findById(e){return this._components.find((({id:t})=>t===e))??null}_findByNode(e){return this._components.find((({node:t})=>t===e))??null}_getComponentsAtPosition(e,t){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter(n.bQ).filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((({widget:e,node:t})=>e??t))}};(0,n.k)([(0,n.o)()],qa.prototype,"_locale",void 0),(0,n.k)([(0,n.o)()],qa.prototype,"container",null),(0,n.k)([(0,n.o)()],qa.prototype,"height",null),(0,n.k)([(0,n.o)({value:Fa})],qa.prototype,"padding",null),(0,n.k)([(0,n.by)("padding")],qa.prototype,"castPadding",null),(0,n.k)([(0,n.o)()],qa.prototype,"view",void 0),(0,n.k)([(0,n.o)()],qa.prototype,"width",null),qa=(0,n.k)([(0,n.A)("esri.views.ui.UI")],qa);const Ba=qa,Ka=new Map;function $a(e){return Ka.get(e)}function Ja(e,t){return e&&"copyright"in e&&(!t||"function"==typeof e.originOf&&"user"===e.originOf("copyright"))}function Xa(e,t){return e.length!==t.length||e.some(((e,i)=>e.text!==t[i].text))}function Ya(e,t,i){!i||!t||e.find((e=>e.layerView===t&&e.text===i))||e.push({text:i,layerView:t})}function Qa(e){return"bing-maps"===e.type}const el=[];let tl=class extends n.aD{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new n.V,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const t=this.view?.allLayerViews;t&&(this.addHandles(t.map((e=>(0,n.aE)((()=>[e.suspended,e.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),t.forEach((e=>{"esri.views.3d.layers.Tiles3DLayerView3D"===e.declaredClass&&this.addHandles(e.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),e?.removed&&e.removed.forEach((e=>{this._pendingAttributions.delete(e),this._fetchedAttributionData.delete(e)})),this._updateAttributionItems()},this.addHandles([(0,n.aG)((()=>this.view?.allLayerViews),"change",(e=>this._allLayerViewsChange(e)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),(0,n.aF)((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,t=e?.allLayerViews;if(el.length=0,!e||!t)return void this._clear();t.forEach((t=>{if(t.suspended||!t.layer?.attributionVisible)return;const i=t.layer;if(Ja(i,"user"))return void Ya(el,t,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(t)){const n=this._fetchedAttributionData.get(t);return void(n?Ya(el,t,this._getDynamicAttribution(n,e,i)):Ja(i)&&Ya(el,t,i.copyright))}return void this._fetchAttributionData(t)}const n="portalItem"in i?i.portalItem?.accessInformation:void 0;Ya(el,t,n||i.copyright)}));const i=t.find((e=>"integrated-mesh-3dtiles"===e.layer?.type));if(this.view&&i){const e=$a(this.view);if(e){const t=e.getAttributionText();for(let e=0;e<t.length;++e)Ya(el,i,t[e])}}Xa(this.items,el)&&(this.items.removeAll(),this.items.addMany(el)),el.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await(0,n._)(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=t.ok?this._createContributionIndex(t.value,Qa(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,t){const i=e.contributors,o={};if(!i)return o;for(let s=0;s<i.length;s++){const e=i[s],r=e.coverageAreas;if(!r)return;for(const i of r){const r=i.bbox,a=i.zoomMin-(t&&i.zoomMin?1:0),l=i.zoomMax-(t&&i.zoomMax?1:0),c=new n.au({xmin:r[1],ymin:r[0],xmax:r[3],ymax:r[2],spatialReference:n.B.WGS84}),h={extent:(0,n.cI)(c),attribution:e.attribution||"",score:null!=i.score?i.score:100,id:s};for(let e=a;e<=l;e++)o[e]??=[],o[e].push(h)}}return o.maxKey=Math.max.apply(null,Object.keys(o)),o}_getDynamicAttribution(e,t,i){const{extent:o,scale:s}=t;let r=i.tileInfo?.scaleToZoom(s)??0;if(r=Math.min(e.maxKey??0,Math.round(r)),!o||null==r||r<=-1)return"";const a=e[r],l=(0,n.co)(o.center.clone().normalize(),n.B.WebMercator),c=new Set;return a?a.filter((e=>{const t=e.id,i=!c.has(t)&&l&&e.extent&&(0,n.h7)(e.extent,l);return i&&c.add(t),i})).sort(((e,t)=>t.score-e.score||e.objectId-t.objectId)).map((e=>e.attribution)).join(", "):""}};(0,n.k)([(0,n.o)({readOnly:!0,type:n.V})],tl.prototype,"items",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],tl.prototype,"state",null),(0,n.k)([(0,n.o)()],tl.prototype,"view",void 0),tl=(0,n.k)([(0,n.A)("esri.widgets.Attribution.AttributionViewModel")],tl);const il=tl,nl={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function ol(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${String(t)}'`);return{value:rl(e[t])}}}function sl(e){const t=e?.type;return e instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function rl(e){return function(t,...i){sl(t)?(0,c.y)(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...i)}}const al="esri-attribution",ll={base:al,poweredBy:`${al}__powered-by`,sources:`${al}__sources`,open:`${al}--open`,sourcesOpen:`${al}__sources--open`,link:`${al}__link`};let cl=class extends c.B{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((e=>e.forEach((({target:e})=>this._checkSourceTextOverflow(e))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new il}initialize(){this.addHandles((0,n.aG)((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(e.includes(t.text)||e.push(t.text),e)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[ll.open]:this._isOpen};return(0,c.n)("div",{bind:this,class:this.classes(ll.base,nl.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return(0,c.n)("div",{class:ll.poweredBy},"Powered by"," ",(0,c.n)("a",{class:ll.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?0:void 0,{attributionText:n}=this,o={[ll.sourcesOpen]:e,[nl.interactive]:t};return(0,c.n)("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(ll.sources,o),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:i,clientWidth:n,scrollWidth:o}=e,s=o>n,r=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,r&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};(0,n.k)([(0,n.o)()],cl.prototype,"_isOpen",void 0),(0,n.k)([(0,n.o)()],cl.prototype,"_isInteractive",null),(0,n.k)([(0,n.o)()],cl.prototype,"_attributionTextOverflowed",void 0),(0,n.k)([(0,n.o)()],cl.prototype,"_prevSourceNodeHeight",void 0),(0,n.k)([(0,n.o)({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],cl.prototype,"attributionText",null),(0,n.k)([(0,n.o)()],cl.prototype,"icon",null),(0,n.k)([(0,n.o)()],cl.prototype,"itemDelimiter",void 0),(0,n.k)([(0,n.o)()],cl.prototype,"label",null),(0,n.k)([(0,n.o)(),(0,c.e)("esri/widgets/Attribution/t9n/Attribution")],cl.prototype,"messages",void 0),(0,n.k)([(0,n.o)()],cl.prototype,"view",null),(0,n.k)([(0,n.o)({type:il})],cl.prototype,"viewModel",void 0),(0,n.k)([ol()],cl.prototype,"_toggleState",null),cl=(0,n.k)([(0,n.A)("esri.widgets.Attribution")],cl);const hl=cl;function ul(){const e=(0,n.a$)("mapview-essential-goto-duration");return null==e?e:(0,n.cP)(e)}function dl(e){return e?.spatialReference?.isWebMercator||e?.spatialReference?.isGeographic||!1}const pl=e=>{let t=class extends e{constructor(...e){super(...e),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return(0,n.af)(t),this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}};return(0,n.k)([(0,n.o)()],t.prototype,"goToOverride",void 0),(0,n.k)([(0,n.o)()],t.prototype,"view",void 0),t=(0,n.k)([(0,n.A)("esri.widgets.support.GoTo")],t),t};let ml=class extends(pl(n.aD)){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles((0,n.aE)((()=>this.view),this._updateRotationWatcher,n.cR))}destroy(){this.view=null}get canShowNorth(){return dl(this.view)}get state(){return!this.view?.ready||"2d"===this.view.type&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&("2d"===this.view?.type?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:ul()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){null!=e&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this._set("orientation",{x:0,y:0,z:t})}_updateRotationWatcher(e){this.removeAllHandles(),e&&this.addHandles("2d"===e.type?(0,n.aE)((()=>e?.rotation),this._updateForRotation,n.cR):(0,n.aE)((()=>e?.camera),this._updateForCamera,n.cR))}};(0,n.k)([(0,n.o)({readOnly:!0})],ml.prototype,"canShowNorth",null),(0,n.k)([(0,n.o)({readOnly:!0})],ml.prototype,"orientation",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],ml.prototype,"state",null),(0,n.k)([(0,n.o)()],ml.prototype,"view",void 0),ml=(0,n.k)([(0,n.A)("esri.widgets.Compass.CompassViewModel")],ml);const gl=ml,fl="esri-compass",yl={base:fl,iconContainer:`${fl}__icon-container`};let vl=class extends c.B{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new gl,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=e=>({transform:`rotateZ(${e.z}deg)`})}loadDependencies(){return(0,c.d)({button:()=>Promise.all([i.e(6536),i.e(606)]).then(i.bind(i,10606)),icon:()=>i.e(1942).then(i.bind(i,81942))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"rotation"===this.viewModel.state?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,{messages:i}=this;return(0,c.n)("div",{class:this.classes(yl.base,nl.widget)},(0,c.n)("calcite-button",{class:nl.widgetButton,disabled:"disabled"===t,kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},(0,c.n)("div",{"aria-hidden":"true",class:yl.iconContainer,title:i.reset},(0,c.n)("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};(0,n.k)([(0,n.o)()],vl.prototype,"goToOverride",null),(0,n.k)([(0,n.o)()],vl.prototype,"icon",null),(0,n.k)([(0,n.o)()],vl.prototype,"label",null),(0,n.k)([(0,n.o)(),(0,c.e)("esri/widgets/Compass/t9n/Compass")],vl.prototype,"messages",void 0),(0,n.k)([(0,n.o)()],vl.prototype,"view",null),(0,n.k)([(0,n.o)({type:gl})],vl.prototype,"viewModel",void 0),vl=(0,n.k)([(0,n.A)("esri.widgets.Compass")],vl);const _l=vl,wl="esri-navigation-toggle",bl={base:wl,isLayoutHorizontal:`${wl}--horizontal`};let kl=class extends n.aD{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles((0,n.aF)((()=>this.view?.inputManager),(()=>this._setNavigationMode())))}destroy(){this.view=null}get state(){return this.view?.ready&&"3d"===this.view?.type?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._setNavigationMode()}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate")}_setNavigationMode(){const e=this.view?.inputManager;e&&(e.primaryDragAction="pan"===this._navigationMode?"pan":"rotate")}};(0,n.k)([(0,n.o)({readOnly:!0})],kl.prototype,"state",null),(0,n.k)([(0,n.o)()],kl.prototype,"_navigationMode",void 0),(0,n.k)([(0,n.o)()],kl.prototype,"view",void 0),kl=(0,n.k)([(0,n.A)("esri.widgets.NavigationToggle.NavigationToggleViewModel")],kl);const Ml=kl;let Tl=class extends c.B{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Ml,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const e="pan"===this.viewModel?.navigationMode?this._rotateButton:this._panButton;(0,c.w)(e),this.toggle()}}loadDependencies(){return(0,c.d)({button:()=>Promise.all([i.e(6536),i.e(606)]).then(i.bind(i,10606))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="disabled"===this.viewModel?.state,t="pan"===this.viewModel?.navigationMode,i=this.messages.toggle;return(0,c.n)("div",{class:this.classes(bl.base,nl.widget,{[bl.isLayoutHorizontal]:"horizontal"===this.layout})},(0,c.n)("calcite-button",{afterCreate:e=>{this._panButton=e},appearance:t?"outline-fill":"solid",class:nl.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?void 0:-1,title:i}),(0,c.n)("calcite-button",{afterCreate:e=>{this._rotateButton=e},appearance:t?"solid":"outline-fill",class:nl.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?-1:void 0,title:i}))}};(0,n.k)([(0,n.o)()],Tl.prototype,"icon",null),(0,n.k)([(0,n.o)()],Tl.prototype,"label",null),(0,n.k)([(0,n.o)({value:"vertical"})],Tl.prototype,"layout",null),(0,n.k)([(0,n.o)(),(0,c.e)("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Tl.prototype,"messages",void 0),(0,n.k)([(0,n.o)()],Tl.prototype,"view",null),(0,n.k)([(0,n.o)({type:Ml})],Tl.prototype,"viewModel",void 0),Tl=(0,n.k)([(0,n.A)("esri.widgets.NavigationToggle")],Tl);const Sl=Tl;let Pl=class extends n.aD{get canZoomIn(){if(!this.view?.ready)return!1;const e=this.view?.constraints?.effectiveMaxScale;return 0===e||this._scale>e}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const t=e.constraints?.effectiveMinScale;return 0===t||this._scale<t}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};(0,n.k)([(0,n.o)({readOnly:!0})],Pl.prototype,"canZoomIn",null),(0,n.k)([(0,n.o)({readOnly:!0})],Pl.prototype,"canZoomOut",null),(0,n.k)([(0,n.o)()],Pl.prototype,"view",void 0),(0,n.k)([(0,n.o)()],Pl.prototype,"_scale",null),Pl=(0,n.k)([(0,n.A)("esri.widgets.Zoom.ZoomConditions2D")],Pl);const xl=Pl;let Cl=class extends n.aD{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};(0,n.k)([(0,n.o)({readOnly:!0})],Cl.prototype,"canZoomIn",null),(0,n.k)([(0,n.o)({readOnly:!0})],Cl.prototype,"canZoomOut",null),(0,n.k)([(0,n.o)()],Cl.prototype,"view",void 0),Cl=(0,n.k)([(0,n.A)("esri.widgets.Zoom.ZoomConditions3D")],Cl);const El=Cl;let Rl=class extends n.aD{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?"2d"===e.type?this._zoomConditions=new xl({view:e}):"3d"===e.type&&(this._zoomConditions=new El({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;"2d"===e.type?e.mapViewNavigation.zoomIn():(0,n.eg)(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;"2d"===e.type?e.mapViewNavigation.zoomOut():(0,n.eg)(e.goTo({zoomFactor:.5}))}};(0,n.k)([(0,n.o)()],Rl.prototype,"_zoomConditions",void 0),(0,n.k)([(0,n.o)()],Rl.prototype,"canZoomIn",null),(0,n.k)([(0,n.o)()],Rl.prototype,"canZoomOut",null),(0,n.k)([(0,n.o)({readOnly:!0})],Rl.prototype,"state",null),(0,n.k)([(0,n.o)()],Rl.prototype,"view",null),Rl=(0,n.k)([(0,n.A)("esri.widgets.Zoom.ZoomViewModel")],Rl);const Il=Rl,Al={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Ll=class extends c.B{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Il,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return(0,c.d)({button:()=>Promise.all([i.e(6536),i.e(606)]).then(i.bind(i,10606))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Al.horizontalLayout]:"horizontal"===this.layout},{canZoomIn:t,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:o}=this.messages;return(0,c.n)("div",{class:this.classes(Al.base,nl.widget,e)},(0,c.n)("calcite-button",{class:nl.widgetButton,disabled:!t,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),(0,c.n)("calcite-button",{class:nl.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};(0,n.k)([(0,n.o)()],Ll.prototype,"icon",null),(0,n.k)([(0,n.o)()],Ll.prototype,"label",null),(0,n.k)([(0,n.o)({value:"vertical"})],Ll.prototype,"layout",null),(0,n.k)([(0,n.o)(),(0,c.e)("esri/widgets/Zoom/t9n/Zoom")],Ll.prototype,"messages",void 0),(0,n.k)([(0,n.o)()],Ll.prototype,"view",null),(0,n.k)([(0,n.o)({type:Il})],Ll.prototype,"viewModel",void 0),Ll=(0,n.k)([(0,n.A)("esri.widgets.Zoom")],Ll);const Dl=Ll;function Ol(e){return void 0!==e?.view}let Vl=class extends Ba{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach((t=>{const i=this._find(t),n=i?.widget;Ol(n)&&(n.view=e)}))},this._componentsWatcher=(e,t)=>{this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([(0,n.aE)((()=>this.components),this._componentsWatcher,n.cR),(0,n.aE)((()=>this.view),this._updateViewAwareWidgets,n.cR)])}_add(e,t,i,n,o){let s=e;if("string"==typeof e&&this._defaultPositionLookup[e]){if(this._find(e))return;s=this._createComponent(e)}super._add(s,t,i,n,o)}_removeComponents(e){e.forEach((e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())}))}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(e){this.constructed&&e.forEach((e=>this.add(this._createComponent(e),this._defaultPositionLookup[e])))}_createComponent(e){const t=this._createWidget(e);return new Na({id:e,node:t})}_createWidget(e){const t=this.view;switch(e){case"attribution":return new hl({view:t});case"compass":return new _l({view:t});case"navigation-toggle":return new Sl({view:t});case"zoom":return new Dl({view:t})}}};(0,n.k)([(0,n.o)()],Vl.prototype,"components",void 0),Vl=(0,n.k)([(0,n.A)("esri.views.ui.DefaultUI")],Vl);const Nl=Vl;let zl=class extends Nl{constructor(e){super(e),this.components=["attribution","zoom"]}};(0,n.k)([(0,n.o)()],zl.prototype,"components",void 0),zl=(0,n.k)([(0,n.A)("esri.views.ui.2d.DefaultUI2D")],zl);const Fl=zl;class Hl extends N.r{constructor(e,t){super(e,t,"webmap")}}function Gl(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}let Wl,Ul,Zl,jl,ql,Bl,Kl;async function $l(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:n,MapViewNavigation:o,MagnifierView2D:s,GridView2D:r,Stage:a}]=await Promise.all([Promise.all([i.e(2753),i.e(7800)]).then(i.bind(i,47800)),Promise.all([i.e(3313),i.e(2614),i.e(2753),i.e(6171),i.e(7502),i.e(6849),i.e(1110),i.e(7032),i.e(8631),i.e(6481),i.e(2917),i.e(2137),i.e(4831),i.e(238),i.e(655),i.e(2309)]).then(i.bind(i,12309))]);Ul=e,Zl=t,jl=n,ql=o,Bl=s,Kl=r,Wl=a}new Hl(2,32);let Jl=class extends(X(xe(le(gi)))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new s.n({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new _o({view:this}),this.graphicsView=null,this.stateManager=new zo({constraints:new No({view:this})}),this.stationaryManager=new Ea,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new vo(this),this.floors=new n.V,this.grid=null,this.highlights=$r(),this.inputManager=new Zs({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Ia,this.type="2d",this.view2dType=null,this.ui=new Fl,this.test={takeScreenshot:async e=>Ma(this._getScreenshotView(e),e)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([(0,n.aE)((()=>this.viewpoint),(()=>this.stationaryManager.flip()),n.az),this.on("resize",(e=>this.stateManager.resize(e.width,e.height)))]),(0,r.m)()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=(0,n.C)(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new $s(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,t=this.spatialReference;return{lods:e?.spatialReference?.equals(t)?e.lods:null,spatialReference:t}}get state(){return this.stateManager.state}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:t,center:i,viewpoint:n,extent:o}=this;let s=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!o&&(t?.effectiveLODs||(s=-1),(!i||0===e&&-1===s)&&(null==n?.targetGeometry||"extent"!==n.targetGeometry.type&&!n.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=e.targetGeometry,i=this.spatialReference;return(0,a.B)(t.spatialReference,i)}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e);const i=()=>{this.destroyed||e===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};e.when(i,i)}get background(){return Gl(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return this.stateManager?.constraints}set constraints(e){e.view=this;const t=this.stateManager.constraints;this.stateManager.constraints=e,t?.destroy()}get extent(){return this.stateManager?.extent??null}set extent(e){this.stateManager.extent=e}get highlightOptions(){return Jr(this)}set highlightOptions(e){Xr(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:t}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=t}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||null===this.magnifier.position||!this._magnifierView?.updatingHandles.updating),t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((e=>!e.destroyed&&!("layerViews"in e)&&!0===e.updating))||e);if((0,n.a$)("esri-2d-log-updating")){const i=this.allLayerViews.reduce(((e,t)=>({...e,[`${t.layer.id}(${t.layer.type})`]:!t.destroyed&&!("layerViews"in t)&&t.updating})),{});console.log(`Updating MapView: ${t}\n-> Null LayerViewManager: ${!this.layerViewManager}\n-> Null LabelManager: ${!this.labelManager}\n-> Null GraphicsView: ${!this.graphicsView}\n-> layerViewManager.updating: ${this.layerViewManager?.updating}\n-> labelManager.updating: ${this.labelManager?.updating}\n-> graphicsView.updating: ${this.graphicsView?.updating}\n-> allLayerViews: ${JSON.stringify(i)}\n-> updatingMagnifier: ${e}\n`)}return t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new n.bC({rings:[e.map((e=>[e[0],e[1]]))],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}goTo(e,t){return this.goToManager.goTo(e,t)}async hitTest(e,t){return Yr(this,e,t)}async takeScreenshot(e){return ka(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const t=Pt(e)?St(this,e):e;return this.stateManager.toMap(t)}toScreen(e,t){return this.stateManager.toScreen(e,t)}on(e,t,i,n){return this.inputManager&&this.viewEvents.on(e,t,i,n)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Gl(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Gl(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return So.hasLayerViewModule(e)}importLayerView(e){return So.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(n.n.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const t=this.toMap(e),i=await this.hitTest(e),n=this.allLayerViews.toArray().filter((i=>i.clips.every((i=>jr(this,i,e,t))))).reverse(),o=new globalThis.Map(n.map((e=>[e.layer.uid,e]))),s=[];let r=0,a=0;for(;r<i.results.length||a<n.length;){const e=i.results.at(r);if(e&&"graphic"!==e.type){++r;continue}const l=o.get((e?.layer??e?.graphic.layer)?.uid);if((!e||l)&&a<n.length&&n.at(a)!==l){const e=n.at(a);"fetchPopupFeaturesAtLocation"in e&&s.push({mapPoint:t,layerView:e}),++a}else e&&(s.push({graphic:e.graphic,layerView:l}),++r)}return{hits:s,location:t}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Aa(this.type);if((0,n.a$)("safari")&&(0,n.a$)("safari")<9&&(e=new n.s("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:(0,n.a$)("safari")})),null!=e)throw n.n.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return $l()}_getDefaultViewpoint(){const{constraints:e,initialExtent:t,map:i,padding:n,size:o}=this;if(!e)return null;const s=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,r=this.stateManager.getUserStartupOptions(this.size),a=s?.viewpoint,l=a?.targetGeometry?.extent??t,c=l?.center,h=a?.rotation??0,u=a?.scale||l&&Ri(l,[o[0]-n.left-n.right,o[1]-n.top-n.bottom]),d=r.center??c,p=r.rotation??h,m=r.scale??u;return d&&m?new j({targetGeometry:d,scale:m,rotation:p}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const t=new Wl(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=t,this._magnifierView=new Bl,this._magnifierView.magnifier=this.magnifier,this._gridView=new Kl;const i=new jl({view:this});this._set("labelManager",i);const o=new yo({view:this});this._set("animationManager",o);const s=new ql({view:this,animationManager:o});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("webgl-error",(e=>this.fatalError=e.error)),(0,n.aE)((()=>this.stationary),(e=>t.stationary=e),n.f1),(0,n.aE)((()=>this.background),(e=>{t.backgroundColor=e?.color,this._magnifierView.backgroundColor=e?.color}),n.f1),(0,n.aE)((()=>this.magnifier),(e=>this._magnifierView.magnifier=e),n.f1),(0,n.aE)((()=>this.grid),(e=>this._gridView.grid=e),n.f1),(0,n.aE)((()=>this.renderingOptions),(e=>t.renderingOptions=e),n.f1),(0,n.aE)((()=>this.highlights.items.map((e=>({name:e.name,options:{fillColor:e.options.color,haloColor:e.options.haloColor,fillOpacity:e.options.fillOpacity,haloOpacity:e.options.haloOpacity,haloWidth:e.options.haloWidth,haloBlur:e.options.haloBlur}})))),(()=>{t.highlightGradient=Gr(t.highlightGradient,this.highlights.items)}),n.f1),(0,n.aE)((()=>this.state.id),(()=>t.state=this.state),n.f1)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach((e=>e(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this.stage.addChild(e.container)}));const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new T.h(l.z.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new Ul({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Zl(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:t,padding:i,size:n,stage:o}=this;return{allLayerViews:t,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:n,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const e of this.allLayerViews)e.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const e of this.allLayerViews)e.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Jl.type="2d",(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"animationManager",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],Jl.prototype,"deactivatedWebGLExtensions",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],Jl.prototype,"debugWebGLExtensions",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"featuresTilingScheme",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"fullOpacity",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"goToManager",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"graphicsTileStore",null),(0,n.k)([(0,n.o)()],Jl.prototype,"graphicsView",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"stateManager",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"constraintsInfo",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"state",null),(0,n.k)([(0,n.o)()],Jl.prototype,"initialExtentRequired",null),(0,n.k)([(0,n.o)()],Jl.prototype,"labelManager",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"mapViewNavigation",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],Jl.prototype,"renderCanvas",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"renderingOptions",void 0),(0,n.k)([(0,n.o)({constructOnly:!0})],Jl.prototype,"supersampleScreenshotsEnabled",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"supportsGround",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"defaultsFromMapSettings",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"typeSpecificPreconditionsReady",null),(0,n.k)([(0,n.o)()],Jl.prototype,"animation",null),(0,n.k)([(0,n.o)({type:z["default"]})],Jl.prototype,"background",null),(0,n.k)([(0,n.o)()],Jl.prototype,"center",null),(0,n.k)([(0,n.o)({type:No})],Jl.prototype,"constraints",null),(0,n.k)([(0,n.o)()],Jl.prototype,"extent",null),(0,n.k)([(0,n.o)()],Jl.prototype,"floors",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"grid",void 0),(0,n.k)([(0,n.o)({type:hr})],Jl.prototype,"highlightOptions",null),(0,n.k)([(0,n.o)({type:n.V.ofType(Br)})],Jl.prototype,"highlights",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"inputManager",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"map",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"padding",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"rendering",null),(0,n.k)([(0,n.o)()],Jl.prototype,"resizeAlign",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"resolution",null),(0,n.k)([(0,n.o)()],Jl.prototype,"rotation",null),(0,n.k)([(0,n.o)()],Jl.prototype,"scale",null),(0,n.k)([(0,n.o)({constructOnly:!0})],Jl.prototype,"spatialReferenceLocked",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"stationary",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"tileInfo",null),(0,n.k)([(0,n.o)({type:Ia,readOnly:!0})],Jl.prototype,"timeline",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"type",void 0),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"updating",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"view2dType",void 0),(0,n.k)([(0,n.o)()],Jl.prototype,"viewpoint",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"visibleArea",null),(0,n.k)([(0,n.o)()],Jl.prototype,"zoom",null),(0,n.k)([(0,n.o)({readOnly:!0})],Jl.prototype,"navigating",null),(0,n.k)([(0,n.o)(),(0,n.by)((e=>e instanceof Nl?e:(0,n.cG)(Fl,e)))],Jl.prototype,"ui",void 0),Jl=(0,n.k)([(0,n.A)("esri.views.View2D")],Jl);const Xl=Jl;let Yl=class extends Xl{constructor(e){super(e),this.view2dType="map"}};(0,n.k)([(0,n.o)({readOnly:!0})],Yl.prototype,"view2dType",void 0),Yl=(0,n.k)([(0,n.A)("esri.views.MapView")],Yl);const Ql=Yl,ec=Object.freeze(Object.defineProperty({__proto__:null,default:Ql},Symbol.toStringTag,{value:"Module"}))},50257:function(e,t,i){i.d(t,{i:function(){return r},m:function(){return l},o:function(){return s},p:function(){return d},r:function(){return o}});var n=i(98503);const o={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function s(e,t,i,o=n.dL){const s=new n.a6((0,n.dK)(o)),r=n.at.fromJSDate(e,{zone:s}),a="decades"===i||"centuries"===i?"year":c(i);return"decades"===i&&(t*=10),"centuries"===i&&(t*=100),r.plus({[a]:t}).toJSDate()}function r(e,t,i="milliseconds"){const n=e.getTime(),o=l(t,i,"milliseconds");return new Date(n+o)}function a(e,t,i=n.dL){const o=new n.a6((0,n.dK)(i)),s=n.at.fromJSDate(e,{zone:o});if("decades"===t||"centuries"===t){const e=s.startOf("year"),{year:i}=e,n=i-i%("decades"===t?10:100);return e.set({year:n}).toJSDate()}const r=c(t);return s.startOf(r).toJSDate()}function l(e,t,i){return 0===e?0:e*o[t]/o[i]}function c(e){switch(e){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var h;let u=h=class extends n.v{static get allTime(){return p}static get empty(){return m}static fromArray(e){return new h({start:null!=e[0]?new Date(e[0]):e[0],end:null!=e[1]?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?.getTime()??null}get isAllTime(){return this.equals(h.allTime)}get isEmpty(){return this.equals(h.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?.getTime()??null}clone(){return new h({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,n=e.start?.getTime()??e.start,o=e.end?.getTime()??e.end;return t===n&&i===o}expandTo(e,t=n.dL){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=a(i,e,t));let o=this.end;if(o){const i=a(o,e,t);o=o.getTime()===i.getTime()?i:s(i,1,e,t)}return new h({start:i,end:o})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return h.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,n=e.start?.getTime()??-1/0,o=e.end?.getTime()??1/0;let s,r;return n>=t&&n<=i?s=n:t>=n&&t<=o&&(s=t),i>=n&&i<=o?r=i:o>=t&&o<=i&&(r=o),null==s||null==r||isNaN(s)||isNaN(r)?h.empty:new h({start:s===-1/0?null:new Date(s),end:r===1/0?null:new Date(r)})}offset(e,t,i=n.dL){if(this.isEmpty||this.isAllTime)return this.clone();const o=new h,{start:r,end:a}=this;return null!=r&&(o.start=s(r,e,t,i)),null!=a&&(o.end=s(a,e,t,i)),o}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return p.clone();const t=null!=this.start&&null!=e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=null!=this.end&&null!=e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new h({start:t,end:i})}};(0,n.k)([(0,n.o)({type:Date,json:{write:{allowNull:!0}}})],u.prototype,"end",void 0),(0,n.k)([(0,n.u)("end")],u.prototype,"readEnd",null),(0,n.k)([(0,n.q)("end")],u.prototype,"writeEnd",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],u.prototype,"isAllTime",null),(0,n.k)([(0,n.o)({readOnly:!0,json:{read:!1}})],u.prototype,"isEmpty",null),(0,n.k)([(0,n.o)({type:Date,json:{write:{allowNull:!0}}})],u.prototype,"start",void 0),(0,n.k)([(0,n.u)("start")],u.prototype,"readStart",null),(0,n.k)([(0,n.q)("start")],u.prototype,"writeStart",null),u=h=(0,n.k)([(0,n.A)("esri.time.TimeExtent")],u);const d=u,p=new u,m=new u({start:void 0,end:void 0})},22676:function(e,t,i){i.d(t,{r:function(){return o}});var n=i(98503);let o=class e{constructor(e,t,i=""){this.major=e,this.minor=t,this._context=i}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}greaterEqual(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",i=this._context&&this._context+" ";throw new n.s(t+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new e(this.major,this.minor,this._context)}static parse(t,i=""){const[o,s]=t.split("."),r=/^\s*\d+\s*$/;if(!o?.match||!r.test(o))throw new n.s((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!s?.match||!r.test(s))throw new n.s((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const a=parseInt(o,10),l=parseInt(s,10);return new e(a,l,i)}}},56707:function(e,t,i){var n;i.d(t,{l:function(){return n}}),function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"}(n||(n={}))},85675:function(e,t,i){let n;function o(){return n||(n=a()),n}i.d(t,{t:function(){return o}});class s{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}}function r(e){if(typeof WebGL2RenderingContext>"u")return null;const t=document.createElement("canvas");if(!t)return null;let i=t.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(null==i&&(i=t.getContext("webgl2"),null!=i&&(e.majorPerformanceCaveat=!0)),null==i)return i;e.available=!0,e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return n&&(e.supportsHighPrecisionFragment=n.precision>0),i}function a(){const e=new s,t=r(e);return null==t||(e.supportsColorBufferFloat=null!==t.getExtension("EXT_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==t.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||null!==t.getExtension("EXT_color_buffer_half_float")),e}},49329:function(e,t,i){i.d(t,{n:function(){return n},o:function(){return o}});i(98503);function n(e){}function o(e){return()=>e}},22555:function(e,t,i){i.d(t,{i:function(){return o}});var n=i(98503);const o=new n.ax({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},74855:function(e,t,i){i.d(t,{c:function(){return a},p:function(){return u},s:function(){return r}});var n=i(98503);let o=null,s=!0;function r(e,t,i){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(s)try{return new ImageData(e,t)}catch{s=!1}return c(e,t,i)}function a(e,t,i,n){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(s)try{return new ImageData(e,t,i)}catch{s=!1}const o=c(t,i,n);return o.data.set(e,0),o}function l(){return o||(o=document.createElement("canvas"),o.width=1,o.height=1),o}function c(e,t,i){return i||(i=l()),i.getContext("2d").createImageData(e,t)}async function h(e,t){const i=window.URL.createObjectURL(e);try{const{data:e}=await(0,n.U)(i,{...t,responseType:"image"});return e}catch(o){throw(0,n.E)(o)?o:new n.s("invalid-image",`Could not fetch requested image at ${i}`)}finally{window.URL.revokeObjectURL(i)}}async function u(e,t){const{arrayBuffer:n,mediaType:o}=await d(e,t),s="image/png"===o;if("image/gif"===o){const{isAnimatedGIF:e,parseGif:o}=await i.e(4220).then(i.bind(i,54220));if(e(n))return o(n,t)}if(s){const{isAnimatedPNG:e,parseApng:o}=await i.e(8483).then(i.bind(i,8483));if(e(n))return o(n,t)}return h(new Blob([n],{type:o}),t)}async function d(e,t){const i=(0,n.aU)(e);if(i?.isBase64)return{arrayBuffer:(0,n.aV)(i.data),mediaType:i.mediaType};const o=await(0,n.U)(e,{responseType:"array-buffer",...t});return{arrayBuffer:o.data,mediaType:o.getHeader?.("Content-Type")??""}}},69852:function(e,t,i){i.d(t,{M:function(){return p},b:function(){return f},c:function(){return h},f:function(){return g},h:function(){return m},i:function(){return d},j:function(){return M},l:function(){return y},m:function(){return v},n:function(){return o},o:function(){return a},p:function(){return b},r:function(){return r},s:function(){return c},u:function(){return l}});var n=i(25209);function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function r(e,t,i,n,o,s,r,a,l,c){return e[0]=t,e[1]=i,e[2]=n,e[3]=o,e[4]=s,e[5]=r,e[6]=a,e[7]=l,e[8]=c,e}function a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function l(e,t){if(e===t){const i=t[1],n=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function c(e,t){const i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=h*r-a*c,d=-h*s+a*l,p=c*s-r*l;let m=i*u+n*d+o*p;return m?(m=1/m,e[0]=u*m,e[1]=(-h*n+o*c)*m,e[2]=(a*n-o*r)*m,e[3]=d*m,e[4]=(h*i-o*l)*m,e[5]=(-a*i+o*s)*m,e[6]=p*m,e[7]=(-c*i+n*l)*m,e[8]=(r*i-n*s)*m,e):null}function h(e,t){const i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=t[5],l=t[6],c=t[7],h=t[8];return e[0]=r*h-a*c,e[1]=o*c-n*h,e[2]=n*a-o*r,e[3]=a*l-s*h,e[4]=i*h-o*l,e[5]=o*s-i*a,e[6]=s*c-r*l,e[7]=n*l-i*c,e[8]=i*r-n*s,e}function u(e){const t=e[0],i=e[1],n=e[2],o=e[3],s=e[4],r=e[5],a=e[6],l=e[7],c=e[8];return t*(c*s-r*l)+i*(-c*o+r*a)+n*(l*o-s*a)}function d(e,t,i){const n=t[0],o=t[1],s=t[2],r=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=i[0],p=i[1],m=i[2],g=i[3],f=i[4],y=i[5],v=i[6],_=i[7],w=i[8];return e[0]=d*n+p*r+m*c,e[1]=d*o+p*a+m*h,e[2]=d*s+p*l+m*u,e[3]=g*n+f*r+y*c,e[4]=g*o+f*a+y*h,e[5]=g*s+f*l+y*u,e[6]=v*n+_*r+w*c,e[7]=v*o+_*a+w*h,e[8]=v*s+_*l+w*u,e}function p(e,t,i){const n=t[0],o=t[1],s=t[2],r=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=i[0],p=i[1];return e[0]=n,e[1]=o,e[2]=s,e[3]=r,e[4]=a,e[5]=l,e[6]=d*n+p*r+c,e[7]=d*o+p*a+h,e[8]=d*s+p*l+u,e}function m(e,t,i){const n=t[0],o=t[1],s=t[2],r=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=Math.sin(i),p=Math.cos(i);return e[0]=p*n+d*r,e[1]=p*o+d*a,e[2]=p*s+d*l,e[3]=p*r-d*n,e[4]=p*a-d*o,e[5]=p*l-d*s,e[6]=c,e[7]=h,e[8]=u,e}function g(e,t,i){const n=i[0],o=i[1],s=i[2];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=s*t[6],e[7]=s*t[7],e[8]=s*t[8],e}function f(e,t,i){const n=i[0],o=i[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e}function y(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function v(e,t){const i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function _(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function w(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function b(e,t){const i=t[0],n=t[1],o=t[2],s=t[3],r=i+i,a=n+n,l=o+o,c=i*r,h=n*r,u=n*a,d=o*r,p=o*a,m=o*l,g=s*r,f=s*a,y=s*l;return e[0]=1-u-m,e[3]=h-y,e[6]=d+f,e[1]=h+y,e[4]=1-c-m,e[7]=p-g,e[2]=d-f,e[5]=p+g,e[8]=1-c-u,e}function k(e,t){const i=t[0],n=t[1],o=t[2],s=t[4],r=t[5],a=t[6],l=t[8],c=t[9],h=t[10],u=h*r-a*c,d=-h*s+a*l,p=c*s-r*l,m=i*u+n*d+o*p;if(!m)return null;const g=1/m;return e[0]=u*g,e[1]=(-h*n+o*c)*g,e[2]=(a*n-o*r)*g,e[3]=d*g,e[4]=(h*i-o*l)*g,e[5]=(-a*i+o*s)*g,e[6]=p*g,e[7]=(-c*i+n*l)*g,e[8]=(r*i-n*s)*g,e}function M(e,t){const i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=t[9],d=t[10],p=t[11],m=t[12],g=t[13],f=t[14],y=t[15],v=i*a-n*r,_=i*l-o*r,w=i*c-s*r,b=n*l-o*a,k=n*c-s*a,M=o*c-s*l,T=h*g-u*m,S=h*f-d*m,P=h*y-p*m,x=u*f-d*g,C=u*y-p*g,E=d*y-p*f;let R=v*E-_*C+w*x+b*P-k*S+M*T;return R?(R=1/R,e[0]=(a*E-l*C+c*x)*R,e[1]=(l*P-r*E-c*S)*R,e[2]=(r*C-a*P+c*T)*R,e[3]=(o*C-n*E-s*x)*R,e[4]=(i*E-o*P+s*S)*R,e[5]=(n*P-i*C-s*T)*R,e[6]=(g*M-f*k+y*b)*R,e[7]=(f*w-m*M-y*_)*R,e[8]=(m*k-g*w+y*v)*R,e):null}function T(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function S(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function P(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function x(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function C(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function E(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function R(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e[4]=t[4]+i[4]*n,e[5]=t[5]+i[5]*n,e[6]=t[6]+i[6]*n,e[7]=t[7]+i[7]*n,e[8]=t[8]+i[8]*n,e}function I(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function A(e,t){const i=e[0],o=e[1],s=e[2],r=e[3],a=e[4],l=e[5],c=e[6],h=e[7],u=e[8],d=t[0],p=t[1],m=t[2],g=t[3],f=t[4],y=t[5],v=t[6],_=t[7],w=t[8],b=(0,n.e)();return Math.abs(i-d)<=b*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=b*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-m)<=b*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(r-g)<=b*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(a-f)<=b*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(l-y)<=b*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-v)<=b*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-_)<=b*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(u-w)<=b*Math.max(1,Math.abs(u),Math.abs(w))}function L(e){const t=(0,n.e)(),i=e[0],o=e[1],s=e[2],r=e[3],a=e[4],l=e[5],c=e[6],h=e[7],u=e[8];return Math.abs(1-(i*i+r*r+c*c))<=t&&Math.abs(1-(o*o+a*a+h*h))<=t&&Math.abs(1-(s*s+l*l+u*u))<=t}const D=d,O=C;Object.freeze(Object.defineProperty({__proto__:null,add:x,adjoint:h,copy:s,determinant:u,equals:A,exactEquals:I,frob:P,fromMat2d:w,fromMat4:o,fromQuat:b,fromRotation:v,fromScaling:_,fromTranslation:y,identity:a,invert:c,isOrthoNormal:L,mul:D,multiply:d,multiplyScalar:E,multiplyScalarAndAdd:R,normalFromMat4:M,normalFromMat4Legacy:k,projection:T,rotate:m,scale:g,scaleByVec2:f,set:r,str:S,sub:O,subtract:C,translate:p,transpose:l},Symbol.toStringTag,{value:"Module"}))},85502:function(e,t,i){i.r(t),i.d(t,{E:function(){return B},F:function(){return p},G:function(){return d},L:function(){return u},N:function(){return h},d:function(){return c},e:function(){return q},i:function(){return o},l:function(){return j},n:function(){return te},p:function(){return ie},t:function(){return s}});var n=i(98503);const o=Math.PI/180,s=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,r=n.a3.radius,a=n.a3.eccentricitySquared,l={a1:r*a,a2:r*a*r*a,a3:r*a*a/2,a4:r*a*r*a*2.5,a5:r*a+r*a*a/2,a6:1-a},c={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:n.a3.radius,f:n.a3.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:n.fs.radius,f:n.fs.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:n.ft.radius,f:n.ft.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:n.ft.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var h;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",e[e.WGS84=2]="WGS84",e[e.WEB_MERCATOR=3]="WEB_MERCATOR",e[e.WGS84_ECEF=4]="WGS84_ECEF",e[e.CGCS2000=5]="CGCS2000",e[e.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",e[e.GCSMARS2000=7]="GCSMARS2000",e[e.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",e[e.GCSMOON2000=9]="GCSMOON2000",e[e.LON_LAT=10]="LON_LAT",e[e.PLATE_CARREE=11]="PLATE_CARREE"})(h||(h={}));const u={[h.WGS84]:{[h.CGCS2000]:m,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:m,[h.SPHERICAL_ECEF]:I,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:_,[h.PLATE_CARREE]:w,[h.WGS84]:m,[h.WGS84_ECEF]:F},[h.CGCS2000]:{[h.CGCS2000]:m,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:m,[h.SPHERICAL_ECEF]:I,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:_,[h.PLATE_CARREE]:w,[h.WGS84]:m,[h.WGS84_ECEF]:F},[h.GCSMARS2000]:{[h.CGCS2000]:null,[h.GCSMARS2000]:m,[h.GCSMOON2000]:null,[h.LON_LAT]:m,[h.SPHERICAL_ECEF]:null,[h.SPHERICAL_MARS_PCPF]:R,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:null,[h.PLATE_CARREE]:null,[h.WGS84]:null,[h.WGS84_ECEF]:null},[h.GCSMOON2000]:{[h.CGCS2000]:null,[h.GCSMARS2000]:null,[h.GCSMOON2000]:m,[h.LON_LAT]:m,[h.SPHERICAL_ECEF]:null,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:E,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:null,[h.PLATE_CARREE]:null,[h.WGS84]:null,[h.WGS84_ECEF]:null},[h.WEB_MERCATOR]:{[h.CGCS2000]:g,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:g,[h.SPHERICAL_ECEF]:f,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:m,[h.PLATE_CARREE]:k,[h.WGS84]:g,[h.WGS84_ECEF]:y},[h.WGS84_ECEF]:{[h.CGCS2000]:H,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:H,[h.SPHERICAL_ECEF]:G,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:W,[h.PLATE_CARREE]:M,[h.WGS84]:H,[h.WGS84_ECEF]:m},[h.SPHERICAL_ECEF]:{[h.CGCS2000]:O,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:O,[h.SPHERICAL_ECEF]:m,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:V,[h.PLATE_CARREE]:T,[h.WGS84]:O,[h.WGS84_ECEF]:N},[h.SPHERICAL_MARS_PCPF]:{[h.CGCS2000]:null,[h.GCSMARS2000]:D,[h.GCSMOON2000]:null,[h.LON_LAT]:D,[h.SPHERICAL_ECEF]:null,[h.SPHERICAL_MARS_PCPF]:m,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:null,[h.PLATE_CARREE]:null,[h.WGS84]:null,[h.WGS84_ECEF]:null},[h.SPHERICAL_MOON_PCPF]:{[h.CGCS2000]:null,[h.GCSMARS2000]:null,[h.GCSMOON2000]:L,[h.LON_LAT]:L,[h.SPHERICAL_ECEF]:null,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:m,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:null,[h.PLATE_CARREE]:null,[h.WGS84]:null,[h.WGS84_ECEF]:null},[h.UNKNOWN]:{[h.CGCS2000]:null,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:null,[h.SPHERICAL_ECEF]:null,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:m,[h.WEB_MERCATOR]:null,[h.PLATE_CARREE]:null,[h.WGS84]:null,[h.WGS84_ECEF]:null},[h.LON_LAT]:{[h.CGCS2000]:m,[h.GCSMARS2000]:m,[h.GCSMOON2000]:m,[h.LON_LAT]:m,[h.SPHERICAL_ECEF]:I,[h.SPHERICAL_MARS_PCPF]:R,[h.SPHERICAL_MOON_PCPF]:E,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:_,[h.PLATE_CARREE]:w,[h.WGS84]:m,[h.WGS84_ECEF]:F},[h.PLATE_CARREE]:{[h.CGCS2000]:b,[h.GCSMARS2000]:null,[h.GCSMOON2000]:null,[h.LON_LAT]:b,[h.SPHERICAL_ECEF]:S,[h.SPHERICAL_MARS_PCPF]:null,[h.SPHERICAL_MOON_PCPF]:null,[h.UNKNOWN]:null,[h.WEB_MERCATOR]:P,[h.PLATE_CARREE]:m,[h.WGS84]:b,[h.WGS84_ECEF]:x}};function d(e,t,i=Z()){return null==e||null==t?null:U(e,t,i).projector}function p(e,t){return e?t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=(0,n.bq)(e,1)),(0,n.fv)(e)?t.spatialReferenceId=h.SPHERICAL_ECEF:(0,n.cb)(e)?t.spatialReferenceId=h.WGS84:(0,n.cL)(e)?t.spatialReferenceId=h.WEB_MERCATOR:(0,n.fw)(e)?t.spatialReferenceId=h.PLATE_CARREE:e.wkt===n.c4.wkt?t.spatialReferenceId=h.WGS84_ECEF:e.wkid===n.fx.CGCS2000?t.spatialReferenceId=h.CGCS2000:e.wkt===n.c2.wkt?t.spatialReferenceId=h.SPHERICAL_MARS_PCPF:e.wkt===n.c3.wkt?t.spatialReferenceId=h.SPHERICAL_MOON_PCPF:(0,n.eD)(e)?t.spatialReferenceId=h.GCSMARS2000:(0,n.eE)(e)?t.spatialReferenceId=h.GCSMOON2000:t.spatialReferenceId=h.UNKNOWN):h.UNKNOWN}function m(e,t,i,n){e!==i&&(i[n++]=e[t++],i[n++]=e[t++],i[n]=e[t])}function g(e,t,i,n){i[n]=$*(e[t]/Y),i[n+1]=$*(X-2*Math.atan(Math.exp(-e[t+1]/Y))),i[n+2]=e[t+2]}function f(e,t,i,n){const o=e[t]/Y,s=X-2*Math.atan(Math.exp(-e[t+1]/Y)),r=Y+e[t+2],a=Math.cos(s)*r;i[n]=Math.cos(o)*a,i[n+1]=Math.sin(o)*a,i[n+2]=Math.sin(s)*r}function y(e,t,i,n){g(e,t,i,n),F(i,n,i,n)}function v(e,t,i,o,s){const r=.4999999*J,a=(0,n.aP)(K*e[t+1],-r,r),l=Math.sin(a);i[o++]=K*e[t]*s.radius,i[o++]=s.halfSemiMajorAxis*Math.log((1+l)/(1-l)),i[o]=e[t+2]}function _(e,t,i,o){v(e,t,i,o,n.a3)}function w(e,t,i,n){i[n]=e[t]*Q,i[n+1]=e[t+1]*Q,i[n+2]=e[t+2]}function b(e,t,i,n){i[n]=e[t]*ee,i[n+1]=e[t+1]*ee,i[n+2]=e[t+2]}function k(e,t,i,n){g(e,t,i,n),w(i,n,i,n)}function M(e,t,i,n){H(e,t,i,n),w(i,n,i,n)}function T(e,t,i,n){O(e,t,i,n),w(i,n,i,n)}function S(e,t,i,n){b(e,t,i,n),I(i,n,i,n)}function P(e,t,i,n){b(e,t,i,n),_(i,n,i,n)}function x(e,t,i,n){b(e,t,i,n),F(i,n,i,n)}function C(e,t,i,n,o){const s=o+e[t+2],r=K*e[t+1],a=K*e[t],l=Math.cos(r)*s;i[n]=Math.cos(a)*l,i[n+1]=Math.sin(a)*l,i[n+2]=Math.sin(r)*s}function E(e,t,i,o){C(e,t,i,o,n.fs.radius)}function R(e,t,i,o){C(e,t,i,o,n.ft.radius)}function I(e,t,i,o){C(e,t,i,o,n.a3.radius)}function A(e,t,i,o,s){const r=e[t],a=e[t+1],l=e[t+2],c=Math.sqrt(r*r+a*a+l*l),h=(0,n.fu)(l/(0===c?1:c)),u=Math.atan2(a,r);i[o++]=$*u,i[o++]=$*h,i[o]=c-s}function L(e,t,i,o){A(e,t,i,o,n.fs.radius)}function D(e,t,i,o){A(e,t,i,o,n.ft.radius)}function O(e,t,i,o){A(e,t,i,o,n.a3.radius)}function V(e,t,i,n){O(e,t,i,n),_(i,n,i,n)}function N(e,t,i,n){O(e,t,i,n),F(i,n,i,n)}function z(e,t,i,n,o){const s=K*e[t],r=K*e[t+1],a=e[t+2],l=Math.sin(r),c=Math.cos(r),h=o.radius/Math.sqrt(1-o.eccentricitySquared*l*l);i[n++]=(h+a)*c*Math.cos(s),i[n++]=(h+a)*c*Math.sin(s),i[n++]=(h*(1-o.eccentricitySquared)+a)*l}function F(e,t,i,o){z(e,t,i,o,n.a3)}function H(e,t,i,o){const s=l,r=e[t],a=e[t+1],c=e[t+2];let h,u,d,p,m,g,f,y,v,_,w,b,k,M,T,S,P,x,C,E,R;h=Math.abs(c),u=r*r+a*a,d=Math.sqrt(u),p=u+c*c,m=Math.sqrt(p),E=Math.atan2(a,r),g=c*c/p,f=u/p,M=s.a2/m,T=s.a3-s.a4/m,f>.3?(y=h/m*(1+f*(s.a1+M+g*T)/m),C=Math.asin(y),_=y*y,v=Math.sqrt(1-_)):(v=d/m*(1-g*(s.a5-M-f*T)/m),C=Math.acos(v),_=1-v*v,y=Math.sqrt(_)),w=1-n.a3.eccentricitySquared*_,b=n.a3.radius/Math.sqrt(w),k=s.a6*b,M=d-b*v,T=h-k*y,P=v*M+y*T,S=v*T-y*M,x=S/(k/w+P),C+=x,R=P+S*x/2,c<0&&(C=-C),i[o++]=$*E,i[o++]=$*C,i[o]=R}function G(e,t,i,n){H(e,t,i,n),I(i,n,i,n)}function W(e,t,i,n){H(e,t,i,n),_(i,n,i,n)}function U(e,t,i){if(null==e||null==t||i.source.spatialReference===e&&i.dest.spatialReference===t)return i;const o=p(e,i.source),s=p(t,i.dest);return o===h.UNKNOWN&&s===h.UNKNOWN?(0,n.bh)(e,t)?i.projector=m:i.projector=null:i.projector=u[o][s],i}function Z(){return{source:{spatialReference:null,spatialReferenceId:h.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:h.UNKNOWN,metersPerUnit:1},projector:m}}const j={spatialReference:null,spatialReferenceId:h.UNKNOWN},q={spatialReference:null,spatialReferenceId:h.UNKNOWN},B=Z(),K=(0,n.eI)(1),$=(0,n.dg)(1),J=Math.PI,X=.5*J,Y=n.a3.radius,Q=Y*J/180,ee=180/(Y*J);function te(e,t,i,n,o,s,r=Math.floor(e.length/3)){const a=d(t,o,B);if(null==a)return!1;if(a===m){if(e===n&&i===s)return!0;const t=i+3*r;for(let o=i,r=s;o<t;o++,r++)n[r]=e[o];return!0}const l=i+3*r;for(let c=i,h=s;c<l;c+=3,h+=3)a(e,c,n,h);return!0}const ie=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:te},Symbol.toStringTag,{value:"Module"}))},49555:function(e,t,i){i.r(t),i.d(t,{B:function(){return M},H:function(){return O},J:function(){return N},K:function(){return P},L:function(){return z},N:function(){return F},O:function(){return x},Q:function(){return H},V:function(){return C},W:function(){return S},X:function(){return E},Y:function(){return R},_:function(){return b},a:function(){return B},o:function(){return h},p:function(){return Q},s:function(){return c}});var n=i(98503),o=i(85502);function s(e,t,i,n,s,a){return r[0]=e,r[1]=t,r[2]=i,(0,o.n)(r,n,0,s,a,0)}const r=(0,n.aA)();let a=0;class l{static fromGE(e){const t=new l;return t._wkt=e.wkt,t._wkid=e.wkid,t._isInverse=e.isInverse,t}constructor(e){this.uid=a++,e?(this._wkt=null!=e.wkt?e.wkt:null,this._wkid=null!=e.wkid?e.wkid:-1,this._isInverse=null!=e.isInverse&&!0===e.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=a++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=a++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=a++}getInverse(){const e=new l;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}}let c=class e{static cacheKey(e,t){return[e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??"",t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??""].join()}static fromGE(t){const i=new e;let n="";for(const e of t.steps){const t=l.fromGE(e);i.steps.push(t),n+=t.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=n,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e?.steps)for(const t of e.steps)t instanceof l?this.steps.push(t):this.steps.push(new l({wkid:t.wkid,wkt:t.wkt,isInverse:t.isInverse}))}getInverse(){const t=new e;t.steps=[];for(let e=this.steps.length-1;e>=0;e--){const i=this.steps[e];t.steps.push(i.getInverse())}return t}getGTListEntry(){let e="";for(const t of this.steps)e+=t.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(t,i,n){this._cachedProjection[e.cacheKey(t,i)]=n}getCachedGeTransformation(t,i){let n="";for(const e of this.steps)n+=e.uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=n);const o=this._cachedProjection[e.cacheKey(t,i)];return void 0===o?null:o}};function h(e,t,i){if(null==t||null==i||i.vcsWkid||(0,n.bh)(t,i)||(0,n.gK)(t)||(0,n.gK)(i))return null;const o=(0,n.bg)(t)/(0,n.bg)(i);if(1===o)return null;switch(e){case"point":case"esriGeometryPoint":return e=>u(e,o);case"polyline":case"esriGeometryPolyline":return e=>p(e,o);case"polygon":case"esriGeometryPolygon":return e=>d(e,o);case"multipoint":case"esriGeometryMultipoint":return e=>m(e,o);case"extent":case"esriGeometryEnvelope":return e=>g(e,o);default:return null}}function u(e,t){null!=e?.z&&(e.z*=t)}function d(e,t){if(e)for(const i of e.rings)for(const e of i)e.length>2&&(e[2]*=t)}function p(e,t){if(e)for(const i of e.paths)for(const e of i)e.length>2&&(e[2]*=t)}function m(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}function g(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}let f=null,y=null,v=null,_={};const w=new n.aQ;function b(){return!!f&&(0,n.gN)()}function k(){return!!b()||((0,n.aR)(w),S(),!1)}function M(e,t){return!e||!t||N(e,t)||k()}function T(e,t){return!N(e,t)&&!b()}function S(e){return null==v&&(v=Promise.all([(0,n.gL)(),Promise.all([i.e(916),i.e(2020)]).then(i.bind(i,90916)).then((e=>e.g)),i.e(6582).then(i.bind(i,6582))])),v.then((([,t,{hydratedAdapter:i}])=>{(0,n.D)(e),y=i,f=t.default,f._enableProjection(n.gM),w.notify()}))}function P(e,t,i=null,n=null){return Array.isArray(e)?0===e.length?[]:x(y,e,e[0].spatialReference,t,i,n):x(y,[e],e.spatialReference,t,i,n)[0]}function x(e,t,i,o,s=null,r=null){if(null==i||null==o)return t;if(N(i,o,s))return t.map((e=>H(e,i,o)));if(null==s&&(0,n.fv)(i))return t.map((e=>H(e,i,n.B.WGS84))).map((e=>O(e,o)));if(null==s&&(0,n.fv)(o))return t.map((e=>O(e,n.B.WGS84))).map((e=>H(e,n.B.WGS84,o)));if(null==s){const e=c.cacheKey(i,o);void 0!==_[e]?s=_[e]:(null==(s=R(i,o,void 0))&&(s=new c),_[e]=s)}if(null==f||null==e)throw new A;return null!=r?f._project(e,t,i,o,s,r):f._project(e,t,i,o,s)}function C(e,t){const i=E([e],t);return null!=i.pending?{pending:i.pending,geometry:null}:null!=i.geometries?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function E(e,t){if(!b())for(const i of e)if(null!=i&&!(0,n.bh)(i.spatialReference,t)&&(0,n.cg)(i.spatialReference)&&(0,n.cg)(t)&&!N(i.spatialReference,t))return(0,n.aR)(w),{pending:S(),geometries:null};return{pending:null,geometries:e.map((e=>null==e?null:(0,n.bh)(e.spatialReference,t)?e:(0,n.cg)(e.spatialReference)&&(0,n.cg)(t)?O(e,t):null))}}function R(e,t,i=null){if(null==e||null==t)return null;if(null==f||null==y)throw new A;const n=f._getTransformation(y,e,t,i,i?.spatialReference);return null!==n?c.fromGE(n):null}function I(e,t,i=null){if(null==f||null==y)throw new A;const n=f._getTransformationBySuitability(y,e,t,i,i?.spatialReference);if(null!==n){const e=[];for(const t of n)e.push(c.fromGE(t));return e}return[]}class A extends n.s{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function L(){f=null,y=null,v=null,_={}}const D={get loadPromise(){return v}};function O(e,t){try{const i=P(e,t);return null==i?null:("xmin"in e&&"xmin"in i&&(i.zmin=e.zmin,i.zmax=e.zmax),h(i.type,e.spatialReference,t)?.(i),i)}catch(i){if(!(i instanceof A))throw i;return null}}async function V(e,t,i){const n=e.spatialReference;return null!=n&&null!=t&&await F(n,t,null,i),O(e,t)}function N(e,t,i){return!i&&(!!(0,n.bh)(e,t)||(0,n.cg)(e)&&(0,n.cg)(t)&&!!(0,o.G)(e,t,o.E))}function z(e,t){if((0,n.bh)(e,t))return!0;if(!(0,n.cg)(e)||!(0,n.cg)(t))return!1;const i=(0,n.cb)(e)||(0,n.cL)(e)||(0,n.eC)(e),o=(0,n.cb)(t)||(0,n.cL)(t)||(0,n.eC)(t);return i&&o}async function F(e,t,i,o){if(b())return(0,n.O)(o);if(Array.isArray(e)){for(const{source:n,dest:s,geographicTransformation:r}of e)if(n&&s&&!N(n,s,r))return S(o)}else if(e&&t&&!N(e,t,i))return S(o);return(0,n.O)(o)}function H(e,t,i){return e?"x"in e?W(e,t,new n.bv,i,0):"xmin"in e?J(e,t,new n.au,i,0):"rings"in e?K(e,t,new n.bC,i,0):"paths"in e?q(e,t,new n.aT,i,0):"points"in e?Z(e,t,new n.bD,i,0):null:null}function G(e,t,i=t.spatialReference,n=0){return null!=i&&null!=e.spatialReference&&null!=W(e,e.spatialReference,t,i,n)}function W(e,t,i,s,r){Y[0]=e.x,Y[1]=e.y;const a=e.z;return Y[2]=void 0!==a?a:r,(0,o.n)(Y,t,0,Y,s,0)?(i.x=Y[0],i.y=Y[1],i.spatialReference=s,void 0!==a||(0,n.gK)(s)?(i.z=Y[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),void 0===e.m?(i.m=void 0,i.hasM=!1):(i.m=e.m,i.hasM=!0),i):null}function U(e,t,i=t.spatialReference,n=0){return null!=e.spatialReference&&null!=i&&null!=Z(e,e.spatialReference,t,i,n)}function Z(e,t,i,s,r){const{points:a,hasZ:l,hasM:c}=e,h=[],u=a.length,d=[];for(const n of a)d.push(n[0],n[1],l?n[2]:r);if(!(0,o.n)(d,t,0,d,s,0,u))return null;const p=l||(0,n.gK)(s);for(let n=0;n<u;++n){const e=3*n,t=d[e],i=d[e+1];p&&c?h.push([t,i,d[e+2],a[n][3]]):p?h.push([t,i,d[e+2]]):c?h.push([t,i,a[n][2]]):h.push([t,i])}return i.points=h,i.spatialReference=s,i.hasZ=l,i.hasM=c,i}function j(e,t,i=t.spatialReference,n=0){return null!=e.spatialReference&&null!=i&&null!=q(e,e.spatialReference,t,i,n)}function q(e,t,i,o,s){const{paths:r,hasZ:a,hasM:l}=e,c=[];if(!X(r,a??!1,l??!1,t,c,o,s))return null;const h=a||(0,n.gK)(o);return i.paths=c,i.spatialReference=o,i.hasZ=h,i.hasM=l,i}function B(e,t,i=t.spatialReference,n=0){return null!=e.spatialReference&&null!=i&&null!=K(e,e.spatialReference,t,i,n)}function K(e,t,i,o,s){const{rings:r,hasZ:a,hasM:l}=e,c=[];if(!X(r,a??!1,l??!1,t,c,o,s))return null;const h=a||(0,n.gK)(o);return i.rings=c,i.spatialReference=o,i.hasZ=h,i.hasM=l,i}function $(e,t,i=t.spatialReference,n=0){return null!=e.spatialReference&&null!=i&&null!=J(e,e.spatialReference,t,i,n)}function J(e,t,i,o,r){const{xmin:a,ymin:l,xmax:c,ymax:h,hasZ:u,hasM:d}=e,p=u?e.zmin:r;if(!s(a,l,p,t,Y,o))return null;const m=u||(0,n.gK)(o);i.xmin=Y[0],i.ymin=Y[1],m&&(i.zmin=Y[2]);const g=u?e.zmax:r;return s(c,h,g,t,Y,o)?(i.xmax=Y[0],i.ymax=Y[1],m&&(i.zmax=Y[2]),d&&(i.mmin=e.mmin,i.mmax=e.mmax),i.spatialReference=o,i):null}function X(e,t,i,s,r,a,l=0){const c=new Array;for(const n of e)for(const e of n)c.push(e[0],e[1],t?e[2]:l);if(!(0,o.n)(c,s,0,c,a,0))return!1;let h=0;r.length=0;const u=t||(0,n.gK)(a);for(const n of e){const e=new Array;for(const t of n)u&&i?e.push([c[h++],c[h++],c[h++],t[3]]):u?e.push([c[h++],c[h++],c[h++]]):i?(e.push([c[h++],c[h++],t[2]]),h++):(e.push([c[h++],c[h++]]),h++);r.push(e)}return!0}const Y=(0,n.aA)(),Q=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:N,getTransformation:R,getTransformations:I,initializeProjection:F,isEqualBaseGCS:z,isLoaded:b,isLoadedOrLoad:k,isLoadedOrLoadFor:M,load:S,project:P,projectExtent:$,projectMany:x,projectMultipoint:U,projectOrLoad:C,projectOrLoadMany:E,projectPoint:G,projectPolygon:B,projectPolyline:j,projectWithZConversion:V,projectWithoutEngine:H,requiresLoad:T,test:D,tryProjectWithZConversion:O,unload:L},Symbol.toStringTag,{value:"Module"}))},6780:function(e,t,i){function n(e,t,i,n){const o=3*e,s=3*(i-e)-o,r=1-o-s,a=3*t,l=3*(n-t)-a,c=1-a-l;function h(e){return((r*e+s)*e+o)*e}function u(e){return((c*e+l)*e+a)*e}function d(e){return(3*r*e+2*s)*e+o}function p(e,t){let i,n,o,s,r,a;for(o=e,a=0;a<8;a++){if(s=h(o)-e,Math.abs(s)<t)return o;if(r=d(o),Math.abs(r)<1e-6)break;o-=s/r}if(i=0,n=1,o=e,o<i)return i;if(o>n)return n;for(;i<n;){if(s=h(o),Math.abs(s-e)<t)return o;e>s?i=o:n=o,o=.5*(n-i)+i}return o}return function(e,t=1e-6){return u(p(e,t))}}i.d(t,{e:function(){return n},r:function(){return r},t:function(){return s}});const o=/^cubic-bezier\((.*)\)/,s={};function r(e){let t=s[e]||null;if(!t){const i=o.exec(e);if(i){const e=i[1].split(",").map((e=>parseFloat(e.trim())));4!==e.length||e.some((e=>isNaN(e)))||(t=n.apply(n,e))}}return t}s.ease=n(.25,.1,.25,1),s.linear=n(0,0,1,1),s.easeIn=s["ease-in"]=n(.42,0,1,1),s.easeOut=s["ease-out"]=n(0,0,.58,1),s.easeInOut=s["ease-in-out"]=n(.42,0,.58,1)},92157:function(e,t,i){i.d(t,{A:function(){return x},E:function(){return O},H:function(){return j},I:function(){return I},J:function(){return q},K:function(){return B},N:function(){return V},P:function(){return C},Q:function(){return N},R:function(){return K},W:function(){return X},X:function(){return Y},Y:function(){return Q},Z:function(){return ee},_:function(){return E},c:function(){return c},d:function(){return y},e:function(){return h},f:function(){return m},g:function(){return w},i:function(){return u},j:function(){return T},l:function(){return f},m:function(){return g},o:function(){return a},p:function(){return k},q:function(){return b},r:function(){return s},s:function(){return r},u:function(){return l},v:function(){return M},w:function(){return H},y:function(){return S},z:function(){return P}});var n=i(98503),o=i(25209);function s(e){const t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)}function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e}function l(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function c(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function h(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function u(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function d(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function p(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function m(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e}function g(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e}function f(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function y(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function v(e,t=0,i=1){return e[0]=Math.min(Math.max(e[0],t),i),e[1]=Math.min(Math.max(e[1],t),i),e[2]=Math.min(Math.max(e[2],t),i),e}function _(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function w(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function b(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e}function k(e,t){const i=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(i*i+n*n+o*o)}function M(e,t){const i=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return i*i+n*n+o*o}function T(e){const t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n}function S(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function P(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function x(e,t){const i=t[0],n=t[1],o=t[2];let s=i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s),e}function C(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function E(e,t,i){const n=t[0],o=t[1],s=t[2],r=i[0],a=i[1],l=i[2];return e[0]=o*l-s*a,e[1]=s*r-n*l,e[2]=n*a-o*r,e}function R(e,t,i){const n=t[0],o=t[1],s=t[2],r=i[0],a=i[1],l=i[2],c=o*l-s*a,h=s*r-n*l,u=n*a-o*r,d=Math.sqrt(c*c+h*h+u*u);return e[0]=c/d,e[1]=h/d,e[2]=u/d,e}function I(e,t,i,n){const o=t[0],s=t[1],r=t[2];return e[0]=o+n*(i[0]-o),e[1]=s+n*(i[1]-s),e[2]=r+n*(i[2]-r),e}function A(e,t,i,n,o,s){const r=s*s,a=r*(2*s-3)+1,l=r*(s-2)+s,c=r*(s-1),h=r*(3-2*s);return e[0]=t[0]*a+i[0]*l+n[0]*c+o[0]*h,e[1]=t[1]*a+i[1]*l+n[1]*c+o[1]*h,e[2]=t[2]*a+i[2]*l+n[2]*c+o[2]*h,e}function L(e,t,i,n,o,s){const r=1-s,a=r*r,l=s*s,c=a*r,h=3*s*a,u=3*l*r,d=l*s;return e[0]=t[0]*c+i[0]*h+n[0]*u+o[0]*d,e[1]=t[1]*c+i[1]*h+n[1]*u+o[1]*d,e[2]=t[2]*c+i[2]*h+n[2]*u+o[2]*d,e}function D(e,t=1){const i=o.o,n=2*i()*Math.PI,s=2*i()-1,r=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(n)*r,e[1]=Math.sin(n)*r,e[2]=s*t,e}function O(e,t,i){const n=t[0],o=t[1],s=t[2];return e[0]=i[0]*n+i[4]*o+i[8]*s+i[12],e[1]=i[1]*n+i[5]*o+i[9]*s+i[13],e[2]=i[2]*n+i[6]*o+i[10]*s+i[14],e}function V(e,t,i){const n=t[0],o=t[1],s=t[2];return e[0]=n*i[0]+o*i[3]+s*i[6],e[1]=n*i[1]+o*i[4]+s*i[7],e[2]=n*i[2]+o*i[5]+s*i[8],e}function N(e,t,i){const n=i[0],o=i[1],s=i[2],r=i[3],a=t[0],l=t[1],c=t[2],h=o*c-s*l,u=s*a-n*c,d=n*l-o*a,p=o*d-s*u,m=s*h-n*d,g=n*u-o*h,f=2*r;return e[0]=a+h*f+2*p,e[1]=l+u*f+2*m,e[2]=c+d*f+2*g,e}function z(e,t,i,n){const o=[],s=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],s[0]=o[0],s[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),s[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2],e}function F(e,t,i,n){const o=[],s=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],s[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),s[1]=o[1],s[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2],e}function H(e,t,i,n){const o=[],s=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],s[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),s[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),s[2]=o[2],e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2],e}function G(e,t){x(W,e),x(U,t);const i=C(W,U);return i>1?0:i<-1?Math.PI:Math.acos(i)}const W=(0,n.aA)(),U=(0,n.aA)();function Z(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function j(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function q(e,t){if(e===t)return!0;const i=e[0],n=e[1],s=e[2],r=t[0],a=t[1],l=t[2],c=(0,o.e)();return Math.abs(i-r)<=c*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(n-a)<=c*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-l)<=c*Math.max(1,Math.abs(s),Math.abs(l))}function B(e,t,i){const n=i[0]-t[0],o=i[1]-t[1],s=i[2]-t[2];let r=n*n+o*o+s*s;return r>0?(r=1/Math.sqrt(r),e[0]=n*r,e[1]=o*r,e[2]=s*r,e):(e[0]=0,e[1]=0,e[2]=0,e)}const K=c,$=h,J=u,X=k,Y=M,Q=s,ee=T;Object.freeze(Object.defineProperty({__proto__:null,abs:m,add:l,angle:G,bezier:L,ceil:d,clamp:v,copy:r,cross:E,crossAndNormalize:R,direction:B,dist:X,distance:k,div:J,divide:u,dot:C,equals:q,exactEquals:j,floor:p,hermite:A,inverse:P,len:Q,length:s,lerp:I,max:y,min:f,mul:$,multiply:h,negate:S,normalize:x,random:D,rotateX:z,rotateY:F,rotateZ:H,round:_,scale:w,scaleAndAdd:b,set:a,sign:g,sqrDist:Y,sqrLen:ee,squaredDistance:M,squaredLength:T,str:Z,sub:K,subtract:c,transformMat3:V,transformMat4:O,transformQuat:N},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=9323.980e5e6c.js.map