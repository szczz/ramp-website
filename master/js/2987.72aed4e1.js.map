{"version":3,"file":"js/2987.72aed4e1.js","mappings":"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","sources":["webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/featureLayerUtils-BMlEMDol.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/jsonContext-Cs3DKlwE.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/multiOriginJSONSupportUtils-DGETddQl.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/originUtils-BLsWtgV9.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/saveUtils-5YmoVD4N.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/utils-Dgmsa-EC.js"],"sourcesContent":["import{cY as S,cZ as w,c_ as N}from\"./main-I34c1W55.js\";import{P as O,$ as R}from\"./utils-Dgmsa-EC.js\";import{d as x}from\"./arcgisLayerUrl-BTWijBPh.js\";import{a as D,b as Y,i as _}from\"./fetchService-Cn-JonIP.js\";import{l as J,a as d,i as M,u as f,f as l}from\"./portalItemUtils-B5LG5xsT.js\";const m=\"Feature Service\",p=\"feature-layer-utils\",$=`${p}-save`,g=`${p}-save-as`;function I(e){return{isValid:S(e)&&(!(\"dynamicDataSource\"in e)||!e.dynamicDataSource),errorMessage:\"Feature layer should be a layer or table in a map or feature service\"}}function E(e){const r=[],t=[];for(const{layer:a,layerJSON:o}of e)a.isTable?t.push(o):r.push(o);return{layers:r,tables:t}}function T(e){return E([e])}async function F(e,r){return/\\/\\d+\\/?$/.test(e.url)?T(r[0]):G(r,e)}async function G(e,r){if(e.reverse(),!r)return E(e);const t=await K(r,e);for(const a of e)v(a.layer,a.layerJSON,t);return U(t,e),t}async function K(e,r){let t=await e.fetchData(\"json\");if(j(t))return t;t||={},B(t);const{layer:{url:a,customParameters:o,apiKey:n}}=r[0];return await V(t,{url:a??\"\",customParameters:o,apiKey:n},r.map(s=>s.layer.layerId)),t}function j(e){return!!(e&&Array.isArray(e.layers)&&Array.isArray(e.tables))}function B(e){e.layers||=[],e.tables||=[]}function U(e,r){const t=[],a=[];for(const{layer:o}of r){const{isTable:n,layerId:s}=o;n?a.push(s):t.push(s)}b(e.layers,t),b(e.tables,a)}function b(e,r){if(e.length<2)return;const t=[];for(const{id:a}of e)t.push(a);w(t.sort(A),r.slice().sort(A))&&e.sort((a,o)=>{const n=r.indexOf(a.id),s=r.indexOf(o.id);return n<s?-1:n>s?1:0})}function A(e,r){return e<r?-1:e>r?1:0}async function V(e,r,t){const{url:a,customParameters:o,apiKey:n}=r,{serviceJSON:s,layersJSON:i}=await D(a,{customParameters:o,apiKey:n}),c=h(e.layers,s.layers,t),u=h(e.tables,s.tables,t);e.layers=c.itemResources,e.tables=u.itemResources;const y=[...c.added,...u.added],P=i?[...i.layers,...i.tables]:[];await Z(e,y,a,P)}function h(e,r,t){const a=N(e,r,(n,s)=>n.id===s.id);e=e.filter(n=>!a.removed.some(s=>s.id===n.id));const o=a.added;return o.forEach(({id:n})=>{e.push({id:n})}),{itemResources:e,added:o.filter(({id:n})=>!t.includes(n))}}async function Z(e,r,t,a){const o=await k(r),n=r.map(({id:s,type:i})=>new(o.get(i))({url:t,layerId:s,sourceJSON:a.find(({id:c})=>c===s)}));await Promise.allSettled(n.map(s=>s.load())),n.forEach(s=>{const{layerId:i,loaded:c,defaultPopupTemplate:u}=s;if(!c||u==null)return;const y={id:i,popupInfo:u.toJSON()};s.operationalLayerType!==\"ArcGISFeatureLayer\"&&(y.layerType=s.operationalLayerType),v(s,y,e)})}async function k(e){const r=[];e.forEach(({type:o})=>{const n=_(o),s=Y[n];r.push(s())});const t=await Promise.all(r),a=new Map;return e.forEach(({type:o},n)=>{a.set(o,t[n])}),a}function v(e,r,t){e.isTable?L(t.tables,r):L(t.layers,r)}function L(e,r){const t=e.findIndex(({id:a})=>a===r.id);t===-1?e.push(r):e[t]=r}function q(e,r){const t=e.layers.some(a=>a.layerType===\"OrientedImageryLayer\");f(r,l.ORIENTED_IMAGERY_LAYER,t)}function z(e,r){const t=e.some(a=>a.type===\"oriented-imagery\");f(r,l.ORIENTED_IMAGERY_LAYER,t)}async function C(e,r,t){q(t,r)}async function X(e,r){const{url:t,layerId:a,title:o,fullExtent:n,isTable:s}=e,i=x(t);r.url=(i?.serverType===\"FeatureServer\"?t:`${t}/${a}`)??null,r.title||=o,r.extent=null,s||n==null||(r.extent=await J(n)),d(r,l.METADATA),d(r,l.MULTI_LAYER),M(r,l.SINGLE_LAYER),f(r,l.TABLE,s),z([e],r)}async function H(e,r){return O({layer:e,itemType:m,validateLayer:I,createItemData:(t,a)=>F(a,[t]),errorNamePrefix:$,setItemProperties:C},r)}async function Q(e,r,t){return R({layer:e,itemType:m,validateLayer:I,createItemData:(a,o)=>Promise.resolve(T(a)),errorNamePrefix:g,newItem:r,setItemProperties:X},t)}export{H as save,Q as saveAs};\n","import{I as o,b as s}from\"./main-I34c1W55.js\";function a(e,r){return{...l(e,r),readResourcePaths:[]}}function i(e,r,n){const t=o(e.itemUrl);return{...l(e,r),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:t?{rootPath:t.path,writtenUrls:[]}:null,resources:n?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(e,r){return{origin:r,url:o(e.itemUrl),portal:e.portal||s.getDefault(),portalItem:e}}export{a as e,i as o};\n","function n(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{n as i};\n","import{i as o}from\"./multiOriginJSONSupportUtils-DGETddQl.js\";function n(t){t?.writtenProperties&&t.writtenProperties.forEach(({target:r,propName:e,newOrigin:i})=>{o(r)&&i&&r.originOf(e)!==i&&r.updateOrigin(e,i)})}export{n as i};\n","import{s as l}from\"./main-I34c1W55.js\";async function i(t){const s=[];for(const o of t.allLayers)if(\"beforeSave\"in o&&typeof o.beforeSave==\"function\"){const e=o.beforeSave();e&&s.push(e)}await Promise.allSettled(s)}const u=new Set([\"layer:unsupported\",\"property:unsupported\",\"symbol:unsupported\",\"symbol-layer:unsupported\",\"url:unsupported\"]);function d(t,s,o){let e=(t.messages??[]).filter(({type:r})=>r===\"error\").map(({name:r,message:a,details:p})=>new l(r,a,p));if(t.blockedRelativeUrls&&(e=e.concat(t.blockedRelativeUrls.map(r=>new l(\"url:unsupported\",`Relative url '${r}' is not supported`)))),o){const{ignoreUnsupported:r,supplementalUnsupportedErrors:a=[],requiredPropertyChecksDisabled:p}=o;r&&(e=e.filter(({name:n})=>!(u.has(n)||a.includes(n)))),p&&(e=e.filter(n=>n.name!==\"web-document-write:property-required\"))}if(e.length>0)throw new l(s.errorName,\"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:e})}export{i as r,d as t};\n","import{s as c,b as P}from\"./main-I34c1W55.js\";import{i as u}from\"./originUtils-BLsWtgV9.js\";import h from\"./PortalItem-CH5hihzj.js\";import{o as x}from\"./jsonContext-Cs3DKlwE.js\";import{i as N,f as b}from\"./portalItemUtils-B5LG5xsT.js\";import{t as S}from\"./saveUtils-5YmoVD4N.js\";function g(t,a,r){const e=r(t);if(!e.isValid)throw new c(`${a}:invalid-parameters`,e.errorMessage,{layer:t})}async function d(t){const{layer:a,errorNamePrefix:r,validateLayer:e}=t;await a.load(),g(a,r,e)}function y(t,a){return`Layer (title: ${t.title}, id: ${t.id}) of type '${t.declaredClass}' ${a}`}function w(t){const{item:a,errorNamePrefix:r,layer:e,validateItem:i}=t;if(O(t),i){const n=i(a);if(!n.isValid)throw new c(`${r}:invalid-parameters`,n.errorMessage,{layer:e})}}function O(t){const{item:a,itemType:r,additionalItemType:e,errorNamePrefix:i,layer:n}=t,s=[r];if(e&&s.push(e),!s.includes(a.type)){const p=s.map(o=>`'${o}'`).join(\", \");throw new c(`${i}:portal-item-wrong-type`,`Portal item type should be one of: \"${p}\"`,{item:a,layer:n})}}function J(t){const{layer:a,errorNamePrefix:r}=t,{portalItem:e}=a;if(!e)throw new c(`${r}:portal-item-not-set`,y(a,\"requires the portalItem property to be set\"));if(!e.loaded)throw new c(`${r}:portal-item-not-loaded`,y(a,\"cannot be saved to a portal item that does not exist or is inaccessible\"));w({...t,item:e})}function E(t){const{newItem:a,itemType:r}=t;let e=h.from(a);return e.id&&(e=e.clone(),e.id=null),e.type??=r,e.portal??=P.getDefault(),w({...t,item:e}),e}function I(t){return x(t,\"portal-item\")}async function $(t,a,r){\"beforeSave\"in t&&typeof t.beforeSave==\"function\"&&await t.beforeSave();const e=t.write({},a);return await Promise.all(a.resources?.pendingOperations??[]),S(a,{errorName:\"layer-write:unsupported\"},r),e}function v(t){N(t,b.JSAPI),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((a,r,e)=>e.indexOf(a)===r))}async function U(t,a,r){const e=t.portal;await e.signIn(),await e.user.addItem({item:t,data:a,folder:r?.folder})}async function C(t,a){const{layer:r,createItemData:e,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=t;await d(t),J(t);const o=r.portalItem,l=i?i(o):I(o),f=await $(r,l,{...a,supplementalUnsupportedErrors:p}),m=await e({layer:r,layerJSON:f},o);return await n?.(r,o,m),v(o),await o.update({data:m}),u(l),await s?.(o,l),o}async function D(t,a){const{layer:r,createItemData:e,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=t;await d(t);const o=E(t),l=i?i(o):I(o),f=await $(r,l,{...a,supplementalUnsupportedErrors:p}),m=await e({layer:r,layerJSON:f},o);return await n(r,o,m),v(o),await U(o,m,a),r.portalItem=o,u(l),await s?.(o,l),o}export{D as $,C as P};\n"],"names":["m","p","$","g","I","e","isValid","dynamicDataSource","errorMessage","E","r","t","layer","a","layerJSON","o","isTable","push","layers","tables","T","async","F","test","url","G","reverse","K","v","U","fetchData","j","B","customParameters","apiKey","n","V","map","s","layerId","Array","isArray","b","length","id","sort","A","slice","indexOf","serviceJSON","layersJSON","i","c","h","u","itemResources","y","added","P","Z","filter","removed","some","forEach","includes","k","type","get","sourceJSON","find","Promise","allSettled","load","loaded","defaultPopupTemplate","popupInfo","toJSON","operationalLayerType","layerType","all","Map","set","L","findIndex","q","ORIENTED_IMAGERY_LAYER","z","C","X","title","fullExtent","serverType","extent","METADATA","MULTI_LAYER","SINGLE_LAYER","TABLE","H","itemType","validateLayer","createItemData","errorNamePrefix","setItemProperties","Q","resolve","newItem","l","readResourcePaths","itemUrl","messages","writtenProperties","blockedRelativeUrls","verifyItemRelativeUrls","rootPath","path","writtenUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","origin","portal","getDefault","portalItem","target","propName","newOrigin","originOf","updateOrigin","allLayers","beforeSave","Set","d","name","message","details","concat","ignoreUnsupported","supplementalUnsupportedErrors","requiredPropertyChecksDisabled","has","errorName","errors","declaredClass","w","item","validateItem","O","additionalItemType","join","J","from","clone","write","JSAPI","typeKeywords","signIn","user","addItem","data","folder","createJSONContext","saveResources","f","update","D"],"sourceRoot":""}